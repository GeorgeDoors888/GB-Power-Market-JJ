2025-10-29 00:52:30,053 - INFO - BigQuery dataset 'uk_energy_prod' exists.
All Datasets:   0%|          | 0/2 [00:00<?, ?it/s]Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]2025-10-29 00:52:30,075 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh between 2024-01-01 00:00:00+00:00 and 2024-12-31 00:00:00+00:00
2025-10-29 00:52:31,329 - INFO - Found 0 existing windows for bmrs_fuelhh

Windows for FUELHH:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A
Fetching FUELHH from 2024-01-01 to 2024-01-08:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:38,  1.32it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:52:31,330 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-01-01 00:00:00+00:00 to=2024-01-08 00:00:00+00:00
2025-10-29 00:52:31,458 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-01-01&to=2024-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:31,460 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:31,461 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:31,461 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:31,462 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:31,462 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:31,463 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:31,463 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:31,463 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:31,463 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:31,464 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:31,464 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:31,464 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:31,464 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:31,465 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:31,465 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:31,466 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:31,466 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:31,466 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:32,078 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-01-01 00:00:00+00:00-2024-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:32,086 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-01-08 00:00:00+00:00 to=2024-01-15 00:00:00+00:00
2025-10-29 00:52:32,242 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-01-08&to=2024-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:32,245 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:32,246 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:32,247 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:32,248 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:32,248 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:32,249 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:32,249 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:32,250 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:32,250 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:32,251 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:32,251 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:32,252 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:32,252 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:32,253 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:32,253 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:32,255 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:32,255 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:32,255 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:01<00:38,  1.32it/s][A
Fetching FUELHH from 2024-01-08 to 2024-01-15:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:35,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:02<00:35,  1.40it/s][A
Fetching FUELHH from 2024-01-15 to 2024-01-22:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [A2025-10-29 00:52:32,768 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-01-08 00:00:00+00:00-2024-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:32,771 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-01-15 00:00:00+00:00 to=2024-01-22 00:00:00+00:00
2025-10-29 00:52:32,858 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-01-15&to=2024-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:32,860 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:32,861 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:32,861 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:32,862 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:32,862 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:32,863 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:32,863 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:32,864 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:32,864 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:32,864 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:32,865 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:32,865 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:32,865 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:32,866 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:32,866 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:32,867 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:32,868 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:32,868 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:33,395 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-01-15 00:00:00+00:00-2024-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.48it/s][A
Fetching FUELHH from 2024-01-22 to 2024-01-29:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:30,  1.57it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:52:33,397 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-01-22 00:00:00+00:00 to=2024-01-29 00:00:00+00:00
2025-10-29 00:52:33,486 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-01-22&to=2024-01-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:33,487 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:33,488 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:33,488 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:33,489 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:33,489 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:33,490 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:33,490 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:33,490 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:33,491 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:33,491 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:33,491 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:33,491 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:33,492 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:33,492 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:33,492 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:33,493 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:33,494 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:33,494 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:33,972 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-01-22 00:00:00+00:00-2024-01-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:33,973 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-01-29 00:00:00+00:00 to=2024-02-05 00:00:00+00:00
2025-10-29 00:52:34,076 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-01-29&to=2024-02-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:34,077 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:34,077 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:34,078 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:34,078 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:34,078 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:34,078 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:34,079 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:34,079 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:34,079 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:34,079 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:34,079 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:34,079 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:34,080 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:34,080 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:34,080 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:34,081 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:34,081 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:34,081 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:03<00:30,  1.57it/s][A
Fetching FUELHH from 2024-01-29 to 2024-02-05:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:33,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:04<00:33,  1.43it/s][A
Fetching FUELHH from 2024-02-05 to 2024-02-12:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [A2025-10-29 00:52:34,788 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-01-29 00:00:00+00:00-2024-02-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:34,789 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-02-05 00:00:00+00:00 to=2024-02-12 00:00:00+00:00
2025-10-29 00:52:34,856 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-02-05&to=2024-02-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:34,857 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:34,858 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:34,858 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:34,858 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:34,858 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:34,858 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:34,859 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:34,859 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:34,859 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:34,859 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:34,859 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:34,860 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:34,860 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:34,860 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:34,860 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:34,861 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:34,861 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:34,862 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:35,453 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-02-05 00:00:00+00:00-2024-02-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:31,  1.45it/s][A
Fetching FUELHH from 2024-02-12 to 2024-02-19:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:31,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:52:35,454 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-02-12 00:00:00+00:00 to=2024-02-19 00:00:00+00:00
2025-10-29 00:52:35,526 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-02-12&to=2024-02-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:35,527 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:35,528 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:35,528 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:35,528 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:35,529 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:35,529 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:35,529 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:35,529 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:35,529 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:35,530 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:35,530 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:35,530 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:35,530 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:35,530 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:35,531 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:35,531 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:35,532 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:35,532 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:36,179 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-02-12 00:00:00+00:00-2024-02-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:36,181 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-02-19 00:00:00+00:00 to=2024-02-26 00:00:00+00:00
2025-10-29 00:52:36,259 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-02-19&to=2024-02-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:36,261 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:36,262 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:36,262 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:36,263 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:36,263 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:36,264 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:36,264 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:36,264 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:36,265 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:36,265 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:36,265 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:36,266 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:36,266 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:36,266 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:36,266 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:36,268 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:36,268 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:36,268 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:05<00:31,  1.43it/s][A
Fetching FUELHH from 2024-02-19 to 2024-02-26:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:06<00:29,  1.51it/s][A
Fetching FUELHH from 2024-02-26 to 2024-03-04:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [A2025-10-29 00:52:36,758 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-02-19 00:00:00+00:00-2024-02-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:36,762 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-02-26 00:00:00+00:00 to=2024-03-04 00:00:00+00:00
2025-10-29 00:52:36,854 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-02-26&to=2024-03-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:36,861 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:36,862 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:36,863 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:36,863 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:36,863 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:36,864 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:36,864 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:36,865 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:36,865 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:36,865 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:36,865 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:36,866 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:36,866 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:36,866 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:36,866 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:36,868 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:36,868 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:36,868 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:37,379 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-02-26 00:00:00+00:00-2024-03-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:27,  1.54it/s][A
Fetching FUELHH from 2024-03-04 to 2024-03-11:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:26,  1.59it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:37,380 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-03-04 00:00:00+00:00 to=2024-03-11 00:00:00+00:00
2025-10-29 00:52:37,459 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-03-04&to=2024-03-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:37,460 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:37,461 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:37,461 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:37,462 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:37,462 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:37,462 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:37,463 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:37,463 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:37,463 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:37,464 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:37,464 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:37,464 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:37,464 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:37,465 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:37,465 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:37,466 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:37,466 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:37,466 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:37,965 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-03-04 00:00:00+00:00-2024-03-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:37,968 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-03-11 00:00:00+00:00 to=2024-03-18 00:00:00+00:00
2025-10-29 00:52:38,069 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-03-11&to=2024-03-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:38,070 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:38,072 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:38,072 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:38,072 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:38,073 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:38,073 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:38,074 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:38,074 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:38,074 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:38,075 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:38,075 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:38,075 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:38,075 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:38,076 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:38,076 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:38,077 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:38,078 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:38,078 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:07<00:26,  1.59it/s][A
Fetching FUELHH from 2024-03-11 to 2024-03-18:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:26,  1.55it/s][A
Fetching FUELHH from 2024-03-18 to 2024-03-25:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:38,640 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-03-11 00:00:00+00:00-2024-03-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:38,644 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-03-18 00:00:00+00:00 to=2024-03-25 00:00:00+00:00
2025-10-29 00:52:38,732 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-03-18&to=2024-03-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:38,734 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:38,735 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:38,735 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:38,736 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:38,736 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:38,737 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:38,737 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:38,737 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:38,738 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:38,738 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:38,738 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:38,739 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:38,739 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:38,739 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:38,739 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:38,741 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:38,741 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:38,741 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:39,211 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-03-18 00:00:00+00:00-2024-03-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:07<00:24,  1.61it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:24,  1.61it/s][A
Fetching FUELHH from 2024-03-25 to 2024-04-01:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:24,  1.61it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:39,214 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-03-25 00:00:00+00:00 to=2024-04-01 00:00:00+00:00
2025-10-29 00:52:39,304 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-03-25&to=2024-04-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:39,305 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:39,307 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:39,307 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:39,308 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:39,308 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:39,309 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:39,309 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:39,309 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:39,310 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:39,310 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:39,310 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:39,311 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:39,311 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:39,311 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:39,312 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:39,313 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:39,313 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:39,314 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:39,826 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-03-25 00:00:00+00:00-2024-04-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:39,829 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-04-01 00:00:00+00:00 to=2024-04-08 00:00:00+00:00
2025-10-29 00:52:39,922 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-04-01&to=2024-04-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:39,923 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:39,924 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:39,925 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:39,925 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:39,926 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:39,926 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:39,926 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:39,927 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:39,927 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:39,927 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:39,928 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:39,928 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:39,928 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:39,929 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:39,929 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:39,931 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:39,931 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:39,931 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:09<00:24,  1.61it/s][A
Fetching FUELHH from 2024-04-01 to 2024-04-08:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:24,  1.53it/s][A
Fetching FUELHH from 2024-04-08 to 2024-04-15:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:40,553 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-04-01 00:00:00+00:00-2024-04-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:40,556 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-04-08 00:00:00+00:00 to=2024-04-15 00:00:00+00:00
2025-10-29 00:52:40,650 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-04-08&to=2024-04-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:40,650 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:40,651 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:40,651 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:40,652 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:40,652 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:40,652 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:40,653 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:40,653 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:40,653 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:40,653 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:40,654 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:40,654 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:40,654 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:40,654 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:40,654 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:40,655 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:40,655 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:40,656 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:41,178 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-04-08 00:00:00+00:00-2024-04-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.55it/s][A
Fetching FUELHH from 2024-04-15 to 2024-04-22:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:41,182 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-04-15 00:00:00+00:00 to=2024-04-22 00:00:00+00:00
2025-10-29 00:52:41,281 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-04-15&to=2024-04-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:41,281 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:41,282 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:41,283 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:41,283 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:41,283 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:41,284 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:41,284 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:41,284 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:41,285 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:41,285 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:41,285 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:41,285 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:41,286 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:41,286 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:41,286 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:41,287 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:41,288 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:41,288 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:41,788 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-04-15 00:00:00+00:00-2024-04-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:41,792 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-04-22 00:00:00+00:00 to=2024-04-29 00:00:00+00:00
2025-10-29 00:52:41,886 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-04-22&to=2024-04-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:41,887 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:41,888 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:41,888 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:41,889 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:41,889 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:41,889 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:41,890 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:41,890 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:41,890 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:41,890 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:41,891 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:41,891 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:41,891 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:41,891 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:41,891 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:41,892 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:41,892 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:41,893 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:11<00:22,  1.58it/s][A
Fetching FUELHH from 2024-04-22 to 2024-04-29:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.54it/s][A
Fetching FUELHH from 2024-04-29 to 2024-05-06:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:42,469 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-04-22 00:00:00+00:00-2024-04-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:42,473 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-04-29 00:00:00+00:00 to=2024-05-06 00:00:00+00:00
2025-10-29 00:52:42,555 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-04-29&to=2024-05-06&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:42,559 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:42,560 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:42,560 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:42,560 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:42,560 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:42,560 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:42,561 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:42,561 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:42,561 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:42,561 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:42,561 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:42,561 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:42,562 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:42,562 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:42,562 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:42,563 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:42,563 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:42,563 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:43,187 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-04-29 00:00:00+00:00-2024-05-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:22,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:22,  1.50it/s][A
Fetching FUELHH from 2024-05-06 to 2024-05-13:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:22,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:43,190 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-05-06 00:00:00+00:00 to=2024-05-13 00:00:00+00:00
2025-10-29 00:52:43,285 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-05-06&to=2024-05-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:43,286 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:43,287 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:43,288 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:43,288 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:43,289 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:43,289 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:43,289 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:43,290 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:43,290 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:43,291 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:43,291 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:43,292 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:43,292 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:43,292 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:43,293 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:43,294 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:43,295 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:43,295 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:43,865 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-05-06 00:00:00+00:00-2024-05-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:43,868 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-05-13 00:00:00+00:00 to=2024-05-20 00:00:00+00:00
2025-10-29 00:52:43,971 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-05-13&to=2024-05-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:43,972 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:43,973 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:43,973 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:43,974 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:43,974 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:43,975 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:43,975 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:43,976 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:43,976 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:43,976 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:43,977 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:43,977 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:43,977 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:43,978 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:43,978 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:43,979 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:43,980 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:43,980 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:13<00:22,  1.49it/s][A
Fetching FUELHH from 2024-05-13 to 2024-05-20:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:20,  1.55it/s][A
Fetching FUELHH from 2024-05-20 to 2024-05-27:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:44,451 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-05-13 00:00:00+00:00-2024-05-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:44,453 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-05-20 00:00:00+00:00 to=2024-05-27 00:00:00+00:00
2025-10-29 00:52:44,542 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-05-20&to=2024-05-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:44,543 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:44,543 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:44,544 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:44,544 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:44,544 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:44,544 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:44,545 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:44,545 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:44,545 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:44,545 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:44,546 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:44,546 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:44,546 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:44,546 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:44,546 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:44,547 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:44,547 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:44,548 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:45,132 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-05-20 00:00:00+00:00-2024-05-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A
Fetching FUELHH from 2024-05-27 to 2024-06-03:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:45,136 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-05-27 00:00:00+00:00 to=2024-06-03 00:00:00+00:00
2025-10-29 00:52:45,231 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-05-27&to=2024-06-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:45,232 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:45,233 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:45,234 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:45,234 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:45,235 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:45,235 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:45,236 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:45,236 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:45,237 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:45,237 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:45,237 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:45,238 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:45,238 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:45,238 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:45,239 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:45,240 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:45,241 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:45,241 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:45,919 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-05-27 00:00:00+00:00-2024-06-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:45,924 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-06-03 00:00:00+00:00 to=2024-06-10 00:00:00+00:00
2025-10-29 00:52:46,019 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-06-03&to=2024-06-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:46,020 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:46,021 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:46,022 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:46,022 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:46,023 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:46,023 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:46,023 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:46,024 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:46,024 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:46,024 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:46,025 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:46,025 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:46,025 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:46,026 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:46,026 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:46,027 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:46,027 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:46,027 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:15<00:20,  1.44it/s][A
Fetching FUELHH from 2024-06-03 to 2024-06-10:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:19,  1.49it/s][A
Fetching FUELHH from 2024-06-10 to 2024-06-17:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:46,536 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-06-03 00:00:00+00:00-2024-06-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:46,539 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-06-10 00:00:00+00:00 to=2024-06-17 00:00:00+00:00
2025-10-29 00:52:46,643 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-06-10&to=2024-06-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:46,644 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:46,645 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:46,645 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:46,646 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:46,646 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:46,647 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:46,647 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:46,648 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:46,648 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:46,648 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:46,649 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:46,649 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:46,649 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:46,649 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:46,650 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:46,651 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:46,651 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:46,651 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:47,153 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-06-10 00:00:00+00:00-2024-06-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:18,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:18,  1.53it/s][A
Fetching FUELHH from 2024-06-17 to 2024-06-24:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:20,  1.35it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:47,155 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-06-17 00:00:00+00:00 to=2024-06-24 00:00:00+00:00
2025-10-29 00:52:47,248 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-06-17&to=2024-06-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:47,249 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:47,251 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:47,251 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:47,251 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:47,252 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:47,252 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:47,253 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:47,253 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:47,253 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:47,254 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:47,254 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:47,254 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:47,255 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:47,255 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:47,255 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:47,256 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:47,257 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:47,257 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:48,096 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-06-17 00:00:00+00:00-2024-06-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:48,100 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-06-24 00:00:00+00:00 to=2024-07-01 00:00:00+00:00
2025-10-29 00:52:48,204 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-06-24&to=2024-07-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:48,206 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:48,207 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:48,208 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:48,208 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:48,209 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:48,210 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:48,210 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:48,210 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:48,211 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:48,211 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:48,212 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:48,212 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:48,212 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:48,213 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:48,213 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:48,215 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:48,215 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:48,215 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:17<00:20,  1.35it/s][A
Fetching FUELHH from 2024-06-24 to 2024-07-01:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:18<00:18,  1.40it/s][A
Fetching FUELHH from 2024-07-01 to 2024-07-08:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:48,741 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-06-24 00:00:00+00:00-2024-07-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:48,743 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-07-01 00:00:00+00:00 to=2024-07-08 00:00:00+00:00
2025-10-29 00:52:49,238 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-07-01&to=2024-07-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:49,256 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:49,258 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:49,258 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:49,259 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:49,259 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:49,260 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:49,260 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:49,261 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:49,261 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:49,261 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:49,262 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:49,262 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:49,262 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:49,263 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:49,263 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:49,264 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:49,265 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:49,265 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:49,851 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-07-01 00:00:00+00:00-2024-07-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:20,  1.20it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:19<00:20,  1.20it/s][A
Fetching FUELHH from 2024-07-08 to 2024-07-15:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:49,853 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-07-08 00:00:00+00:00 to=2024-07-15 00:00:00+00:00
2025-10-29 00:52:49,936 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-07-08&to=2024-07-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:49,937 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:49,938 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:49,938 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:49,939 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:49,939 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:49,939 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:49,940 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:49,940 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:49,940 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:49,940 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:49,940 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:49,941 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:49,941 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:49,941 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:49,941 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:49,942 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:49,942 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:49,942 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:50,456 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-07-08 00:00:00+00:00-2024-07-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:50,461 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-07-15 00:00:00+00:00 to=2024-07-22 00:00:00+00:00
2025-10-29 00:52:50,559 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-07-15&to=2024-07-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:50,560 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:50,561 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:50,562 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:50,562 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:50,563 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:50,563 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:50,563 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:50,564 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:50,564 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:50,564 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:50,565 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:50,565 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:50,565 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:50,565 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:50,566 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:50,567 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:50,567 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:50,567 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:18,  1.31it/s][A
Fetching FUELHH from 2024-07-15 to 2024-07-22:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:16,  1.39it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:21<00:16,  1.39it/s][A
Fetching FUELHH from 2024-07-22 to 2024-07-29:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:51,071 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-07-15 00:00:00+00:00-2024-07-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:51,074 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-07-22 00:00:00+00:00 to=2024-07-29 00:00:00+00:00
2025-10-29 00:52:51,163 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-07-22&to=2024-07-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:51,164 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:51,166 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:51,166 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:51,167 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:51,167 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:51,168 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:51,168 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:51,168 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:51,169 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:51,169 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:51,170 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:51,170 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:51,171 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:51,171 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:51,171 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:51,173 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:51,173 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:51,173 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:52,461 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-07-22 00:00:00+00:00-2024-07-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:21<00:20,  1.09it/s][A
Fetching FUELHH from 2024-07-29 to 2024-08-05:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:21<00:19,  1.11it/s][A
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:21<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:21<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:52,464 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-07-29 00:00:00+00:00 to=2024-08-05 00:00:00+00:00
2025-10-29 00:52:52,676 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-07-29&to=2024-08-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:52,677 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:52,678 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:52,678 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:52,678 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:52,679 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:52,679 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:52,680 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:52,680 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:52,680 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:52,680 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:52,681 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:52,681 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:52,682 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:52,682 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:52,682 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:52,684 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:52,684 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:52,684 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:53,324 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-07-29 00:00:00+00:00-2024-08-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:53,326 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-08-05 00:00:00+00:00 to=2024-08-12 00:00:00+00:00
2025-10-29 00:52:53,418 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-08-05&to=2024-08-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:53,419 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:53,421 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:53,421 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:53,422 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:53,423 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:53,423 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:53,424 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:53,424 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:53,425 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:53,425 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:53,425 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:53,426 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:53,426 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:53,426 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:53,427 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:53,428 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:53,429 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:53,429 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:22<00:19,  1.11it/s][A
Fetching FUELHH from 2024-08-05 to 2024-08-12:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:16,  1.22it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:23<00:16,  1.22it/s][A
Fetching FUELHH from 2024-08-12 to 2024-08-19:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:53,937 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-08-05 00:00:00+00:00-2024-08-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:53,942 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-08-12 00:00:00+00:00 to=2024-08-19 00:00:00+00:00
2025-10-29 00:52:54,040 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-08-12&to=2024-08-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:54,042 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:54,043 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:54,043 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:54,044 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:54,044 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:54,045 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:54,045 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:54,045 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:54,046 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:54,046 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:54,046 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:54,046 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:54,047 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:54,047 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:54,047 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:54,049 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:54,049 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:54,049 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:54,555 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-08-12 00:00:00+00:00-2024-08-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:23<00:14,  1.32it/s][A
Fetching FUELHH from 2024-08-19 to 2024-08-26:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:54,558 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-08-19 00:00:00+00:00 to=2024-08-26 00:00:00+00:00
2025-10-29 00:52:54,651 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-08-19&to=2024-08-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:54,652 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:54,653 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:54,654 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:54,654 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:54,654 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:54,655 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:54,655 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:54,655 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:54,656 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:54,656 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:54,656 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:54,656 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:54,657 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:54,657 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:54,657 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:54,659 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:54,659 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:54,659 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:55,130 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-08-19 00:00:00+00:00-2024-08-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:55,134 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-08-26 00:00:00+00:00 to=2024-09-02 00:00:00+00:00
2025-10-29 00:52:55,227 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-08-26&to=2024-09-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:55,228 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:55,230 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:55,230 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:55,231 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:55,231 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:55,232 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:55,232 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:55,232 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:55,233 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:55,233 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:55,233 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:55,234 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:55,234 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:55,234 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:55,234 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:55,236 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:55,237 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:55,237 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:24<00:12,  1.42it/s][A
Fetching FUELHH from 2024-08-26 to 2024-09-02:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.52it/s][A
Fetching FUELHH from 2024-09-02 to 2024-09-09:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.55it/s][A
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.55it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:55,683 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-08-26 00:00:00+00:00-2024-09-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:55,687 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-09-02 00:00:00+00:00 to=2024-09-09 00:00:00+00:00
2025-10-29 00:52:55,786 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-09-02&to=2024-09-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:55,786 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:55,787 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:55,788 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:55,788 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:55,788 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:55,789 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:55,789 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:55,789 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:55,789 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:55,790 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:55,790 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:55,790 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:55,790 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:55,790 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:55,791 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:55,792 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:55,792 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:55,792 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:56,301 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-09-02 00:00:00+00:00-2024-09-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:25<00:10,  1.55it/s][A
Fetching FUELHH from 2024-09-09 to 2024-09-16:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:09,  1.59it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:56,303 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-09-09 00:00:00+00:00 to=2024-09-16 00:00:00+00:00
2025-10-29 00:52:56,385 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-09-09&to=2024-09-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:56,388 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:56,395 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:56,404 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:56,405 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:56,407 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:56,410 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:56,410 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:56,417 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:56,418 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:56,419 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:56,423 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:56,424 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:56,424 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:56,424 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:56,424 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:56,425 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:56,425 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:56,425 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:56,891 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-09-09 00:00:00+00:00-2024-09-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:56,896 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-09-16 00:00:00+00:00 to=2024-09-23 00:00:00+00:00
2025-10-29 00:52:57,000 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-09-16&to=2024-09-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:57,001 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:57,003 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:57,003 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:57,004 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:57,004 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:57,005 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:57,005 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:57,005 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:57,006 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:57,006 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:57,006 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:57,007 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:57,007 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:57,007 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:57,008 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:57,010 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:57,010 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:57,010 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:26<00:09,  1.59it/s][A
Fetching FUELHH from 2024-09-16 to 2024-09-23:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:08,  1.60it/s][A
Fetching FUELHH from 2024-09-23 to 2024-09-30:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:57,514 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-09-16 00:00:00+00:00-2024-09-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:57,516 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-09-23 00:00:00+00:00 to=2024-09-30 00:00:00+00:00
2025-10-29 00:52:57,603 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-09-23&to=2024-09-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:57,604 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:57,605 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:57,605 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:57,605 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:57,606 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:57,606 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:57,606 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:57,606 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:57,606 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:57,607 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:57,607 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:57,607 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:57,607 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:57,607 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:57,607 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:57,608 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:57,608 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:57,609 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:58,105 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-09-23 00:00:00+00:00-2024-09-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:08,  1.62it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:27<00:08,  1.62it/s][A
Fetching FUELHH from 2024-09-30 to 2024-10-07:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:07,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:52:58,106 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-09-30 00:00:00+00:00 to=2024-10-07 00:00:00+00:00
2025-10-29 00:52:58,188 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-09-30&to=2024-10-07&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:58,189 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:58,191 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:58,192 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:58,192 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:58,192 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:58,192 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:58,193 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:58,193 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:58,193 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:58,193 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:58,193 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:58,193 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:58,193 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:58,194 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:58,194 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:58,195 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:58,195 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:58,195 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:52:58,772 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-09-30 00:00:00+00:00-2024-10-07 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:58,775 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-10-07 00:00:00+00:00 to=2024-10-14 00:00:00+00:00
2025-10-29 00:52:58,856 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-10-07&to=2024-10-14&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:58,858 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:58,859 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:58,859 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:58,860 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:58,861 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:58,861 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:58,861 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:58,862 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:58,862 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:58,862 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:58,863 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:58,863 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:58,863 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:58,864 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:58,864 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:58,865 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:58,866 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:58,866 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:28<00:07,  1.58it/s][A
Fetching FUELHH from 2024-10-07 to 2024-10-14:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.53it/s][A
Fetching FUELHH from 2024-10-14 to 2024-10-21:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [A2025-10-29 00:52:59,470 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-10-07 00:00:00+00:00-2024-10-14 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:52:59,475 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-10-14 00:00:00+00:00 to=2024-10-21 00:00:00+00:00
2025-10-29 00:52:59,571 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-10-14&to=2024-10-21&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:59,572 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:52:59,574 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:59,575 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:52:59,575 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:52:59,576 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:52:59,576 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:52:59,577 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:52:59,577 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:52:59,577 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:59,578 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:59,578 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:59,578 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:59,579 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:59,579 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:59,579 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:59,581 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:52:59,581 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:52:59,581 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:00,087 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-10-14 00:00:00+00:00-2024-10-21 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:06,  1.56it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:29<00:06,  1.56it/s][A
Fetching FUELHH from 2024-10-21 to 2024-10-28:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:00,091 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-10-21 00:00:00+00:00 to=2024-10-28 00:00:00+00:00
2025-10-29 00:53:00,184 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-10-21&to=2024-10-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:00,185 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:00,186 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:00,186 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:00,186 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:00,187 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:00,187 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:00,187 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:00,187 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:00,188 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:00,188 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:00,188 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:00,188 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:00,188 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:00,189 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:00,189 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:00,190 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:00,190 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:00,190 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:00,652 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-10-21 00:00:00+00:00-2024-10-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:00,656 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-10-28 00:00:00+00:00 to=2024-11-04 00:00:00+00:00
2025-10-29 00:53:00,743 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-10-28&to=2024-11-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:00,743 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:00,744 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:00,745 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:00,745 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:00,745 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:00,746 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:00,746 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:00,746 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:00,747 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:00,747 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:00,747 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:00,747 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:00,747 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:00,748 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:00,748 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:00,749 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:00,749 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:00,749 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:05,  1.62it/s][A
Fetching FUELHH from 2024-10-28 to 2024-11-04:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:29<00:04,  1.64it/s][A
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:29<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:29<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:04,  1.64it/s][A
Fetching FUELHH from 2024-11-04 to 2024-11-11:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [A2025-10-29 00:53:01,248 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-10-28 00:00:00+00:00-2024-11-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:01,252 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-11-04 00:00:00+00:00 to=2024-11-11 00:00:00+00:00
2025-10-29 00:53:01,347 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-11-04&to=2024-11-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:01,348 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:01,349 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:01,349 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:01,349 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:01,350 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:01,350 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:01,350 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:01,351 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:01,351 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:01,351 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:01,352 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:01,352 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:01,352 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:01,352 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:01,352 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:01,354 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:01,354 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:01,354 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:01,926 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-11-04 00:00:00+00:00-2024-11-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:04,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:31<00:04,  1.58it/s][A
Fetching FUELHH from 2024-11-11 to 2024-11-18:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:01,930 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-11-11 00:00:00+00:00 to=2024-11-18 00:00:00+00:00
2025-10-29 00:53:02,030 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-11-11&to=2024-11-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:02,031 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:02,032 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:02,032 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:02,033 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:02,033 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:02,034 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:02,034 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:02,034 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:02,035 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:02,035 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:02,035 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:02,036 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:02,036 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:02,036 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:02,036 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:02,038 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:02,038 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:02,038 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:02,643 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-11-11 00:00:00+00:00-2024-11-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:02,647 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-11-18 00:00:00+00:00 to=2024-11-25 00:00:00+00:00
2025-10-29 00:53:02,741 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-11-18&to=2024-11-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:02,742 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:02,744 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:02,744 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:02,745 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:02,745 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:02,746 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:02,746 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:02,746 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:02,747 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:02,747 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:02,748 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:02,748 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:02,748 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:02,749 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:02,749 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:02,750 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:02,751 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:02,751 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.52it/s][A
Fetching FUELHH from 2024-11-18 to 2024-11-25:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:31<00:03,  1.55it/s][A
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:31<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:31<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:03,  1.55it/s][A
Fetching FUELHH from 2024-11-25 to 2024-12-02:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [A2025-10-29 00:53:03,257 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-11-18 00:00:00+00:00-2024-11-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:03,261 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-11-25 00:00:00+00:00 to=2024-12-02 00:00:00+00:00
2025-10-29 00:53:03,361 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-11-25&to=2024-12-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:03,362 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:03,363 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:03,363 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:03,364 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:03,364 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:03,364 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:03,365 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:03,365 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:03,365 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:03,366 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:03,366 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:03,366 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:03,367 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:03,367 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:03,367 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:03,368 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:03,369 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:03,369 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:03,858 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-11-25 00:00:00+00:00-2024-12-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:32<00:02,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:02,  1.58it/s][A
Fetching FUELHH from 2024-12-02 to 2024-12-09:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:34<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:03,861 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-12-02 00:00:00+00:00 to=2024-12-09 00:00:00+00:00
2025-10-29 00:53:03,934 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-12-02&to=2024-12-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:03,934 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:03,935 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:03,935 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:03,935 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:03,936 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:03,936 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:03,936 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:03,937 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:03,937 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:03,938 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:03,938 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:03,939 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:03,939 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:03,939 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:03,940 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:03,942 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:03,942 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:03,942 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:04,445 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-12-02 00:00:00+00:00-2024-12-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:04,447 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-12-09 00:00:00+00:00 to=2024-12-16 00:00:00+00:00
2025-10-29 00:53:04,533 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-12-09&to=2024-12-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:04,534 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:04,535 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:04,535 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:04,536 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:04,536 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:04,537 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:04,537 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:04,538 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:04,538 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:04,538 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:04,538 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:04,539 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:04,539 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:04,540 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:04,540 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:04,541 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:04,541 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:04,541 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:01,  1.62it/s][A
Fetching FUELHH from 2024-12-09 to 2024-12-16:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:33<00:01,  1.59it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.59it/s][A
Fetching FUELHH from 2024-12-16 to 2024-12-23:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [A2025-10-29 00:53:05,100 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-12-09 00:00:00+00:00-2024-12-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:05,104 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-12-16 00:00:00+00:00 to=2024-12-23 00:00:00+00:00
2025-10-29 00:53:05,192 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-12-16&to=2024-12-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:05,193 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:05,195 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:05,195 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:05,196 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:05,196 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:05,197 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:05,197 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:05,198 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:05,198 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:05,198 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:05,199 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:05,199 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:05,199 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:05,200 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:05,200 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:05,202 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:05,203 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:05,203 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:05,819 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-12-16 00:00:00+00:00-2024-12-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:35<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:34<00:00,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.52it/s][A
Fetching FUELHH from 2024-12-23 to 2024-12-30: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:05,822 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-12-23 00:00:00+00:00 to=2024-12-30 00:00:00+00:00
2025-10-29 00:53:05,915 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-12-23&to=2024-12-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:05,916 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:05,917 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:05,918 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:05,918 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:05,919 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:05,919 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:05,919 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:05,920 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:05,920 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:05,921 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:05,921 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:05,921 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:05,922 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:05,922 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:05,922 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:05,924 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:05,924 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:05,925 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:06,399 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-12-23 00:00:00+00:00-2024-12-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:06,401 - INFO - üåê Fetching BMRS dataset=FUELHH from=2024-12-30 00:00:00+00:00 to=2024-12-31 00:00:00+00:00
2025-10-29 00:53:06,476 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2024-12-30&to=2024-12-31&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:06,477 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:06,478 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:06,478 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:06,479 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:06,479 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:06,480 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:06,480 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:06,480 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:06,480 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:06,481 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:06,481 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:06,481 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:06,481 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:06,482 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:06,482 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:06,483 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:06,483 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:06,483 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:36<?, ?it/s]
Fetching FUELHH from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:35<00:00,  1.58it/s][A
Fetching FUELHH from 2024-12-30 to 2024-12-31: : 53it [00:35,  1.57it/s]                                      [A
                                                                        [ADataset: FUELHH:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:36, 36.97s/it]Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:36, 36.97s/it]                                                                Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:36, 36.97s/it]                                                                Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]2025-10-29 00:53:07,046 - ERROR - ‚ùå Failed to load data for FUELHH in window 2024-12-30 00:00:00+00:00-2024-12-31 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:07,049 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelinst between 2024-01-01 00:00:00+00:00 and 2024-12-31 00:00:00+00:00
2025-10-29 00:53:08,161 - INFO - Found 0 existing windows for bmrs_fuelinst

Windows for FUELINST:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-01 to 2024-01-08:   0%|          | 0/52.142857142857146 [00:00<?, ?it/s][A
Fetching FUELINST from 2024-01-01 to 2024-01-08:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:00<00:33,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:53:08,162 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-01-01 00:00:00+00:00 to=2024-01-08 00:00:00+00:00
2025-10-29 00:53:08,290 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-01-01&to=2024-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:08,301 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:08,306 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:08,308 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:08,308 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:08,309 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:08,310 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:08,315 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:08,315 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:08,316 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:08,316 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:08,316 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:08,317 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:08,317 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:08,317 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:08,326 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:08,326 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:08,326 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:08,824 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-01-01 00:00:00+00:00-2024-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:08,826 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-01-08 00:00:00+00:00 to=2024-01-15 00:00:00+00:00
2025-10-29 00:53:08,938 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-01-08&to=2024-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:08,945 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:08,946 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:08,947 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:08,948 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:08,949 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:08,949 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:08,954 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:08,954 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:08,955 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:08,956 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:08,956 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:08,956 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:08,956 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:08,956 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:08,965 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:08,965 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:08,965 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-08 to 2024-01-15:   2%|‚ñè         | 1/52.142857142857146 [00:01<00:33,  1.51it/s][A
Fetching FUELINST from 2024-01-08 to 2024-01-15:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:01<00:32,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-15 to 2024-01-22:   4%|‚ñç         | 2/52.142857142857146 [00:02<00:32,  1.54it/s][A
Fetching FUELINST from 2024-01-15 to 2024-01-22:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [A2025-10-29 00:53:09,459 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-01-08 00:00:00+00:00-2024-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:09,462 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-01-15 00:00:00+00:00 to=2024-01-22 00:00:00+00:00
2025-10-29 00:53:09,586 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-01-15&to=2024-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:09,592 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:09,594 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:09,596 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:09,596 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:09,597 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:09,597 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:09,603 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:09,603 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:09,604 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:09,604 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:09,604 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:09,605 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:09,606 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:09,606 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:09,615 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:09,615 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:09,616 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:10,161 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-01-15 00:00:00+00:00-2024-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:10,165 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-01-22 00:00:00+00:00 to=2024-01-29 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-22 to 2024-01-29:   6%|‚ñå         | 3/52.142857142857146 [00:02<00:33,  1.49it/s][A
Fetching FUELINST from 2024-01-22 to 2024-01-29:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:02<00:32,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:53:10,292 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-01-22&to=2024-01-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:10,299 - INFO - Successfully fetched 321 records for FUELINST from Insights API.
2025-10-29 00:53:10,302 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:10,303 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:10,303 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:10,304 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:10,305 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:10,310 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:10,310 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:10,311 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:10,311 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:10,312 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:10,312 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:10,312 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:10,313 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:10,322 - INFO - Created hash keys for 321 rows using 3 content columns
2025-10-29 00:53:10,322 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:10,322 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:10,839 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-01-22 00:00:00+00:00-2024-01-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:10,841 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-01-29 00:00:00+00:00 to=2024-02-05 00:00:00+00:00
2025-10-29 00:53:10,959 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-01-29&to=2024-02-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:10,965 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:10,967 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:10,968 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:10,969 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:10,970 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:10,970 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:10,975 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:10,976 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:10,976 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:10,977 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:10,977 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:10,977 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:10,978 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:10,978 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:10,987 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:10,987 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:10,987 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-01-29 to 2024-02-05:   8%|‚ñä         | 4/52.142857142857146 [00:03<00:32,  1.48it/s][A
Fetching FUELINST from 2024-01-29 to 2024-02-05:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-05 to 2024-02-12:  10%|‚ñâ         | 5/52.142857142857146 [00:03<00:31,  1.52it/s][A
Fetching FUELINST from 2024-02-05 to 2024-02-12:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:03<00:30,  1.52it/s][A
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:03<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:03<00:30,  1.52it/s][A                                                                
                                                                                                               [A2025-10-29 00:53:11,468 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-01-29 00:00:00+00:00-2024-02-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:11,471 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-02-05 00:00:00+00:00 to=2024-02-12 00:00:00+00:00
2025-10-29 00:53:11,595 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-02-05&to=2024-02-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:11,603 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:11,605 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:11,606 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:11,607 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:11,608 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:11,608 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:11,613 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:11,614 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:11,614 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:11,615 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:11,615 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:11,615 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:11,616 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:11,616 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:11,625 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:11,626 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:11,626 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:12,126 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-02-05 00:00:00+00:00-2024-02-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:12,130 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-02-12 00:00:00+00:00 to=2024-02-19 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-12 to 2024-02-19:  12%|‚ñà‚ñè        | 6/52.142857142857146 [00:04<00:30,  1.52it/s][A
Fetching FUELINST from 2024-02-12 to 2024-02-19:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:04<00:29,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:53:12,255 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-02-12&to=2024-02-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:12,260 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:12,263 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:12,264 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:12,264 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:12,265 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:12,265 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:12,270 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:12,271 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:12,271 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:12,272 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:12,272 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:12,272 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:12,273 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:12,273 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:12,282 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:12,282 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:12,282 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:12,771 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-02-12 00:00:00+00:00-2024-02-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:12,775 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-02-19 00:00:00+00:00 to=2024-02-26 00:00:00+00:00
2025-10-29 00:53:12,925 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-02-19&to=2024-02-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:12,933 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:12,936 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:12,937 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:12,938 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:12,939 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:12,939 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:12,944 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:12,945 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:12,945 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:12,946 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:12,946 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:12,946 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:12,947 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:12,947 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:12,956 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:12,956 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:12,956 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-19 to 2024-02-26:  13%|‚ñà‚ñé        | 7/52.142857142857146 [00:05<00:29,  1.53it/s][A
Fetching FUELINST from 2024-02-19 to 2024-02-26:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-02-26 to 2024-03-04:  15%|‚ñà‚ñå        | 8/52.142857142857146 [00:05<00:29,  1.51it/s][A
Fetching FUELINST from 2024-02-26 to 2024-03-04:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:05<00:28,  1.49it/s][A
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:05<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:05<00:28,  1.49it/s][A                                                                
                                                                                                               [A2025-10-29 00:53:13,452 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-02-19 00:00:00+00:00-2024-02-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:13,454 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-02-26 00:00:00+00:00 to=2024-03-04 00:00:00+00:00
2025-10-29 00:53:13,577 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-02-26&to=2024-03-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:13,583 - INFO - Successfully fetched 330 records for FUELINST from Insights API.
2025-10-29 00:53:13,584 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:13,586 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:13,586 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:13,587 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:13,587 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:13,592 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:13,592 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:13,593 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:13,593 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:13,593 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:13,594 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:13,594 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:13,594 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:13,602 - INFO - Created hash keys for 330 rows using 3 content columns
2025-10-29 00:53:13,602 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:13,603 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:14,142 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-02-26 00:00:00+00:00-2024-03-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:14,145 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-03-04 00:00:00+00:00 to=2024-03-11 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-04 to 2024-03-11:  17%|‚ñà‚ñã        | 9/52.142857142857146 [00:06<00:28,  1.49it/s][A
Fetching FUELINST from 2024-03-04 to 2024-03-11:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:06<00:28,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:14,275 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-03-04&to=2024-03-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:14,284 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:14,286 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:14,288 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:14,288 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:14,289 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:14,290 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:14,295 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:14,296 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:14,296 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:14,296 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:14,297 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:14,297 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:14,298 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:14,298 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:14,307 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:14,307 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:14,308 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:14,826 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-03-04 00:00:00+00:00-2024-03-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:14,829 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-03-11 00:00:00+00:00 to=2024-03-18 00:00:00+00:00
2025-10-29 00:53:14,945 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-03-11&to=2024-03-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:14,951 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:14,953 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:14,954 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:14,954 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:14,955 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:14,956 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:14,960 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:14,960 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:14,961 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:14,961 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:14,961 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:14,962 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:14,962 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:14,962 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:14,970 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:14,971 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:14,971 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-11 to 2024-03-18:  19%|‚ñà‚ñâ        | 10/52.142857142857146 [00:07<00:28,  1.48it/s][A
Fetching FUELINST from 2024-03-11 to 2024-03-18:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:07<00:27,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-18 to 2024-03-25:  21%|‚ñà‚ñà        | 11/52.142857142857146 [00:08<00:27,  1.50it/s][A
Fetching FUELINST from 2024-03-18 to 2024-03-25:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:15,473 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-03-11 00:00:00+00:00-2024-03-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:15,476 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-03-18 00:00:00+00:00 to=2024-03-25 00:00:00+00:00
2025-10-29 00:53:15,601 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-03-18&to=2024-03-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:15,609 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:15,611 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:15,613 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:15,613 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:15,615 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:15,615 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:15,620 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:15,621 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:15,621 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:15,621 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:15,622 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:15,622 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:15,622 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:15,623 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:15,632 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:15,632 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:15,632 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:16,247 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-03-18 00:00:00+00:00-2024-03-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:16,250 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-03-25 00:00:00+00:00 to=2024-04-01 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-03-25 to 2024-04-01:  23%|‚ñà‚ñà‚ñé       | 12/52.142857142857146 [00:08<00:28,  1.43it/s][A
Fetching FUELINST from 2024-03-25 to 2024-04-01:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:08<00:26,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:16,386 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-03-25&to=2024-04-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:16,390 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:16,391 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:16,392 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:16,393 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:16,393 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:16,394 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:16,398 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:16,398 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:16,398 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:16,398 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:16,399 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:16,399 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:16,399 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:16,399 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:16,406 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:16,406 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:16,407 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:16,859 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-03-25 00:00:00+00:00-2024-04-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:16,862 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-04-01 00:00:00+00:00 to=2024-04-08 00:00:00+00:00
2025-10-29 00:53:16,985 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-04-01&to=2024-04-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:16,992 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:53:16,994 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:16,995 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:16,995 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:16,996 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:16,997 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:17,001 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:17,002 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:17,002 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:17,002 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:17,003 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:17,003 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:17,003 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:17,003 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:17,012 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:53:17,013 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:17,013 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-01 to 2024-04-08:  25%|‚ñà‚ñà‚ñç       | 13/52.142857142857146 [00:09<00:26,  1.49it/s][A
Fetching FUELINST from 2024-04-01 to 2024-04-08:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-08 to 2024-04-15:  27%|‚ñà‚ñà‚ñã       | 14/52.142857142857146 [00:09<00:25,  1.52it/s][A
Fetching FUELINST from 2024-04-08 to 2024-04-15:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.56it/s][A
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:09<00:23,  1.56it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:17,490 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-04-01 00:00:00+00:00-2024-04-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:17,492 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-04-08 00:00:00+00:00 to=2024-04-15 00:00:00+00:00
2025-10-29 00:53:17,606 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-04-08&to=2024-04-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:17,610 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:17,612 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:17,613 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:17,613 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:17,613 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:17,614 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:17,618 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:17,618 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:17,618 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:17,619 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:17,619 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:17,619 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:17,619 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:17,620 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:17,627 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:17,627 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:17,627 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:18,090 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-04-08 00:00:00+00:00-2024-04-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:18,092 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-04-15 00:00:00+00:00 to=2024-04-22 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-15 to 2024-04-22:  29%|‚ñà‚ñà‚ñâ       | 15/52.142857142857146 [00:10<00:23,  1.56it/s][A
Fetching FUELINST from 2024-04-15 to 2024-04-22:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:10<00:22,  1.59it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:18,218 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-04-15&to=2024-04-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:18,225 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:18,227 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:18,228 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:18,229 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:18,229 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:18,230 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:18,235 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:18,235 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:18,236 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:18,237 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:18,237 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:18,237 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:18,238 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:18,238 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:18,247 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:18,247 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:18,247 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:18,683 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-04-15 00:00:00+00:00-2024-04-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:18,685 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-04-22 00:00:00+00:00 to=2024-04-29 00:00:00+00:00
2025-10-29 00:53:18,799 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-04-22&to=2024-04-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:18,805 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:18,807 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:18,808 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:18,809 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:18,810 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:18,810 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:18,815 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:18,815 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:18,816 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:18,816 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:18,817 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:18,817 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:18,817 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:18,818 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:18,826 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:18,827 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:18,827 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-22 to 2024-04-29:  31%|‚ñà‚ñà‚ñà       | 16/52.142857142857146 [00:11<00:22,  1.59it/s][A
Fetching FUELINST from 2024-04-22 to 2024-04-29:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-04-29 to 2024-05-06:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.142857142857146 [00:11<00:22,  1.58it/s][A
Fetching FUELINST from 2024-04-29 to 2024-05-06:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:19,329 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-04-22 00:00:00+00:00-2024-04-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:19,331 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-04-29 00:00:00+00:00 to=2024-05-06 00:00:00+00:00
2025-10-29 00:53:19,446 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-04-29&to=2024-05-06&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:19,453 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:19,455 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:19,456 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:19,457 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:19,458 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:19,458 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:19,463 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:19,464 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:19,464 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:19,464 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:19,465 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:19,465 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:19,466 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:19,466 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:19,475 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:19,475 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:19,475 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:19,947 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-04-29 00:00:00+00:00-2024-05-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:19,949 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-05-06 00:00:00+00:00 to=2024-05-13 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:11<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-06 to 2024-05-13:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.142857142857146 [00:12<00:21,  1.59it/s][A
Fetching FUELINST from 2024-05-06 to 2024-05-13:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:12<00:21,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:20,141 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-05-06&to=2024-05-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:20,151 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:20,153 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:20,155 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:20,155 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:20,156 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:20,157 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:20,163 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:20,164 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:20,164 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:20,164 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:20,165 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:20,165 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:20,166 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:20,166 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:20,176 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:20,176 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:20,176 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:20,691 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-05-06 00:00:00+00:00-2024-05-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:20,693 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-05-13 00:00:00+00:00 to=2024-05-20 00:00:00+00:00
2025-10-29 00:53:20,817 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-05-13&to=2024-05-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:20,821 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:20,822 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:20,823 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:20,823 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:20,824 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:20,824 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:20,828 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:20,828 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:20,828 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:20,828 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:20,829 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:20,829 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:20,829 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:20,829 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:20,835 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:20,836 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:20,836 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-13 to 2024-05-20:  36%|‚ñà‚ñà‚ñà‚ñã      | 19/52.142857142857146 [00:13<00:21,  1.51it/s][A
Fetching FUELINST from 2024-05-13 to 2024-05-20:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-20 to 2024-05-27:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.142857142857146 [00:13<00:21,  1.50it/s][A
Fetching FUELINST from 2024-05-20 to 2024-05-27:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:13<00:20,  1.52it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:21,362 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-05-13 00:00:00+00:00-2024-05-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:21,364 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-05-20 00:00:00+00:00 to=2024-05-27 00:00:00+00:00
2025-10-29 00:53:21,473 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-05-20&to=2024-05-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:21,476 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:21,477 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:21,478 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:21,478 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:21,479 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:21,479 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:21,483 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:21,483 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:21,483 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:21,484 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:21,484 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:21,484 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:21,484 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:21,484 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:21,490 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:21,491 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:21,491 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:21,998 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-05-20 00:00:00+00:00-2024-05-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:22,002 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-05-27 00:00:00+00:00 to=2024-06-03 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-05-27 to 2024-06-03:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.142857142857146 [00:14<00:20,  1.52it/s][A
Fetching FUELINST from 2024-05-27 to 2024-06-03:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:14<00:20,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:22,168 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-05-27&to=2024-06-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:22,176 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:22,178 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:22,179 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:22,180 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:22,180 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:22,181 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:22,186 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:22,187 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:22,187 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:22,187 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:22,188 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:22,188 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:22,188 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:22,189 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:22,198 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:22,198 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:22,198 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:22,719 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-05-27 00:00:00+00:00-2024-06-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:22,720 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-06-03 00:00:00+00:00 to=2024-06-10 00:00:00+00:00
2025-10-29 00:53:22,835 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-06-03&to=2024-06-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:22,839 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:22,840 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:22,841 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:22,841 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:22,841 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:22,842 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:22,845 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:22,845 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:22,845 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:22,845 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:22,846 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:22,846 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:22,846 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:22,846 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:22,852 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:22,852 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:22,852 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-03 to 2024-06-10:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.142857142857146 [00:15<00:20,  1.48it/s][A
Fetching FUELINST from 2024-06-03 to 2024-06-10:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-10 to 2024-06-17:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.142857142857146 [00:15<00:20,  1.46it/s][A
Fetching FUELINST from 2024-06-10 to 2024-06-17:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:19,  1.44it/s][A
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:15<00:19,  1.44it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:23,429 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-06-03 00:00:00+00:00-2024-06-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:23,433 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-06-10 00:00:00+00:00 to=2024-06-17 00:00:00+00:00
2025-10-29 00:53:23,560 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-06-10&to=2024-06-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:23,568 - INFO - Successfully fetched 332 records for FUELINST from Insights API.
2025-10-29 00:53:23,569 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:23,571 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:23,571 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:23,572 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:23,573 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:23,578 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:23,578 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:23,579 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:23,579 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:23,579 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:23,580 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:23,580 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:23,580 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:23,589 - INFO - Created hash keys for 332 rows using 3 content columns
2025-10-29 00:53:23,589 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:23,590 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:24,148 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-06-10 00:00:00+00:00-2024-06-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:24,151 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-06-17 00:00:00+00:00 to=2024-06-24 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-17 to 2024-06-24:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.142857142857146 [00:16<00:19,  1.44it/s][A
Fetching FUELINST from 2024-06-17 to 2024-06-24:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:16<00:18,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:24,289 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-06-17&to=2024-06-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:24,295 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:24,296 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:24,298 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:24,298 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:24,299 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:24,299 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:24,305 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:24,305 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:24,306 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:24,306 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:24,306 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:24,306 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:24,307 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:24,307 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:24,316 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:24,316 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:24,316 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:24,815 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-06-17 00:00:00+00:00-2024-06-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:24,816 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-06-24 00:00:00+00:00 to=2024-07-01 00:00:00+00:00
2025-10-29 00:53:24,937 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-06-24&to=2024-07-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:24,942 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:24,944 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:24,944 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:24,945 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:24,945 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:24,946 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:24,949 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:24,950 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:24,950 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:24,950 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:24,950 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:24,951 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:24,951 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:24,951 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:24,958 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:24,958 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:24,958 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-06-24 to 2024-07-01:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.142857142857146 [00:17<00:18,  1.46it/s][A
Fetching FUELINST from 2024-06-24 to 2024-07-01:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:17<00:18,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-01 to 2024-07-08:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 26/52.142857142857146 [00:18<00:18,  1.41it/s][A
Fetching FUELINST from 2024-07-01 to 2024-07-08:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:25,581 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-06-24 00:00:00+00:00-2024-07-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:25,585 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-07-01 00:00:00+00:00 to=2024-07-08 00:00:00+00:00
2025-10-29 00:53:25,711 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-07-01&to=2024-07-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:25,718 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:25,721 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:25,722 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:25,723 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:25,724 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:25,724 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:25,730 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:25,730 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:25,731 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:25,731 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:25,731 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:25,732 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:25,732 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:25,732 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:25,742 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:25,742 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:25,742 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:26,215 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-07-01 00:00:00+00:00-2024-07-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:26,217 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-07-08 00:00:00+00:00 to=2024-07-15 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-08 to 2024-07-15:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.142857142857146 [00:18<00:17,  1.45it/s][A
Fetching FUELINST from 2024-07-08 to 2024-07-15:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:18<00:16,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:26,345 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-07-08&to=2024-07-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:26,349 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:26,350 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:26,351 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:26,351 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:26,352 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:26,352 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:26,355 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:26,355 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:26,356 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:26,356 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:26,356 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:26,356 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:26,357 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:26,357 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:26,366 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:26,366 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:26,366 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:26,896 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-07-08 00:00:00+00:00-2024-07-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:26,899 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-07-15 00:00:00+00:00 to=2024-07-22 00:00:00+00:00
2025-10-29 00:53:27,031 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-07-15&to=2024-07-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:27,035 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:53:27,037 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:27,038 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:27,038 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:27,039 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:27,040 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:27,044 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:27,044 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:27,045 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:27,045 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:27,045 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:27,046 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:27,046 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:27,046 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:27,054 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:53:27,054 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:27,054 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-15 to 2024-07-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 28/52.142857142857146 [00:19<00:16,  1.46it/s][A
Fetching FUELINST from 2024-07-15 to 2024-07-22:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:19<00:15,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-22 to 2024-07-29:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.142857142857146 [00:20<00:15,  1.49it/s][A
Fetching FUELINST from 2024-07-22 to 2024-07-29:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:27,531 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-07-15 00:00:00+00:00-2024-07-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:27,533 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-07-22 00:00:00+00:00 to=2024-07-29 00:00:00+00:00
2025-10-29 00:53:27,659 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-07-22&to=2024-07-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:27,664 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:27,666 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:27,667 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:27,667 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:27,668 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:27,668 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:27,671 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:27,672 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:27,672 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:27,672 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:27,672 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:27,673 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:27,673 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:27,673 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:27,680 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:27,680 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:27,680 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:28,181 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-07-22 00:00:00+00:00-2024-07-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:28,185 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-07-29 00:00:00+00:00 to=2024-08-05 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-07-29 to 2024-08-05:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.142857142857146 [00:20<00:14,  1.50it/s][A
Fetching FUELINST from 2024-07-29 to 2024-08-05:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:20<00:14,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:28,307 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-07-29&to=2024-08-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:28,311 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:53:28,312 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:28,312 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:28,313 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:28,313 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:28,314 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:28,317 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:28,317 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:28,317 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:28,317 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:28,318 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:28,318 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:28,318 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:28,318 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:28,324 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:53:28,324 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:28,324 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:28,959 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-07-29 00:00:00+00:00-2024-08-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:28,962 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-08-05 00:00:00+00:00 to=2024-08-12 00:00:00+00:00
2025-10-29 00:53:29,100 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-08-05&to=2024-08-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:29,106 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:53:29,108 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:29,109 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:29,109 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:29,110 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:29,111 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:29,114 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:29,115 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:29,115 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:29,115 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:29,116 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:29,116 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:29,116 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:29,116 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:29,124 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:53:29,124 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:29,124 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-05 to 2024-08-12:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.142857142857146 [00:21<00:14,  1.43it/s][A
Fetching FUELINST from 2024-08-05 to 2024-08-12:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:21<00:14,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-12 to 2024-08-19:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.142857142857146 [00:22<00:14,  1.41it/s][A
Fetching FUELINST from 2024-08-12 to 2024-08-19:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:29,689 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-08-05 00:00:00+00:00-2024-08-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:29,691 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-08-12 00:00:00+00:00 to=2024-08-19 00:00:00+00:00
2025-10-29 00:53:29,801 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-08-12&to=2024-08-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:29,805 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:29,807 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:29,808 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:29,808 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:29,809 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:29,809 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:29,813 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:29,814 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:29,814 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:29,814 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:29,815 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:29,815 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:29,815 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:29,815 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:29,822 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:29,823 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:29,823 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:30,256 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-08-12 00:00:00+00:00-2024-08-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:30,258 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-08-19 00:00:00+00:00 to=2024-08-26 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-19 to 2024-08-26:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.142857142857146 [00:22<00:12,  1.50it/s][A
Fetching FUELINST from 2024-08-19 to 2024-08-26:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:22<00:12,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:30,396 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-08-19&to=2024-08-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:30,401 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:30,402 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:30,403 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:30,403 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:30,404 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:30,404 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:30,407 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:30,407 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:30,408 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:30,408 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:30,408 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:30,408 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:30,408 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:30,408 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:30,414 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:30,414 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:30,414 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:30,954 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-08-19 00:00:00+00:00-2024-08-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:30,956 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-08-26 00:00:00+00:00 to=2024-09-02 00:00:00+00:00
2025-10-29 00:53:31,069 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-08-26&to=2024-09-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:31,073 - INFO - Successfully fetched 333 records for FUELINST from Insights API.
2025-10-29 00:53:31,075 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:31,076 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:31,076 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:31,077 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:31,078 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:31,082 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:31,082 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:31,083 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:31,083 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:31,083 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:31,083 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:31,084 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:31,084 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:31,092 - INFO - Created hash keys for 333 rows using 3 content columns
2025-10-29 00:53:31,092 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:31,092 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-08-26 to 2024-09-02:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.142857142857146 [00:23<00:12,  1.48it/s][A
Fetching FUELINST from 2024-08-26 to 2024-09-02:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:23<00:11,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-02 to 2024-09-09:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.142857142857146 [00:24<00:11,  1.54it/s][A
Fetching FUELINST from 2024-09-02 to 2024-09-09:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:31,545 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-08-26 00:00:00+00:00-2024-09-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:31,547 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-09-02 00:00:00+00:00 to=2024-09-09 00:00:00+00:00
2025-10-29 00:53:31,662 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-09-02&to=2024-09-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:31,669 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:31,671 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:31,672 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:31,672 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:31,673 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:31,673 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:31,677 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:31,678 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:31,678 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:31,678 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:31,679 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:31,679 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:31,679 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:31,679 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:31,687 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:31,687 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:31,687 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:32,236 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-09-02 00:00:00+00:00-2024-09-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:32,239 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-09-09 00:00:00+00:00 to=2024-09-16 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-09 to 2024-09-16:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.142857142857146 [00:24<00:10,  1.51it/s][A
Fetching FUELINST from 2024-09-09 to 2024-09-16:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:24<00:10,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:32,373 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-09-09&to=2024-09-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:32,380 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:32,382 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:32,383 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:32,384 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:32,384 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:32,385 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:32,390 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:32,391 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:32,391 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:32,391 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:32,392 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:32,392 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:32,392 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:32,393 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:32,402 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:32,402 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:32,402 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:32,991 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-09-09 00:00:00+00:00-2024-09-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:32,993 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-09-16 00:00:00+00:00 to=2024-09-23 00:00:00+00:00
2025-10-29 00:53:33,124 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-09-16&to=2024-09-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:33,130 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:33,132 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:33,133 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:33,133 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:33,134 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:33,134 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:33,139 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:33,139 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:33,139 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:33,140 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:33,140 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:33,140 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:33,141 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:33,141 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:33,148 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:33,149 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:33,149 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-16 to 2024-09-23:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.142857142857146 [00:25<00:10,  1.45it/s][A
Fetching FUELINST from 2024-09-16 to 2024-09-23:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:25<00:09,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-23 to 2024-09-30:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.142857142857146 [00:26<00:09,  1.46it/s][A
Fetching FUELINST from 2024-09-23 to 2024-09-30:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:33,670 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-09-16 00:00:00+00:00-2024-09-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:33,672 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-09-23 00:00:00+00:00 to=2024-09-30 00:00:00+00:00
2025-10-29 00:53:33,794 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-09-23&to=2024-09-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:33,798 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:33,800 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:33,801 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:33,801 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:33,802 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:33,802 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:33,807 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:33,807 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:33,808 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:33,808 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:33,808 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:33,809 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:33,809 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:33,809 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:33,819 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:33,819 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:33,820 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:34,489 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-09-23 00:00:00+00:00-2024-09-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:34,491 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-09-30 00:00:00+00:00 to=2024-10-07 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-09-30 to 2024-10-07:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 39/52.142857142857146 [00:26<00:09,  1.38it/s][A
Fetching FUELINST from 2024-09-30 to 2024-10-07:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:26<00:08,  1.44it/s][A
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:26<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:26<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:34,599 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-09-30&to=2024-10-07&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:34,606 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:34,608 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:34,609 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:34,609 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:34,610 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:34,610 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:34,615 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:34,615 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:34,615 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:34,616 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:34,616 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:34,616 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:34,617 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:34,617 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:34,625 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:34,625 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:34,625 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:35,110 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-09-30 00:00:00+00:00-2024-10-07 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:35,114 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-10-07 00:00:00+00:00 to=2024-10-14 00:00:00+00:00
2025-10-29 00:53:35,245 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-10-07&to=2024-10-14&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:35,248 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:35,250 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:35,251 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:35,251 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:35,251 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:35,252 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:35,255 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:35,256 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:35,256 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:35,256 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:35,256 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:35,257 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:35,257 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:35,257 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:35,263 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:35,263 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:35,263 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-07 to 2024-10-14:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.142857142857146 [00:27<00:08,  1.44it/s][A
Fetching FUELINST from 2024-10-07 to 2024-10-14:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:27<00:07,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-14 to 2024-10-21:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 41/52.142857142857146 [00:28<00:07,  1.43it/s][A
Fetching FUELINST from 2024-10-14 to 2024-10-21:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:35,816 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-10-07 00:00:00+00:00-2024-10-14 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:35,818 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-10-14 00:00:00+00:00 to=2024-10-21 00:00:00+00:00
2025-10-29 00:53:35,938 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-10-14&to=2024-10-21&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:35,942 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:35,943 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:35,943 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:35,944 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:35,944 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:35,944 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:35,947 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:35,947 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:35,947 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:35,948 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:35,948 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:35,948 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:35,948 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:35,948 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:35,954 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:35,954 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:35,954 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:36,537 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-10-14 00:00:00+00:00-2024-10-21 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:36,539 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-10-21 00:00:00+00:00 to=2024-10-28 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:28<00:07,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-21 to 2024-10-28:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.142857142857146 [00:29<00:07,  1.42it/s][A
Fetching FUELINST from 2024-10-21 to 2024-10-28:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:29<00:06,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:36,658 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-10-21&to=2024-10-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:36,664 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:36,666 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:36,667 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:36,667 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:36,668 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:36,669 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:36,674 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:36,674 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:36,674 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:36,675 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:36,675 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:36,675 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:36,676 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:36,676 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:36,684 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:36,684 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:36,685 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:37,254 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-10-21 00:00:00+00:00-2024-10-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:37,255 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-10-28 00:00:00+00:00 to=2024-11-04 00:00:00+00:00
2025-10-29 00:53:37,373 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-10-28&to=2024-11-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:37,421 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:37,423 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:37,425 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:37,425 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:37,426 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:37,427 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:37,432 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:37,432 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:37,433 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:37,433 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:37,433 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:37,434 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:37,434 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:37,434 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:37,443 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:37,443 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:37,444 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-10-28 to 2024-11-04:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 43/52.142857142857146 [00:30<00:06,  1.41it/s][A
Fetching FUELINST from 2024-10-28 to 2024-11-04:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-04 to 2024-11-11:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.142857142857146 [00:30<00:06,  1.29it/s][A
Fetching FUELINST from 2024-11-04 to 2024-11-11:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:38,176 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-10-28 00:00:00+00:00-2024-11-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:38,179 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-11-04 00:00:00+00:00 to=2024-11-11 00:00:00+00:00
2025-10-29 00:53:38,303 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-11-04&to=2024-11-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:38,309 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:38,311 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:38,311 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:38,312 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:38,312 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:38,313 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:38,319 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:38,319 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:38,319 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:38,319 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:38,320 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:38,320 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:38,320 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:38,320 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:38,329 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:38,329 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:38,329 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:38,856 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-11-04 00:00:00+00:00-2024-11-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:38,860 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-11-11 00:00:00+00:00 to=2024-11-18 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:30<00:05,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-11 to 2024-11-18:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.142857142857146 [00:31<00:05,  1.34it/s][A
Fetching FUELINST from 2024-11-11 to 2024-11-18:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:09<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:31<00:04,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:38,982 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-11-11&to=2024-11-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:38,990 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:38,992 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:38,994 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:38,994 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:38,995 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:38,996 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:39,001 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:39,001 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:39,002 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:39,002 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:39,002 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:39,003 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:39,003 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:39,003 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:39,013 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:39,013 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:39,014 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:39,610 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-11-11 00:00:00+00:00-2024-11-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:39,614 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-11-18 00:00:00+00:00 to=2024-11-25 00:00:00+00:00
2025-10-29 00:53:39,883 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-11-18&to=2024-11-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:39,894 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:39,896 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:39,897 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:39,898 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:39,899 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:39,900 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:39,906 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:39,906 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:39,906 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:39,907 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:39,907 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:39,908 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:39,908 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:39,908 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:39,918 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:39,918 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:39,918 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-18 to 2024-11-25:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.142857142857146 [00:32<00:04,  1.34it/s][A
Fetching FUELINST from 2024-11-18 to 2024-11-25:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:10<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:32<00:04,  1.20it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-11-25 to 2024-12-02:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.142857142857146 [00:33<00:04,  1.20it/s][A
Fetching FUELINST from 2024-11-25 to 2024-12-02:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:40,634 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-11-18 00:00:00+00:00-2024-11-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:40,638 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-11-25 00:00:00+00:00 to=2024-12-02 00:00:00+00:00
2025-10-29 00:53:40,771 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-11-25&to=2024-12-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:40,777 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:40,779 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:40,780 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:40,780 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:40,781 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:40,781 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:40,786 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:40,786 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:40,787 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:40,787 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:40,787 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:40,788 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:40,788 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:40,788 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:40,798 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:40,798 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:40,799 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:41,301 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-11-25 00:00:00+00:00-2024-12-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:41,302 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-12-02 00:00:00+00:00 to=2024-12-09 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-02 to 2024-12-09:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.142857142857146 [00:33<00:03,  1.28it/s][A
Fetching FUELINST from 2024-12-02 to 2024-12-09:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:02,  1.29it/s][A
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:11<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:33<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:41,438 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-12-02&to=2024-12-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:41,443 - INFO - Successfully fetched 328 records for FUELINST from Insights API.
2025-10-29 00:53:41,445 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:41,446 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:41,447 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:41,447 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:41,448 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:41,452 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:41,452 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:41,453 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:41,453 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:41,453 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:41,454 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:41,454 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:41,454 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:41,462 - INFO - Created hash keys for 328 rows using 3 content columns
2025-10-29 00:53:41,462 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:41,462 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:42,067 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-12-02 00:00:00+00:00-2024-12-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:42,071 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-12-09 00:00:00+00:00 to=2024-12-16 00:00:00+00:00
2025-10-29 00:53:42,208 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-12-09&to=2024-12-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:42,214 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:53:42,215 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:42,216 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:42,216 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:42,217 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:42,217 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:42,221 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:42,222 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:42,222 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:42,222 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:42,222 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:42,223 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:42,223 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:42,223 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:42,230 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:53:42,231 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:42,231 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-09 to 2024-12-16:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.142857142857146 [00:34<00:02,  1.29it/s][A
Fetching FUELINST from 2024-12-09 to 2024-12-16:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:12<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:34<00:01,  1.32it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-16 to 2024-12-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.142857142857146 [00:35<00:01,  1.32it/s][A
Fetching FUELINST from 2024-12-16 to 2024-12-23:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [A2025-10-29 00:53:42,783 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-12-09 00:00:00+00:00-2024-12-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:42,786 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-12-16 00:00:00+00:00 to=2024-12-23 00:00:00+00:00
2025-10-29 00:53:42,910 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-12-16&to=2024-12-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:42,916 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:53:42,918 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:42,919 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:42,920 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:42,921 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:42,922 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:42,927 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:42,927 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:42,928 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:42,928 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:42,928 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:42,929 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:42,929 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:42,929 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:42,939 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:53:42,939 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:42,939 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:43,501 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-12-16 00:00:00+00:00-2024-12-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:43,504 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-12-23 00:00:00+00:00 to=2024-12-30 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:13<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:35<00:00,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-23 to 2024-12-30:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.142857142857146 [00:36<00:00,  1.34it/s][A
Fetching FUELINST from 2024-12-23 to 2024-12-30: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:53:43,627 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-12-23&to=2024-12-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:43,636 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:53:43,637 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:43,639 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:43,639 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:43,640 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:43,641 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:43,646 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:43,647 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:43,647 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:43,648 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:43,648 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:43,648 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:43,649 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:43,649 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:43,659 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:53:43,659 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:43,659 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:53:44,166 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-12-23 00:00:00+00:00-2024-12-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:44,169 - INFO - üåê Fetching BMRS dataset=FUELINST from=2024-12-30 00:00:00+00:00 to=2024-12-31 00:00:00+00:00
2025-10-29 00:53:44,266 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2024-12-30&to=2024-12-31&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:44,268 - INFO - Successfully fetched 49 records for FUELINST from Insights API.
2025-10-29 00:53:44,269 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:53:44,270 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:44,271 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:53:44,271 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:53:44,272 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:53:44,273 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:53:44,273 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:44,273 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:44,274 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:44,274 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:44,274 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:44,274 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:44,275 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:44,277 - INFO - Created hash keys for 49 rows using 3 content columns
2025-10-29 00:53:44,277 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:53:44,277 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:14<00:36, 36.97s/it]
Fetching FUELINST from 2024-12-30 to 2024-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 52/52.142857142857146 [00:36<00:00,  1.39it/s][A
Fetching FUELINST from 2024-12-30 to 2024-12-31: : 53it [00:36,  1.31it/s]                                      [A
                                                                          [ADataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [01:14<00:00, 37.57s/it]Dataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [01:14<00:00, 37.48s/it]
2025-10-29 00:53:45,031 - ERROR - ‚ùå Failed to load data for FUELINST in window 2024-12-30 00:00:00+00:00-2024-12-31 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:53:45,034 - INFO - ‚úÖ Ingestion run completed.
