2025-10-29 00:50:19,203 - INFO - BigQuery dataset 'uk_energy_prod' exists.
All Datasets:   0%|          | 0/2 [00:00<?, ?it/s]Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]2025-10-29 00:50:19,234 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh between 2023-01-01 00:00:00+00:00 and 2023-12-31 00:00:00+00:00
2025-10-29 00:50:20,652 - INFO - Found 27 existing windows for bmrs_fuelhh
2025-10-29 00:50:20,652 - INFO - Found 27 existing windows for FUELHH. Will skip these.

Windows for FUELHH:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELHH from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                      
                                                                                       [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELHH from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:00, 2644.58it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:00, 1628.22it/s][A
Fetching FUELHH from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:00<00:00, 2877.74it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:00<00:00, 2249.56it/s][A
Fetching FUELHH from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:00<00:00, 3157.57it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:00<00:00, 2592.81it/s][A
Fetching FUELHH from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:00<00:00, 3262.78it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:00<00:00, 2881.69it/s][A
Fetching FUELHH from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:00<00:00, 3445.86it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:00<00:00, 3117.05it/s][A
Fetching FUELHH from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:00<00:00, 3603.35it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:00<00:00, 3293.09it/s][A
Fetching FUELHH from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:00<00:00, 3584.00it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:00<00:00, 2956.11it/s][A
Fetching FUELHH from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:00<00:00, 3214.03it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:00<00:00, 2968.37it/s][A
Fetching FUELHH from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:00<00:00, 3238.29it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:00<00:00, 3007.87it/s][A
Fetching FUELHH from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:00<00:00, 3258.47it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:00<00:00, 3075.00it/s][A
Fetching FUELHH from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:00<00:00, 3315.18it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:00<00:00, 3159.88it/s][A
Fetching FUELHH from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:00<00:00, 3386.83it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:00<00:00, 3242.39it/s][A
Fetching FUELHH from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:00<00:00, 3451.01it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:00<00:00, 3317.87it/s][A
Fetching FUELHH from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:00<00:00, 3521.88it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:00<00:00, 3387.19it/s][A
Fetching FUELHH from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:00<00:00, 3578.15it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:00<00:00, 3457.79it/s][A
Fetching FUELHH from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:00<00:00, 3642.27it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:00<00:00, 3528.15it/s][A
Fetching FUELHH from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:00<00:00, 3702.71it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:00<00:00, 3532.83it/s][A
Fetching FUELHH from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:00<00:00, 3697.59it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:00<00:00, 3589.99it/s][A
Fetching FUELHH from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:00<00:00, 3747.56it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:00<00:00, 3644.72it/s][A
Fetching FUELHH from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:00<00:00, 3795.06it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:00<00:00, 3629.70it/s][A
Fetching FUELHH from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:00<00:00, 3745.23it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:00<00:00, 3598.35it/s][A
Fetching FUELHH from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:00<00:00, 3726.91it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:00<00:00, 3621.88it/s][A
Fetching FUELHH from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:00<00:00, 3748.26it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:00<00:00, 3654.82it/s][A
Fetching FUELHH from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:00<00:00, 3775.39it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:00<00:00, 3686.63it/s][A
Fetching FUELHH from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:00<00:00, 3806.77it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:00<00:00, 3717.43it/s][A
Fetching FUELHH from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:00<00:00, 3832.03it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:00<00:00, 3371.42it/s][A
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 3474.34it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 3397.52it/s][A                                                      
                                                                                                  [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 255.60it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 253.11it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 250.56it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 249.96it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 249.07it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 248.16it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 247.58it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 247.03it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 246.57it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 246.11it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 245.53it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 245.04it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 244.62it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 244.20it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 243.86it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 243.63it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 240.82it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 240.52it/s][A                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 240.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                 [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:00<00:00, 34.99it/s][A
Fetching FUELHH from 2023-07-09 to 2023-07-16:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [A2025-10-29 00:50:20,653 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-01-01
2025-10-29 00:50:20,653 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-01-08
2025-10-29 00:50:20,653 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-01-15
2025-10-29 00:50:20,654 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-01-22
2025-10-29 00:50:20,654 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-01-29
2025-10-29 00:50:20,654 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-02-05
2025-10-29 00:50:20,654 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-02-12
2025-10-29 00:50:20,655 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-02-19
2025-10-29 00:50:20,655 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-02-26
2025-10-29 00:50:20,655 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-03-05
2025-10-29 00:50:20,656 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-03-12
2025-10-29 00:50:20,656 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-03-19
2025-10-29 00:50:20,656 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-03-26
2025-10-29 00:50:20,656 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-04-02
2025-10-29 00:50:20,657 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-04-09
2025-10-29 00:50:20,657 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-04-16
2025-10-29 00:50:20,657 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-04-23
2025-10-29 00:50:20,657 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-04-30
2025-10-29 00:50:20,658 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-05-07
2025-10-29 00:50:20,658 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-05-14
2025-10-29 00:50:20,658 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-05-21
2025-10-29 00:50:20,658 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-05-28
2025-10-29 00:50:20,659 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-06-04
2025-10-29 00:50:20,659 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-06-11
2025-10-29 00:50:20,659 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-06-18
2025-10-29 00:50:20,659 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-06-25
2025-10-29 00:50:20,659 - INFO - ‚è≠Ô∏è  Skipping already-loaded window: FUELHH 2023-07-02
2025-10-29 00:50:20,660 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-07-09 00:00:00+00:00 to=2023-07-16 00:00:00+00:00
2025-10-29 00:50:20,758 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-07-09&to=2023-07-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:20,759 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:20,760 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:20,761 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:20,761 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:20,761 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:20,762 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:20,762 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:20,762 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:20,762 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:20,762 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:20,763 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:20,763 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:20,763 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:20,763 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:20,763 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:20,765 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:20,765 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:20,765 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:21,416 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-07-09 00:00:00+00:00-2023-07-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:21,425 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-07-16 00:00:00+00:00 to=2023-07-23 00:00:00+00:00
2025-10-29 00:50:21,518 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-07-16&to=2023-07-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:21,519 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:21,521 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:21,521 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
Dataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:00<00:00, 36.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:01<00:00, 36.28it/s][A
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:01<00:00, 36.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:21,522 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:21,523 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:21,523 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:21,523 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:21,524 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:21,524 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:21,524 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:21,525 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:21,525 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:21,525 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:21,526 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:21,526 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:21,528 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:21,528 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:21,528 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:22,083 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-07-16 00:00:00+00:00-2023-07-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:22,085 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-07-23 00:00:00+00:00 to=2023-07-30 00:00:00+00:00
2025-10-29 00:50:22,175 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-07-23&to=2023-07-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:22,176 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:22,177 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:22,178 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:22,178 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:22,179 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:22,179 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:22,179 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:22,180 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:22,180 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:22,180 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:22,181 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:22,181 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:22,181 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:22,181 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:22,182 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:22,183 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:22,184 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:22,184 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:02<00:00, 36.28it/s][A
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:02<00:00, 36.28it/s][A
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [A2025-10-29 00:50:22,768 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-07-23 00:00:00+00:00-2023-07-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:22,769 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-07-30 00:00:00+00:00 to=2023-08-06 00:00:00+00:00
2025-10-29 00:50:22,843 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-07-30&to=2023-08-06&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:22,844 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:22,845 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:22,845 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:22,846 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:22,846 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:22,846 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:22,847 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:22,847 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:22,847 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:22,847 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:22,847 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:22,848 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:22,848 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:22,848 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:22,848 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:22,850 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:22,850 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:22,850 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:23,487 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-07-30 00:00:00+00:00-2023-08-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:02<00:00, 36.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:03<00:00, 36.28it/s][A
Fetching FUELHH from 2023-08-06 to 2023-08-13:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:03<00:02,  7.15it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:23,490 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-06 00:00:00+00:00 to=2023-08-13 00:00:00+00:00
2025-10-29 00:50:23,579 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-06&to=2023-08-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:23,580 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:23,582 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:23,582 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:23,583 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:23,583 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:23,584 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:23,584 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:23,584 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:23,585 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:23,585 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:23,585 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:23,586 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:23,586 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:23,586 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:23,587 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:23,589 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:23,590 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:23,590 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:24,182 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-08-06 00:00:00+00:00-2023-08-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:24,185 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-13 00:00:00+00:00 to=2023-08-20 00:00:00+00:00
2025-10-29 00:50:24,280 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-13&to=2023-08-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:24,281 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:24,282 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:24,283 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:24,283 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:24,284 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:24,284 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:24,285 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:24,285 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:24,285 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:24,286 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:24,286 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:24,286 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:24,287 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:24,287 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:24,287 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:24,290 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:24,290 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:24,290 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:04<00:02,  7.15it/s][A
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:04<00:02,  7.15it/s][A
Fetching FUELHH from 2023-08-20 to 2023-08-27:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:04<00:03,  4.99it/s][A
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:04<00:03,  4.99it/s][A                                                      
                                                                                                [A2025-10-29 00:50:24,906 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-08-13 00:00:00+00:00-2023-08-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:24,910 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-20 00:00:00+00:00 to=2023-08-27 00:00:00+00:00
2025-10-29 00:50:25,003 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-20&to=2023-08-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:25,004 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:25,006 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:25,006 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:25,007 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:25,007 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:25,008 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:25,008 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:25,008 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:25,009 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:25,009 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:25,010 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:25,010 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:25,010 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:25,010 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:25,011 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:25,012 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:25,012 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:25,012 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:25,582 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-08-20 00:00:00+00:00-2023-08-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:04<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:05<00:03,  4.99it/s][A
Fetching FUELHH from 2023-08-27 to 2023-09-03:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:05<00:03,  4.30it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:25,584 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-27 00:00:00+00:00 to=2023-09-03 00:00:00+00:00
2025-10-29 00:50:25,675 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-27&to=2023-09-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:25,677 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:25,678 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:25,678 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:25,679 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:25,679 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:25,680 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:25,680 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:25,680 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:25,681 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:25,681 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:25,681 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:25,681 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:25,682 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:25,682 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:25,682 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:25,684 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:25,684 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:25,684 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:26,231 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-08-27 00:00:00+00:00-2023-09-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:26,235 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-03 00:00:00+00:00 to=2023-09-10 00:00:00+00:00
2025-10-29 00:50:26,326 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-03&to=2023-09-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:26,334 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:26,335 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:26,336 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:26,336 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:26,336 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:26,337 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:26,337 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:26,337 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:26,338 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:26,338 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:26,339 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:26,339 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:26,339 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:26,340 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:26,340 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:26,342 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:26,342 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:26,342 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:06<00:03,  4.30it/s][A
Fetching FUELHH from 2023-09-03 to 2023-09-10:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:06<00:04,  3.57it/s][A
Fetching FUELHH from 2023-09-10 to 2023-09-17:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:06<00:04,  3.17it/s][A
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:06<00:04,  3.17it/s][A                                                      
                                                                                                [A2025-10-29 00:50:26,979 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-09-03 00:00:00+00:00-2023-09-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:26,981 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-10 00:00:00+00:00 to=2023-09-17 00:00:00+00:00
2025-10-29 00:50:27,065 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-10&to=2023-09-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:27,066 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:27,067 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:27,067 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:27,067 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:27,068 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:27,068 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:27,069 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:27,069 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:27,069 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:27,069 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:27,070 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:27,070 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:27,070 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:27,071 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:27,071 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:27,072 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:27,072 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:27,073 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:27,560 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-09-10 00:00:00+00:00-2023-09-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:06<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:07<00:04,  3.17it/s][A
Fetching FUELHH from 2023-09-17 to 2023-09-24:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:07<00:04,  2.80it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:27,564 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-17 00:00:00+00:00 to=2023-09-24 00:00:00+00:00
2025-10-29 00:50:27,653 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-17&to=2023-09-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:27,654 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:27,655 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:27,655 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:27,656 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:27,656 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:27,656 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:27,657 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:27,657 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:27,657 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:27,658 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:27,658 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:27,658 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:27,659 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:27,659 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:27,659 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:27,661 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:27,661 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:27,661 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:28,166 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-09-17 00:00:00+00:00-2023-09-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:28,167 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-24 00:00:00+00:00 to=2023-10-01 00:00:00+00:00
2025-10-29 00:50:28,232 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-24&to=2023-10-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:28,233 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:28,233 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:28,234 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:28,234 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:28,234 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:28,235 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:28,235 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:28,235 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:28,235 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:28,235 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:28,236 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:28,236 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:28,236 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:28,236 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:28,237 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:28,238 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:28,238 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:28,238 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:08<00:04,  2.80it/s][A
Fetching FUELHH from 2023-09-24 to 2023-10-01:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:08<00:05,  2.51it/s][A
Fetching FUELHH from 2023-10-01 to 2023-10-08:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:08<00:05,  2.08it/s][A
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:08<00:05,  2.08it/s][A                                                      
                                                                                                [A2025-10-29 00:50:28,763 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-09-24 00:00:00+00:00-2023-10-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:28,766 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-01 00:00:00+00:00 to=2023-10-08 00:00:00+00:00
2025-10-29 00:50:28,860 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-01&to=2023-10-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:28,862 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:28,863 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:28,863 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:28,864 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:28,865 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:28,865 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:28,866 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:28,866 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:28,866 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:28,867 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:28,867 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:28,868 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:28,868 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:28,868 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:28,868 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:28,870 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:28,871 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:28,871 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:29,584 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-10-01 00:00:00+00:00-2023-10-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:08<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:08<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:09<00:05,  2.08it/s][A
Fetching FUELHH from 2023-10-08 to 2023-10-15:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:09<00:05,  1.93it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:29,585 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-08 00:00:00+00:00 to=2023-10-15 00:00:00+00:00
2025-10-29 00:50:29,652 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-08&to=2023-10-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:29,653 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:29,654 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:29,654 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:29,655 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:29,655 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:29,656 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:29,656 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:29,656 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:29,656 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:29,657 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:29,657 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:29,657 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:29,657 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:29,658 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:29,658 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:29,659 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:29,659 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:29,659 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:30,239 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-10-08 00:00:00+00:00-2023-10-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:30,242 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-15 00:00:00+00:00 to=2023-10-22 00:00:00+00:00
2025-10-29 00:50:30,345 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-15&to=2023-10-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:30,346 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:30,347 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:30,348 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:30,348 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:30,349 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:30,349 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:30,349 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:30,350 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:30,350 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:30,351 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:30,351 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:30,351 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:30,352 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:30,352 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:30,352 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:30,354 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:30,354 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:30,355 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:10<00:05,  1.93it/s][A
Fetching FUELHH from 2023-10-15 to 2023-10-22:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:10<00:05,  1.86it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:11<00:05,  1.86it/s][A
Fetching FUELHH from 2023-10-22 to 2023-10-29:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [A2025-10-29 00:50:30,830 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-10-15 00:00:00+00:00-2023-10-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:30,835 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-22 00:00:00+00:00 to=2023-10-29 00:00:00+00:00
2025-10-29 00:50:30,932 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-22&to=2023-10-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:30,934 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:30,935 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:30,935 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:30,936 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:30,936 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:30,937 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:30,937 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:30,937 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:30,938 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:30,938 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:30,938 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:30,939 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:30,939 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:30,939 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:30,939 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:30,941 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:30,941 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:30,941 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:31,657 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-10-22 00:00:00+00:00-2023-10-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:11<00:05,  1.64it/s][A
Fetching FUELHH from 2023-10-29 to 2023-11-05:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:11<00:04,  1.64it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:31,661 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-29 00:00:00+00:00 to=2023-11-05 00:00:00+00:00
2025-10-29 00:50:31,754 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-29&to=2023-11-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:31,756 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:31,757 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:31,757 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:31,758 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:31,758 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:31,759 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:31,759 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:31,760 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:31,760 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:31,760 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:31,761 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:31,761 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:31,761 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:31,761 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:31,762 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:31,763 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:31,763 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:31,764 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:32,273 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-10-29 00:00:00+00:00-2023-11-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:32,276 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-05 00:00:00+00:00 to=2023-11-12 00:00:00+00:00
2025-10-29 00:50:32,353 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-05&to=2023-11-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:32,362 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:32,363 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:32,363 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:32,363 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:32,364 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:32,364 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:32,364 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:32,365 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:32,365 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:32,365 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:32,366 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:32,366 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:32,366 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:32,366 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:32,366 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:32,368 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:32,368 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:32,368 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:12<00:04,  1.64it/s][A
Fetching FUELHH from 2023-11-05 to 2023-11-12:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:12<00:04,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:13<00:04,  1.55it/s][A
Fetching FUELHH from 2023-11-12 to 2023-11-19:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [A2025-10-29 00:50:33,000 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-11-05 00:00:00+00:00-2023-11-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:33,004 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-12 00:00:00+00:00 to=2023-11-19 00:00:00+00:00
2025-10-29 00:50:33,096 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-12&to=2023-11-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:33,097 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:33,099 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,099 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:33,100 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:33,100 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:33,101 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:33,101 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:33,101 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:33,102 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:33,102 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:33,102 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:33,103 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:33,103 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:33,103 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:33,103 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:33,105 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:33,106 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,106 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:33,686 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-11-12 00:00:00+00:00-2023-11-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:13<00:03,  1.53it/s][A
Fetching FUELHH from 2023-11-19 to 2023-11-26:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:13<00:03,  1.56it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:33,690 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-19 00:00:00+00:00 to=2023-11-26 00:00:00+00:00
2025-10-29 00:50:33,787 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-19&to=2023-11-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:33,788 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:33,789 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,789 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:33,789 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:33,790 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:33,790 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:33,790 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:33,790 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:33,791 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:33,791 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:33,791 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:33,791 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:33,791 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:33,792 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:33,792 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:33,793 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:33,793 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,793 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:34,292 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-11-19 00:00:00+00:00-2023-11-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:34,294 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-26 00:00:00+00:00 to=2023-12-03 00:00:00+00:00
2025-10-29 00:50:34,376 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-26&to=2023-12-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:34,377 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:34,378 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:34,378 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:34,378 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:34,379 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:34,379 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:34,379 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:34,379 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:34,380 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:34,380 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:34,380 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:34,380 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:34,381 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:34,381 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:34,381 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:34,382 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:34,382 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:34,383 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:14<00:03,  1.56it/s][A
Fetching FUELHH from 2023-11-26 to 2023-12-03:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:14<00:02,  1.56it/s][A
Fetching FUELHH from 2023-12-03 to 2023-12-10:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:14<00:01,  1.56it/s][A
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:14<00:01,  1.56it/s][A                                                      
                                                                                                [A2025-10-29 00:50:34,933 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-11-26 00:00:00+00:00-2023-12-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:34,937 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-03 00:00:00+00:00 to=2023-12-10 00:00:00+00:00
2025-10-29 00:50:35,037 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-03&to=2023-12-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:35,038 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:35,040 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:35,040 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:35,041 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:35,041 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:35,041 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:35,042 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:35,042 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:35,043 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:35,043 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:35,044 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:35,044 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:35,045 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:35,045 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:35,045 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:35,047 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:35,047 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:35,047 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:35,574 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-12-03 00:00:00+00:00-2023-12-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:14<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:15<00:01,  1.56it/s][A
Fetching FUELHH from 2023-12-10 to 2023-12-17:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:15<00:01,  1.35it/s][A
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:15<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:15<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [A2025-10-29 00:50:35,575 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-10 00:00:00+00:00 to=2023-12-17 00:00:00+00:00
2025-10-29 00:50:35,657 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-10&to=2023-12-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:35,657 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:35,658 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:35,658 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:35,658 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:35,659 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:35,659 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:35,659 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:35,659 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:35,659 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:35,660 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:35,660 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:35,661 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:35,662 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:35,662 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:35,662 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:35,663 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:35,663 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:35,663 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:36,559 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-12-10 00:00:00+00:00-2023-12-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:36,563 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-17 00:00:00+00:00 to=2023-12-24 00:00:00+00:00
2025-10-29 00:50:36,655 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-17&to=2023-12-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:36,657 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:36,658 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:36,658 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:36,659 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:36,660 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:36,660 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:36,660 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:36,661 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:36,661 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:36,661 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:36,662 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:36,662 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:36,662 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:36,663 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:36,663 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:36,665 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:36,665 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:36,665 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:16<00:01,  1.35it/s][A
Fetching FUELHH from 2023-12-17 to 2023-12-24:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:16<00:00,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:17<00:00,  1.44it/s][A
Fetching FUELHH from 2023-12-24 to 2023-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 52/52.0 [00:17<00:00,  1.46it/s][A
                                                                                                [ADataset: FUELHH:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:18<00:18, 18.57s/it]Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:18<00:18, 18.57s/it]                                                                2025-10-29 00:50:37,146 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-12-17 00:00:00+00:00-2023-12-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:50:37,150 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-24 00:00:00+00:00 to=2023-12-31 00:00:00+00:00
2025-10-29 00:50:37,265 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-24&to=2023-12-31&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:37,266 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:50:37,268 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:37,269 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:50:37,269 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:50:37,270 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:50:37,270 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:50:37,271 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:50:37,272 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:50:37,272 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:37,273 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:37,273 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:37,274 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:37,274 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:37,274 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:37,274 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:37,276 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:50:37,277 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:37,277 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:37,798 - ERROR - ‚ùå Failed to load data for FUELHH in window 2023-12-24 00:00:00+00:00-2023-12-31 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:18<00:18, 18.57s/it]                                                                Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]2025-10-29 00:50:37,801 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelinst between 2023-01-01 00:00:00+00:00 and 2023-12-31 00:00:00+00:00
2025-10-29 00:50:38,990 - INFO - Found 0 existing windows for bmrs_fuelinst

Windows for FUELINST:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:19<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2023-01-01 to 2023-01-08:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:20<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:38,  1.32it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                 [A2025-10-29 00:50:38,990 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-01 00:00:00+00:00 to=2023-01-08 00:00:00+00:00
2025-10-29 00:50:39,089 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-01&to=2023-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:39,098 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:50:39,101 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:39,102 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:39,102 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:50:39,103 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:39,103 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:39,106 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:39,107 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:39,107 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:39,112 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:50:39,112 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:39,112 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:50:39,743 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-01 00:00:00+00:00-2023-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:50:39,746 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-08 00:00:00+00:00 to=2023-01-15 00:00:00+00:00
2025-10-29 00:50:39,919 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-08&to=2023-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:39,924 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:50:39,925 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:39,926 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:39,926 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:50:39,926 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:39,927 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:39,929 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:50:39,929 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:39,930 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:39,930 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:39,930 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:39,930 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:39,930 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:39,930 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:39,936 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:50:39,937 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:39,937 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:01<00:38,  1.32it/s][A
Fetching FUELINST from 2023-01-08 to 2023-01-15:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:21<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:39,  1.25it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:02<00:39,  1.25it/s][A
Fetching FUELINST from 2023-01-15 to 2023-01-22:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [A2025-10-29 00:50:40,574 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-08 00:00:00+00:00-2023-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:50:40,576 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-15 00:00:00+00:00 to=2023-01-22 00:00:00+00:00
2025-10-29 00:50:40,684 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-15&to=2023-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:40,689 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:50:40,690 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:40,691 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:40,691 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:50:40,691 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:40,691 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:40,694 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:50:40,694 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:40,694 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:40,695 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:40,695 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:40,695 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:40,695 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:40,695 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:40,700 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:50:40,700 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:40,701 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:50:41,300 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-15 00:00:00+00:00-2023-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:50:41,302 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-22 00:00:00+00:00 to=2023-01-29 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:37,  1.31it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:03<00:37,  1.31it/s][A
Fetching FUELINST from 2023-01-22 to 2023-01-29:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:22<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A                                                                
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:23<00:18, 18.57s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:39,  1.22it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                 [A2025-10-29 00:50:41,419 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-22&to=2023-01-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:41,427 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:50:41,429 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:41,429 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:41,430 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:50:41,431 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:41,431 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:41,435 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:50:41,435 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:41,435 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:41,436 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:41,436 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:41,436 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:41,436 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:41,437 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:41,444 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:50:41,444 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:50:41,444 - WARNING - Could not find corrected schema for FUELINST.                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [02:01<01:03,  3.34s/it][A
Fetching FUELHH from 2023-08-20 to 2023-08-27:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [A2025-10-29 00:50:33,906 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-06&to=2023-08-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:33,906 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:33,973 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:33,973 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:33,974 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:33,974 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,975 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:33,975 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:33,975 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:33,975 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:33,976 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:33,976 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:33,976 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:33,976 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:33,976 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:33,977 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:33,977 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:33,977 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:33,977 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:33,977 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:33,977 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:33,979 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:33,979 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:33,979 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:37,425 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-08-06
2025-10-29 00:50:37,426 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-13 00:00:00+00:00 to=2023-08-20 00:00:00+00:00
2025-10-29 00:50:37,510 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-13&to=2023-08-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:37,511 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:37,599 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:37,599 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:37,600 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:37,601 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:37,601 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:37,602 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:37,602 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:37,603 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:37,603 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:37,603 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:37,603 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:37,604 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:37,604 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:37,604 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:37,605 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:37,605 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:37,605 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:37,605 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:37,605 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:37,607 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:37,607 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:37,607 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:40,483 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-08-13
2025-10-29 00:50:40,485 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-20 00:00:00+00:00 to=2023-08-27 00:00:00+00:00
2025-10-29 00:50:40,583 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-20&to=2023-08-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:40,584 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:40,673 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:40,674 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:40,674 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:40,675 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:40,676 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:40,676 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:40,676 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:40,677 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:40,677 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:40,677 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:40,677 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:40,678 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:40,678 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:40,678 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:40,678 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:40,679 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:40,679 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:40,679 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:40,679 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:40,681 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:40,681 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:40,681 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:43,773 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-08-20
2025-10-29 00:50:43,774 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-08-27 00:00:00+00:00 to=2023-09-03 00:00:00+00:00
2025-10-29 00:50:43,855 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-08-27&to=2023-09-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:43,855 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
Dataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:03<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:01<00:59,  3.32s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [02:05<00:59,  3.32s/it][A
Fetching FUELHH from 2023-08-27 to 2023-09-03:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:05<01:01,  3.60s/it][A
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:05<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:05<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:05<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:05<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:07<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:06<01:01,  3.60s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [02:10<01:01,  3.60s/it][A
Fetching FUELHH from 2023-09-03 to 2023-09-10:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:11<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:10<01:01,  3.84s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [02:13<01:01,  3.84s/it][A
Fetching FUELHH from 2023-09-10 to 2023-09-17:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [A2025-10-29 00:50:43,936 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:43,937 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:43,938 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:43,938 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:43,939 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:43,939 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:43,939 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:43,940 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:43,940 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:43,940 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:43,940 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:43,941 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:43,941 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:43,941 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:43,941 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:43,942 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:43,942 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:43,942 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:43,942 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:43,944 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:43,944 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:43,944 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:48,028 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-08-27
2025-10-29 00:50:48,029 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-03 00:00:00+00:00 to=2023-09-10 00:00:00+00:00
2025-10-29 00:50:48,128 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-03&to=2023-09-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:48,129 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:48,214 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:48,215 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:48,215 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:48,216 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:48,216 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:48,216 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:48,217 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:48,217 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:48,217 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:48,218 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:48,218 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:48,218 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:48,218 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:48,219 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:48,219 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:48,219 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:48,219 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:48,220 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:48,220 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:48,222 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:48,222 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:48,222 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:52,411 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-09-03
2025-10-29 00:50:52,412 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-10 00:00:00+00:00 to=2023-09-17 00:00:00+00:00
2025-10-29 00:50:52,541 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-10&to=2023-09-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:52,541 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:52,613 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:52,613 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:52,613 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:52,614 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:52,614 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:52,615 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:52,615 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:52,615 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:52,615 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:52,616 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:52,616 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:52,616 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:52,617 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:52,617 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:52,619 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:52,619 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:52,619 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:55,935 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-09-10
2025-10-29 00:50:55,937 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-17 00:00:00+00:00 to=2023-09-24 00:00:00+00:00
2025-10-29 00:50:56,029 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-17&to=2023-09-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:56,029 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:56,113 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:56,114 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:56,114 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
Dataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:15<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:13<00:56,  3.74s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [02:16<00:56,  3.74s/it][A
Fetching FUELHH from 2023-09-17 to 2023-09-24:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:18<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:16<00:49,  3.53s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [02:19<00:49,  3.53s/it][A
Fetching FUELHH from 2023-09-24 to 2023-10-01:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:19<00:44,  3.40s/it][A
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:19<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:19<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:21<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:20<00:44,  3.40s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [02:23<00:44,  3.40s/it][A
Fetching FUELHH from 2023-10-01 to 2023-10-08:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [A2025-10-29 00:50:56,115 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:56,115 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:56,115 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:56,115 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:56,116 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:56,116 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:56,116 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:56,116 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:56,117 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:56,117 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:56,117 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:56,117 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:56,117 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:56,117 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:56,118 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:56,118 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:56,119 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:56,119 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:56,119 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:50:58,958 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-09-17
2025-10-29 00:50:58,959 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-09-24 00:00:00+00:00 to=2023-10-01 00:00:00+00:00
2025-10-29 00:50:59,028 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-09-24&to=2023-10-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:50:59,029 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:50:59,105 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:50:59,105 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:50:59,106 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:50:59,106 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:59,107 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:50:59,107 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:50:59,107 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:50:59,107 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:50:59,108 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:50:59,108 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:50:59,108 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:50:59,108 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:50:59,109 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:50:59,110 - INFO - --- Final sanitization complete ---
2025-10-29 00:50:59,111 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:50:59,111 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:50:59,111 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:02,055 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-09-24
2025-10-29 00:51:02,056 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-01 00:00:00+00:00 to=2023-10-08 00:00:00+00:00
2025-10-29 00:51:02,152 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-01&to=2023-10-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:02,153 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:02,246 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:02,247 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:02,248 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:02,249 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:02,249 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:02,249 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:02,250 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:02,250 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:02,250 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:02,251 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:02,251 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:02,251 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:02,252 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:02,252 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:02,252 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:02,252 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:02,253 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:02,253 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:02,253 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:02,255 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:02,255 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:02,255 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:05,310 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-10-01
2025-10-29 00:51:05,311 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-08 00:00:00+00:00 to=2023-10-15 00:00:00+00:00
2025-10-29 00:51:05,397 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-08&to=2023-10-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:05,398 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:05,477 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:05,478 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:05,478 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:05,479 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:05,479 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:05,479 - INFO -  -> Forced object column 'dataset' to string.
Dataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:24<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:23<00:40,  3.36s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:27<?, ?it/s]
Fetching FUELHH from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [02:26<00:40,  3.36s/it][A
Fetching FUELHH from 2023-10-08 to 2023-10-15:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:27<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:28<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:26<00:37,  3.37s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:31<?, ?it/s]
Fetching FUELHH from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [02:30<00:37,  3.37s/it][A
Fetching FUELHH from 2023-10-15 to 2023-10-22:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:31<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:31<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:31<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:32<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:30<00:35,  3.53s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [02:33<00:35,  3.53s/it][A
Fetching FUELHH from 2023-10-22 to 2023-10-29:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [A2025-10-29 00:51:05,480 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:05,480 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:05,481 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:05,481 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:05,481 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:05,481 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:05,482 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:05,482 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:05,482 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:05,482 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:05,482 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:05,483 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:05,483 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:05,484 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:05,484 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:05,484 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:08,712 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-10-08
2025-10-29 00:51:08,713 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-15 00:00:00+00:00 to=2023-10-22 00:00:00+00:00
2025-10-29 00:51:08,801 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-15&to=2023-10-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:08,801 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:08,885 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:08,886 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:08,886 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:08,887 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:08,887 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:08,888 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:08,888 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:08,888 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:08,889 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:08,889 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:08,889 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:08,890 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:08,890 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:08,890 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:08,890 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:08,890 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:08,891 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:08,891 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:08,891 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:08,892 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:08,893 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:08,893 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:12,608 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-10-15
2025-10-29 00:51:12,609 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-22 00:00:00+00:00 to=2023-10-29 00:00:00+00:00
2025-10-29 00:51:12,685 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-22&to=2023-10-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:12,685 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:12,757 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:12,757 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:12,757 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:12,758 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:12,758 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:12,758 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:12,759 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:12,759 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:12,759 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:12,759 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:12,759 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:12,759 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:12,760 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:12,760 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:12,761 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:12,762 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:12,762 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:15,762 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-10-22
2025-10-29 00:51:15,762 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-10-29 00:00:00+00:00 to=2023-11-05 00:00:00+00:00
2025-10-29 00:51:15,837 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-10-29&to=2023-11-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:15,838 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:15,917 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:15,918 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:15,919 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:15,919 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:15,919 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:15,920 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:15,920 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:15,920 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:15,920 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
Dataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:35<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:33<00:30,  3.42s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [02:36<00:30,  3.42s/it][A
Fetching FUELHH from 2023-10-29 to 2023-11-05:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:38<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:36<00:26,  3.34s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [02:41<00:26,  3.34s/it][A
Fetching FUELHH from 2023-11-05 to 2023-11-12:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:43<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:41<00:26,  3.85s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [02:46<00:26,  3.85s/it][A
Fetching FUELHH from 2023-11-12 to 2023-11-19:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [A2025-10-29 00:51:15,920 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:15,921 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:15,921 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:15,921 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:15,921 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:15,921 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:15,921 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:15,922 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:15,922 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:15,922 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:15,923 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:15,923 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:15,923 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:18,933 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-10-29
2025-10-29 00:51:18,933 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-05 00:00:00+00:00 to=2023-11-12 00:00:00+00:00
2025-10-29 00:51:19,000 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-05&to=2023-11-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:19,001 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:19,069 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:19,070 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:19,070 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:19,071 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:19,071 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:19,071 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:19,071 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:19,071 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:19,072 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:19,072 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:19,072 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:19,072 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:19,072 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:19,072 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:19,073 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:19,073 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:19,073 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:19,073 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:19,073 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:19,074 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:19,075 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:19,075 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:23,960 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-11-05
2025-10-29 00:51:23,960 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-12 00:00:00+00:00 to=2023-11-19 00:00:00+00:00
2025-10-29 00:51:24,029 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-12&to=2023-11-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:24,031 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:24,109 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:24,110 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:24,110 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:24,111 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:24,111 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:24,111 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:24,112 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:24,112 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:24,112 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:24,113 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:24,113 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:24,113 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:24,113 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:24,113 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:24,114 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:24,114 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:24,114 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:24,114 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:24,114 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:24,116 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:24,116 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:24,116 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:28,244 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-11-12
2025-10-29 00:51:28,245 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-19 00:00:00+00:00 to=2023-11-26 00:00:00+00:00
2025-10-29 00:51:28,326 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-19&to=2023-11-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:28,326 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:28,420 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:28,420 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:28,421 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:28,422 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:28,422 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:28,423 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:28,423 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:28,423 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:28,424 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:28,424 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:28,425 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:28,425 - INFO -  -> Converted integer column 'generation' to nullable Int64.
Dataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:47<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:46<00:23,  3.98s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [02:49<00:23,  3.98s/it][A
Fetching FUELHH from 2023-11-19 to 2023-11-26:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:50<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:49<00:18,  3.74s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [02:52<00:18,  3.74s/it][A
Fetching FUELHH from 2023-11-26 to 2023-12-03:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:53<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:52<00:14,  3.54s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:57<?, ?it/s]
Fetching FUELHH from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [02:56<00:14,  3.54s/it][A
Fetching FUELHH from 2023-12-03 to 2023-12-10:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:57<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [A2025-10-29 00:51:28,425 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:28,426 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:28,426 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:28,426 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:28,426 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:28,426 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:28,427 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:28,429 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:28,429 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:28,429 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:31,423 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-11-19
2025-10-29 00:51:31,424 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-11-26 00:00:00+00:00 to=2023-12-03 00:00:00+00:00
2025-10-29 00:51:31,493 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-11-26&to=2023-12-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:31,494 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:31,576 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:31,577 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:31,577 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:31,578 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:31,578 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:31,578 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:31,579 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:31,579 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:31,579 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:31,579 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:31,580 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:31,580 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:31,580 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:31,580 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:31,581 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:31,581 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:31,581 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:31,581 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:31,581 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:31,582 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:31,583 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:31,583 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:34,502 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-11-26
2025-10-29 00:51:34,502 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-03 00:00:00+00:00 to=2023-12-10 00:00:00+00:00
2025-10-29 00:51:34,573 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-03&to=2023-12-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:34,574 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:34,656 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:34,657 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:34,657 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:34,658 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:34,658 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:34,658 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:34,658 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:34,659 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:34,659 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:34,659 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:34,659 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:34,660 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:34,661 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:34,662 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:34,663 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:34,663 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:34,663 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:38,696 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-12-03
2025-10-29 00:51:38,696 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-10 00:00:00+00:00 to=2023-12-17 00:00:00+00:00
2025-10-29 00:51:38,784 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-10&to=2023-12-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:38,785 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:38,860 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:38,861 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:38,861 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:38,862 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:38,862 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:38,862 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:38,862 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:38,862 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:38,863 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:38,863 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:38,863 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:38,863 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:38,864 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:38,864 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:38,864 - INFO -  -> Forced object column '_window_to_utc' to string.
Dataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [02:58<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:56<00:11,  3.74s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [02:59<00:11,  3.74s/it][A
Fetching FUELHH from 2023-12-10 to 2023-12-17:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:01<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [02:59<00:07,  3.60s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:04<?, ?it/s]
Fetching FUELHH from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [03:03<00:07,  3.60s/it][A
Fetching FUELHH from 2023-12-17 to 2023-12-24:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:04<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:04<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:04<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:05<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:03<00:03,  3.61s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                [ADataset: FUELHH:   0%|          | 0/2 [03:09<?, ?it/s]
Fetching FUELHH from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [03:08<00:03,  3.61s/it][A
Fetching FUELHH from 2023-12-24 to 2023-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 52/52.0 [03:08<00:00,  3.93s/it][A
                                                                                                [ADataset: FUELHH:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:09<03:09, 189.56s/it]Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:09<03:09, 189.56s/it]                                                                 Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:09<03:09, 189.56s/it]                                                                 Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]2025-10-29 00:51:38,864 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:38,865 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:38,865 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:38,865 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:38,866 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:38,866 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:38,866 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:41,961 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-12-10
2025-10-29 00:51:41,961 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-17 00:00:00+00:00 to=2023-12-24 00:00:00+00:00
2025-10-29 00:51:42,032 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-17&to=2023-12-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:42,032 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:42,109 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:42,110 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:42,110 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:42,111 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:42,111 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:42,111 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:42,111 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:42,112 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:42,112 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:42,112 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:42,112 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:42,113 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:42,113 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:42,113 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:42,113 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:42,113 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:42,114 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:42,114 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:42,114 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:42,115 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:42,115 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:42,115 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:45,595 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-12-17
2025-10-29 00:51:45,596 - INFO - üåê Fetching BMRS dataset=FUELHH from=2023-12-24 00:00:00+00:00 to=2023-12-31 00:00:00+00:00
2025-10-29 00:51:45,668 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2023-12-24&to=2023-12-31&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:45,669 - WARNING - Could not fetch FUELHH using Insights API logic: 'list' object has no attribute 'get'
2025-10-29 00:51:45,750 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-10-29 00:51:45,751 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:45,751 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-10-29 00:51:45,752 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:45,752 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-10-29 00:51:45,752 - INFO -  -> Forced object column 'dataset' to string.
2025-10-29 00:51:45,753 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-10-29 00:51:45,753 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:45,753 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-10-29 00:51:45,753 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:45,753 - INFO -  -> Forced object column 'fuelType' to string.
2025-10-29 00:51:45,754 - INFO -  -> Converted integer column 'generation' to nullable Int64.
2025-10-29 00:51:45,754 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:45,754 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:45,754 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:45,754 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:45,754 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:45,755 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:45,755 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:45,756 - INFO - Created hash keys for 20 rows using 7 content columns
2025-10-29 00:51:45,756 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:51:45,756 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:51:50,294 - INFO - ‚úÖ Successfully loaded 20 rows to inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh for window 2023-12-24
2025-10-29 00:51:50,295 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelinst between 2023-01-01 00:00:00+00:00 and 2023-12-31 00:00:00+00:00
2025-10-29 00:51:51,391 - INFO - Found 0 existing windows for bmrs_fuelinst

Windows for FUELINST:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:10<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                         [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-01 to 2023-01-08:   0%|          | 0/52.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2023-01-01 to 2023-01-08:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:11<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:00<00:36,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [A2025-10-29 00:51:51,392 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-01 00:00:00+00:00 to=2023-01-08 00:00:00+00:00
2025-10-29 00:51:51,518 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-01&to=2023-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:51,527 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:51:51,529 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:51,530 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:51,531 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:51,533 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:51,533 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:51,538 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:51,538 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:51,539 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:51,539 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:51,539 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:51,540 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:51,540 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:51,540 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:51,549 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:51:51,550 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:51,550 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:52,104 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-01 00:00:00+00:00-2023-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:52,114 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-08 00:00:00+00:00 to=2023-01-15 00:00:00+00:00
2025-10-29 00:51:52,228 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-08&to=2023-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:52,233 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:51:52,235 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:52,236 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:52,236 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:52,237 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:52,237 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:52,242 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:52,242 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:52,242 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:52,242 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:52,243 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:52,243 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:52,243 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:52,243 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:52,251 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:51:52,252 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:52,252 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-08 to 2023-01-15:   2%|‚ñè         | 1/52.0 [00:01<00:36,  1.38it/s][A
Fetching FUELINST from 2023-01-08 to 2023-01-15:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:01<00:34,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-15 to 2023-01-22:   4%|‚ñç         | 2/52.0 [00:02<00:34,  1.45it/s][A
Fetching FUELINST from 2023-01-15 to 2023-01-22:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [A2025-10-29 00:51:52,778 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-08 00:00:00+00:00-2023-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:52,781 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-15 00:00:00+00:00 to=2023-01-22 00:00:00+00:00
2025-10-29 00:51:52,902 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-15&to=2023-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:52,911 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:51:52,913 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:52,914 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:52,915 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:52,916 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:52,916 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:52,921 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:52,922 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:52,922 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:52,922 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:52,923 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:52,923 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:52,924 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:52,924 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:52,933 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:51:52,933 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:52,933 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:53,521 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-15 00:00:00+00:00-2023-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:53,524 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-22 00:00:00+00:00 to=2023-01-29 00:00:00+00:00
2025-10-29 00:51:53,656 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-22&to=2023-01-29&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:12<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-22 to 2023-01-29:   6%|‚ñå         | 3/52.0 [00:02<00:34,  1.40it/s][A
Fetching FUELINST from 2023-01-22 to 2023-01-29:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:02<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:34,  1.40it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:13<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:34,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [A2025-10-29 00:51:53,663 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:51:53,666 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:53,667 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:53,668 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:53,669 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:53,670 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:53,675 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:53,676 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:53,676 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:53,676 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:53,677 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:53,677 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:53,677 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:53,678 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:53,687 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:51:53,687 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:53,687 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:54,237 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-22 00:00:00+00:00-2023-01-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:54,241 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-01-29 00:00:00+00:00 to=2023-02-05 00:00:00+00:00
2025-10-29 00:51:54,365 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-01-29&to=2023-02-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:54,373 - INFO - Successfully fetched 330 records for FUELINST from Insights API.
2025-10-29 00:51:54,375 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:54,376 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:54,377 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:54,378 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:54,378 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:54,383 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:54,384 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:54,384 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:54,385 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:54,385 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:54,385 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:54,386 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:54,386 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:54,395 - INFO - Created hash keys for 330 rows using 3 content columns
2025-10-29 00:51:54,395 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:54,396 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-01-29 to 2023-02-05:   8%|‚ñä         | 4/52.0 [00:03<00:34,  1.40it/s][A
Fetching FUELINST from 2023-01-29 to 2023-02-05:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:03<00:33,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-05 to 2023-02-12:  10%|‚ñâ         | 5/52.0 [00:04<00:33,  1.42it/s][A
Fetching FUELINST from 2023-02-05 to 2023-02-12:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:14<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [A2025-10-29 00:51:54,924 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-01-29 00:00:00+00:00-2023-02-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:54,927 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-02-05 00:00:00+00:00 to=2023-02-12 00:00:00+00:00
2025-10-29 00:51:55,038 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-02-05&to=2023-02-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:55,042 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:51:55,044 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:55,045 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:55,045 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:55,046 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:55,046 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:55,050 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:55,051 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:55,051 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:55,051 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:55,052 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:55,052 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:55,052 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:55,052 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:55,059 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:51:55,060 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:55,060 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:55,567 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-02-05 00:00:00+00:00-2023-02-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:55,570 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-02-12 00:00:00+00:00 to=2023-02-19 00:00:00+00:00
2025-10-29 00:51:55,730 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-02-12&to=2023-02-19&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-12 to 2023-02-19:  12%|‚ñà‚ñè        | 6/52.0 [00:04<00:31,  1.46it/s][A
Fetching FUELINST from 2023-02-12 to 2023-02-19:  13%|‚ñà‚ñé        | 7/52.0 [00:04<00:31,  1.44it/s][A
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:04<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:04<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:15<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [A2025-10-29 00:51:55,739 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:51:55,743 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:55,744 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:55,745 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:55,746 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:55,746 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:55,752 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:55,753 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:55,753 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:55,753 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:55,754 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:55,754 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:55,754 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:55,755 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:55,764 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:51:55,764 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:55,765 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:56,283 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-02-12 00:00:00+00:00-2023-02-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:56,285 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-02-19 00:00:00+00:00 to=2023-02-26 00:00:00+00:00
2025-10-29 00:51:56,408 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-02-19&to=2023-02-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:56,411 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:51:56,412 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:56,413 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:56,413 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:56,414 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:56,414 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:56,416 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:56,416 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:56,416 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:56,416 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:56,417 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:56,417 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:56,417 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:56,417 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:56,421 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:51:56,421 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:56,421 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-19 to 2023-02-26:  13%|‚ñà‚ñé        | 7/52.0 [00:05<00:31,  1.44it/s][A
Fetching FUELINST from 2023-02-19 to 2023-02-26:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:05<00:29,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-02-26 to 2023-03-05:  15%|‚ñà‚ñå        | 8/52.0 [00:06<00:29,  1.47it/s][A
Fetching FUELINST from 2023-02-26 to 2023-03-05:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:16<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [A2025-10-29 00:51:56,937 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-02-19 00:00:00+00:00-2023-02-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:56,939 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-02-26 00:00:00+00:00 to=2023-03-05 00:00:00+00:00
2025-10-29 00:51:57,043 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-02-26&to=2023-03-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:57,049 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:51:57,050 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:57,051 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:57,051 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:57,052 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:57,052 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:57,057 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:57,057 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:57,057 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:57,057 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:57,058 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:57,058 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:57,059 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:57,059 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:57,066 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:51:57,066 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:57,066 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:57,630 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-02-26 00:00:00+00:00-2023-03-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:57,632 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-03-05 00:00:00+00:00 to=2023-03-12 00:00:00+00:00
2025-10-29 00:51:57,735 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-03-05&to=2023-03-12&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                 [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-05 to 2023-03-12:  17%|‚ñà‚ñã        | 9/52.0 [00:06<00:29,  1.46it/s][A
Fetching FUELINST from 2023-03-05 to 2023-03-12:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:17<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:06<00:27,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:51:57,739 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:51:57,741 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:57,742 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:57,742 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:57,743 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:57,744 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:57,748 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:57,748 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:57,749 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:57,749 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:57,749 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:57,750 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:57,752 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:57,752 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:57,759 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:51:57,760 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:57,760 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:58,253 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-03-05 00:00:00+00:00-2023-03-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:58,254 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-03-12 00:00:00+00:00 to=2023-03-19 00:00:00+00:00
2025-10-29 00:51:58,364 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-03-12&to=2023-03-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:58,367 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:51:58,368 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:58,369 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:58,369 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:58,370 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:58,370 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:58,373 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:58,373 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:58,373 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:58,373 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:58,373 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:58,374 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:58,374 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:58,374 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:58,379 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:51:58,379 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:58,379 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-12 to 2023-03-19:  19%|‚ñà‚ñâ        | 10/52.0 [00:07<00:27,  1.50it/s][A
Fetching FUELINST from 2023-03-12 to 2023-03-19:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:07<00:26,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-19 to 2023-03-26:  21%|‚ñà‚ñà        | 11/52.0 [00:08<00:26,  1.53it/s][A
Fetching FUELINST from 2023-03-19 to 2023-03-26:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:18<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [A2025-10-29 00:51:58,874 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-03-12 00:00:00+00:00-2023-03-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:58,877 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-03-19 00:00:00+00:00 to=2023-03-26 00:00:00+00:00
2025-10-29 00:51:58,995 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-03-19&to=2023-03-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:51:59,000 - INFO - Successfully fetched 331 records for FUELINST from Insights API.
2025-10-29 00:51:59,002 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:59,003 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:59,004 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:59,005 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:59,006 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:59,011 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:59,012 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:59,012 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:59,013 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:59,013 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:59,013 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:59,014 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:59,014 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:59,024 - INFO - Created hash keys for 331 rows using 3 content columns
2025-10-29 00:51:59,024 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:59,024 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:51:59,561 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-03-19 00:00:00+00:00-2023-03-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:51:59,563 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-03-26 00:00:00+00:00 to=2023-04-02 00:00:00+00:00
2025-10-29 00:51:59,793 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-03-26&to=2023-04-02&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:08<00:26,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-03-26 to 2023-04-02:  23%|‚ñà‚ñà‚ñé       | 12/52.0 [00:09<00:26,  1.51it/s][A
Fetching FUELINST from 2023-03-26 to 2023-04-02:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:19<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:51:59,801 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:51:59,805 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:51:59,806 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:59,806 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:51:59,807 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:51:59,807 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:51:59,812 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:51:59,812 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:51:59,812 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:51:59,812 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:51:59,813 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:51:59,813 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:51:59,813 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:51:59,813 - INFO - --- Final sanitization complete ---
2025-10-29 00:51:59,818 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:51:59,819 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:51:59,819 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:00,650 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-03-26 00:00:00+00:00-2023-04-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:00,652 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-04-02 00:00:00+00:00 to=2023-04-09 00:00:00+00:00
2025-10-29 00:52:00,766 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-04-02&to=2023-04-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:00,770 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:00,771 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:00,771 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:00,772 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:00,772 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:00,773 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:00,776 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:00,776 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:00,776 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:00,776 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:00,777 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:00,777 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:00,777 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:00,777 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:00,783 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:00,783 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:00,783 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-02 to 2023-04-09:  25%|‚ñà‚ñà‚ñå       | 13/52.0 [00:09<00:30,  1.26it/s][A
Fetching FUELINST from 2023-04-02 to 2023-04-09:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:09<00:28,  1.34it/s][A
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:09<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:09<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:20<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-09 to 2023-04-16:  27%|‚ñà‚ñà‚ñã       | 14/52.0 [00:10<00:28,  1.34it/s][A
Fetching FUELINST from 2023-04-09 to 2023-04-16:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:01,283 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-04-02 00:00:00+00:00-2023-04-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:01,289 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-04-09 00:00:00+00:00 to=2023-04-16 00:00:00+00:00
2025-10-29 00:52:01,410 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-04-09&to=2023-04-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:01,416 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:52:01,418 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:01,419 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:01,420 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:01,420 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:01,421 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:01,425 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:01,426 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:01,426 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:01,426 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:01,427 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:01,427 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:01,427 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:01,427 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:01,435 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:52:01,435 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:01,435 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:01,924 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-04-09 00:00:00+00:00-2023-04-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:01,927 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-04-16 00:00:00+00:00 to=2023-04-23 00:00:00+00:00
2025-10-29 00:52:02,084 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-04-16&to=2023-04-23&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:10<00:26,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-16 to 2023-04-23:  29%|‚ñà‚ñà‚ñâ       | 15/52.0 [00:11<00:26,  1.40it/s][A
Fetching FUELINST from 2023-04-16 to 2023-04-23:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:21<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:02,090 - INFO - Successfully fetched 331 records for FUELINST from Insights API.
2025-10-29 00:52:02,093 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:02,094 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:02,095 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:02,095 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:02,096 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:02,100 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:02,101 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:02,101 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:02,102 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:02,102 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:02,102 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:02,102 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:02,103 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:02,111 - INFO - Created hash keys for 331 rows using 3 content columns
2025-10-29 00:52:02,111 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:02,111 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:02,695 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-04-16 00:00:00+00:00-2023-04-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:02,697 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-04-23 00:00:00+00:00 to=2023-04-30 00:00:00+00:00
2025-10-29 00:52:02,795 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-04-23&to=2023-04-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:02,803 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:02,804 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:02,804 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:02,805 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:02,805 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:02,806 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:02,808 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:02,808 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:02,809 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:02,809 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:02,809 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:02,809 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:02,810 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:02,810 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:02,814 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:02,814 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:02,814 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-23 to 2023-04-30:  31%|‚ñà‚ñà‚ñà       | 16/52.0 [00:11<00:26,  1.37it/s][A
Fetching FUELINST from 2023-04-23 to 2023-04-30:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:11<00:24,  1.44it/s][A
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:11<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:11<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:22<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-04-30 to 2023-05-07:  33%|‚ñà‚ñà‚ñà‚ñé      | 17/52.0 [00:12<00:24,  1.44it/s][A
Fetching FUELINST from 2023-04-30 to 2023-05-07:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:03,314 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-04-23 00:00:00+00:00-2023-04-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:03,316 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-04-30 00:00:00+00:00 to=2023-05-07 00:00:00+00:00
2025-10-29 00:52:03,439 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-04-30&to=2023-05-07&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:03,445 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:03,447 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:03,448 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:03,448 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:03,449 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:03,449 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:03,454 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:03,454 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:03,454 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:03,455 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:03,455 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:03,455 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:03,456 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:03,456 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:03,464 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:03,465 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:03,465 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:04,024 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-04-30 00:00:00+00:00-2023-05-07 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:04,024 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-05-07 00:00:00+00:00 to=2023-05-14 00:00:00+00:00
2025-10-29 00:52:04,120 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-05-07&to=2023-05-14&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:12<00:23,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-07 to 2023-05-14:  35%|‚ñà‚ñà‚ñà‚ñç      | 18/52.0 [00:13<00:23,  1.43it/s][A
Fetching FUELINST from 2023-05-07 to 2023-05-14:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:23<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:04,127 - INFO - Successfully fetched 332 records for FUELINST from Insights API.
2025-10-29 00:52:04,128 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:04,129 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:04,129 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:04,129 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:04,130 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:04,133 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:04,133 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:04,134 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:04,134 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:04,134 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:04,134 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:04,134 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:04,134 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:04,144 - INFO - Created hash keys for 332 rows using 3 content columns
2025-10-29 00:52:04,144 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:04,145 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:04,625 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-05-07 00:00:00+00:00-2023-05-14 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:04,626 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-05-14 00:00:00+00:00 to=2023-05-21 00:00:00+00:00
2025-10-29 00:52:04,738 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-05-14&to=2023-05-21&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:04,743 - INFO - Successfully fetched 327 records for FUELINST from Insights API.
2025-10-29 00:52:04,744 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:04,745 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:04,745 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:04,746 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:04,746 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:04,750 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:04,751 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:04,751 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:04,751 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:04,752 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:04,752 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:04,752 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:04,752 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:04,761 - INFO - Created hash keys for 327 rows using 3 content columns
2025-10-29 00:52:04,761 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:04,761 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-14 to 2023-05-21:  37%|‚ñà‚ñà‚ñà‚ñã      | 19/52.0 [00:13<00:22,  1.49it/s][A
Fetching FUELINST from 2023-05-14 to 2023-05-21:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:13<00:22,  1.44it/s][A
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:13<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:13<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:24<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-21 to 2023-05-28:  38%|‚ñà‚ñà‚ñà‚ñä      | 20/52.0 [00:14<00:22,  1.44it/s][A
Fetching FUELINST from 2023-05-21 to 2023-05-28:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:05,377 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-05-14 00:00:00+00:00-2023-05-21 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:05,380 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-05-21 00:00:00+00:00 to=2023-05-28 00:00:00+00:00
2025-10-29 00:52:05,536 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-05-21&to=2023-05-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:05,542 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:05,543 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:05,544 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:05,545 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:05,545 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:05,546 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:05,550 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:05,551 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:05,551 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:05,552 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:05,552 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:05,553 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:05,553 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:05,553 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:05,564 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:05,565 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:05,565 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:06,079 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-05-21 00:00:00+00:00-2023-05-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:06,081 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-05-28 00:00:00+00:00 to=2023-06-04 00:00:00+00:00
2025-10-29 00:52:06,209 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-05-28&to=2023-06-04&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:14<00:21,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:25<03:09, 189.56s/it]
Fetching FUELINST from 2023-05-28 to 2023-06-04:  40%|‚ñà‚ñà‚ñà‚ñà      | 21/52.0 [00:15<00:21,  1.43it/s][A
Fetching FUELINST from 2023-05-28 to 2023-06-04:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:15<00:20,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:06,213 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:06,214 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:06,217 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:06,217 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:06,218 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:06,218 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:06,222 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:06,223 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:06,223 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:06,223 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:06,224 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:06,224 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:06,224 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:06,225 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:06,232 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:06,232 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:06,233 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:06,735 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-05-28 00:00:00+00:00-2023-06-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:06,739 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-06-04 00:00:00+00:00 to=2023-06-11 00:00:00+00:00
2025-10-29 00:52:06,876 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-06-04&to=2023-06-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:06,885 - INFO - Successfully fetched 332 records for FUELINST from Insights API.
2025-10-29 00:52:06,888 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:06,889 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:06,890 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:06,891 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:06,891 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:06,896 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:06,897 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:06,897 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:06,897 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:06,898 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:06,898 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:06,898 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:06,899 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:06,908 - INFO - Created hash keys for 332 rows using 3 content columns
2025-10-29 00:52:06,908 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:06,908 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-04 to 2023-06-11:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 22/52.0 [00:16<00:20,  1.46it/s][A
Fetching FUELINST from 2023-06-04 to 2023-06-11:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:26<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-11 to 2023-06-18:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 23/52.0 [00:16<00:20,  1.44it/s][A
Fetching FUELINST from 2023-06-11 to 2023-06-18:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:07,452 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-06-04 00:00:00+00:00-2023-06-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:07,456 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-06-11 00:00:00+00:00 to=2023-06-18 00:00:00+00:00
2025-10-29 00:52:07,609 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-06-11&to=2023-06-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:07,615 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:07,616 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:07,617 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:07,617 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:07,619 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:07,619 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:07,625 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:07,625 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:07,626 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:07,626 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:07,626 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:07,627 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:07,627 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:07,627 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:07,636 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:07,636 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:07,636 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:08,176 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-06-11 00:00:00+00:00-2023-06-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:08,179 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-06-18 00:00:00+00:00 to=2023-06-25 00:00:00+00:00
2025-10-29 00:52:08,327 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-06-18&to=2023-06-25&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:16<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:17<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:17<00:19,  1.42it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:27<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:17<00:19,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-18 to 2023-06-25:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 24/52.0 [00:17<00:19,  1.42it/s][A
Fetching FUELINST from 2023-06-18 to 2023-06-25:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:17<00:19,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:08,370 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:52:08,374 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:08,375 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:08,375 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:08,376 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:08,377 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:08,382 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:08,383 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:08,383 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:08,383 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:08,384 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:08,384 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:08,384 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:08,385 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:08,394 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:52:08,394 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:08,394 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:08,959 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-06-18 00:00:00+00:00-2023-06-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:08,961 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-06-25 00:00:00+00:00 to=2023-07-02 00:00:00+00:00
2025-10-29 00:52:09,093 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-06-25&to=2023-07-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:09,098 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:09,099 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:09,100 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:09,101 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:09,102 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:09,102 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:09,106 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:09,106 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:09,107 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:09,107 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:09,107 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:09,108 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:09,109 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:09,110 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:09,117 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:09,117 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:09,117 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-06-25 to 2023-07-02:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 25/52.0 [00:18<00:19,  1.38it/s][A
Fetching FUELINST from 2023-06-25 to 2023-07-02:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:28<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-02 to 2023-07-09:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 26/52.0 [00:18<00:18,  1.43it/s][A
Fetching FUELINST from 2023-07-02 to 2023-07-09:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:18<00:17,  1.46it/s][A
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:18<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:18<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:09,600 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-06-25 00:00:00+00:00-2023-07-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:09,602 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-07-02 00:00:00+00:00 to=2023-07-09 00:00:00+00:00
2025-10-29 00:52:09,744 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-07-02&to=2023-07-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:09,753 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:09,755 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:09,756 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:09,757 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:09,758 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:09,759 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:09,764 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:09,764 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:09,765 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:09,765 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:09,765 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:09,766 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:09,766 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:09,766 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:09,776 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:09,776 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:09,776 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:10,245 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-07-02 00:00:00+00:00-2023-07-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:10,246 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-07-09 00:00:00+00:00 to=2023-07-16 00:00:00+00:00
2025-10-29 00:52:10,407 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-07-09&to=2023-07-16&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:29<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-09 to 2023-07-16:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 27/52.0 [00:19<00:17,  1.46it/s][A
Fetching FUELINST from 2023-07-09 to 2023-07-16:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:19<00:16,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:10,411 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:10,413 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:10,414 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:10,414 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:10,415 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:10,415 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:10,419 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:10,420 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:10,420 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:10,420 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:10,421 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:10,421 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:10,421 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:10,421 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:10,429 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:10,429 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:10,429 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:10,922 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-07-09 00:00:00+00:00-2023-07-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:10,925 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-07-16 00:00:00+00:00 to=2023-07-23 00:00:00+00:00
2025-10-29 00:52:11,044 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-07-16&to=2023-07-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:11,049 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:52:11,050 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:11,051 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:11,051 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:11,052 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:11,052 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:11,056 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:11,056 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:11,057 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:11,057 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:11,057 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:11,057 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:11,058 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:11,058 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:11,064 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:52:11,064 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:11,064 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-16 to 2023-07-23:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 28/52.0 [00:20<00:16,  1.47it/s][A
Fetching FUELINST from 2023-07-16 to 2023-07-23:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:30<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-23 to 2023-07-30:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 29/52.0 [00:20<00:15,  1.52it/s][A
Fetching FUELINST from 2023-07-23 to 2023-07-30:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:11,531 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-07-16 00:00:00+00:00-2023-07-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:11,532 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-07-23 00:00:00+00:00 to=2023-07-30 00:00:00+00:00
2025-10-29 00:52:11,679 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-07-23&to=2023-07-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:11,682 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:11,684 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:11,684 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:11,685 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:11,685 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:11,685 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:11,688 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:11,689 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:11,689 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:11,689 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:11,689 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:11,689 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:11,690 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:11,690 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:11,695 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:11,695 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:11,695 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:12,248 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-07-23 00:00:00+00:00-2023-07-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:12,251 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-07-30 00:00:00+00:00 to=2023-08-06 00:00:00+00:00
2025-10-29 00:52:12,377 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-07-30&to=2023-08-06&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:20<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:31<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-07-30 to 2023-08-06:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 30/52.0 [00:21<00:14,  1.48it/s][A
Fetching FUELINST from 2023-07-30 to 2023-08-06:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:32<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:21<00:14,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:12,386 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:12,388 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:12,389 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:12,390 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:12,391 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:12,392 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:12,397 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:12,398 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:12,398 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:12,399 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:12,399 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:12,399 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:12,400 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:12,400 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:12,409 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:12,410 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:12,410 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:12,979 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-07-30 00:00:00+00:00-2023-08-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:12,982 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-08-06 00:00:00+00:00 to=2023-08-13 00:00:00+00:00
2025-10-29 00:52:13,115 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-08-06&to=2023-08-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:13,158 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:13,161 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:13,162 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:13,162 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:13,163 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:13,164 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:13,169 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:13,170 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:13,170 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:13,171 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:13,171 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:13,172 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:13,172 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:13,172 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:13,182 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:13,183 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:13,183 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-06 to 2023-08-13:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 31/52.0 [00:22<00:14,  1.44it/s][A
Fetching FUELINST from 2023-08-06 to 2023-08-13:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:22<00:14,  1.37it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-13 to 2023-08-20:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 32/52.0 [00:23<00:14,  1.37it/s][A
Fetching FUELINST from 2023-08-13 to 2023-08-20:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:33<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:13,795 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-08-06 00:00:00+00:00-2023-08-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:13,798 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-08-13 00:00:00+00:00 to=2023-08-20 00:00:00+00:00
2025-10-29 00:52:13,922 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-08-13&to=2023-08-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:13,930 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:13,932 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:13,934 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:13,934 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:13,935 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:13,936 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:13,941 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:13,941 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:13,942 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:13,942 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:13,943 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:13,943 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:13,943 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:13,944 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:13,953 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:13,953 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:13,953 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:14,583 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-08-13 00:00:00+00:00-2023-08-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:14,586 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-08-20 00:00:00+00:00 to=2023-08-27 00:00:00+00:00
2025-10-29 00:52:14,761 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-08-20&to=2023-08-27&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-20 to 2023-08-27:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 33/52.0 [00:23<00:14,  1.34it/s][A
Fetching FUELINST from 2023-08-20 to 2023-08-27:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:23<00:13,  1.31it/s][A
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:23<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:23<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:34<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:14,772 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:14,775 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:14,776 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:14,777 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:14,778 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:14,778 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:14,784 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:14,784 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:14,785 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:14,785 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:14,785 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:14,786 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:14,786 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:14,786 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:14,796 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:14,796 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:14,796 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:15,388 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-08-20 00:00:00+00:00-2023-08-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:15,391 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-08-27 00:00:00+00:00 to=2023-09-03 00:00:00+00:00
2025-10-29 00:52:15,511 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-08-27&to=2023-09-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:15,516 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:15,517 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:15,518 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:15,518 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:15,519 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:15,519 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:15,522 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:15,523 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:15,523 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:15,523 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:15,523 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:15,524 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:15,524 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:15,524 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:15,530 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:15,530 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:15,530 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-08-27 to 2023-09-03:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 34/52.0 [00:24<00:13,  1.31it/s][A
Fetching FUELINST from 2023-08-27 to 2023-09-03:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:24<00:12,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-03 to 2023-09-10:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 35/52.0 [00:25<00:12,  1.41it/s][A
Fetching FUELINST from 2023-09-03 to 2023-09-10:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:35<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:15,965 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-08-27 00:00:00+00:00-2023-09-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:15,969 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-09-03 00:00:00+00:00 to=2023-09-10 00:00:00+00:00
2025-10-29 00:52:16,088 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-09-03&to=2023-09-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:16,094 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:16,096 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:16,098 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:16,098 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:16,099 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:16,100 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:16,106 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:16,106 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:16,107 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:16,107 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:16,108 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:16,108 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:16,108 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:16,108 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:16,118 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:16,118 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:16,118 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:16,597 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-09-03 00:00:00+00:00-2023-09-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:16,600 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-09-10 00:00:00+00:00 to=2023-09-17 00:00:00+00:00
2025-10-29 00:52:17,045 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-09-10&to=2023-09-17&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:25<00:10,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-10 to 2023-09-17:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 36/52.0 [00:26<00:10,  1.46it/s][A
Fetching FUELINST from 2023-09-10 to 2023-09-17:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:36<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:26<00:11,  1.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:17,055 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:17,057 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:17,059 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:17,059 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:17,060 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:17,061 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:17,066 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:17,066 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:17,067 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:17,067 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:17,067 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:17,068 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:17,068 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:17,069 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:17,078 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:17,079 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:17,079 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:17,600 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-09-10 00:00:00+00:00-2023-09-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:17,601 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-09-17 00:00:00+00:00 to=2023-09-24 00:00:00+00:00
2025-10-29 00:52:17,738 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-09-17&to=2023-09-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:17,742 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:17,743 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:17,743 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:17,744 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:17,744 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:17,744 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:17,747 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:17,748 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:17,748 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:17,748 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:17,748 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:17,748 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:17,749 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:17,749 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:17,754 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:17,754 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:17,755 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-17 to 2023-09-24:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 37/52.0 [00:27<00:11,  1.28it/s][A
Fetching FUELINST from 2023-09-17 to 2023-09-24:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:37<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-09-24 to 2023-10-01:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 38/52.0 [00:27<00:11,  1.27it/s][A
Fetching FUELINST from 2023-09-24 to 2023-10-01:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:18,406 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-09-17 00:00:00+00:00-2023-09-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:18,410 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-09-24 00:00:00+00:00 to=2023-10-01 00:00:00+00:00
2025-10-29 00:52:18,543 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-09-24&to=2023-10-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:18,551 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:18,554 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:18,556 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:18,557 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:18,558 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:18,559 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:18,564 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:18,565 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:18,565 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:18,566 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:18,566 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:18,567 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:18,567 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:18,567 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:18,577 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:18,578 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:18,578 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:19,133 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-09-24 00:00:00+00:00-2023-10-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:19,136 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-10-01 00:00:00+00:00 to=2023-10-08 00:00:00+00:00
2025-10-29 00:52:19,255 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-10-01&to=2023-10-08&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:38<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:27<00:10,  1.30it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-01 to 2023-10-08:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 39/52.0 [00:28<00:10,  1.30it/s][A
Fetching FUELINST from 2023-10-01 to 2023-10-08:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:28<00:08,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:19,260 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:19,262 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:19,263 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:19,263 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:19,264 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:19,265 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:19,270 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:19,270 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:19,271 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:19,271 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:19,271 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:19,271 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:19,272 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:19,272 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:19,280 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:19,280 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:19,280 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:19,751 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-10-01 00:00:00+00:00-2023-10-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:19,755 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-10-08 00:00:00+00:00 to=2023-10-15 00:00:00+00:00
2025-10-29 00:52:19,899 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-10-08&to=2023-10-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:19,904 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:19,906 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:19,907 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:19,907 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:19,908 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:19,908 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:19,912 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:19,912 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:19,912 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:19,912 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:19,913 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:19,913 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:19,913 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:19,913 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:19,920 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:19,920 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:19,920 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-08 to 2023-10-15:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 40/52.0 [00:29<00:08,  1.38it/s][A
Fetching FUELINST from 2023-10-08 to 2023-10-15:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:39<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-15 to 2023-10-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 41/52.0 [00:29<00:07,  1.40it/s][A
Fetching FUELINST from 2023-10-15 to 2023-10-22:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:20,432 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-10-08 00:00:00+00:00-2023-10-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:20,437 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-10-15 00:00:00+00:00 to=2023-10-22 00:00:00+00:00
2025-10-29 00:52:20,606 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-10-15&to=2023-10-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:20,611 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:20,613 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:20,614 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:20,614 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:20,615 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:20,615 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:20,620 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:20,620 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:20,621 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:20,621 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:20,621 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:20,622 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:20,622 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:20,622 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:20,630 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:20,630 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:20,630 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:21,150 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-10-15 00:00:00+00:00-2023-10-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:21,151 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-10-22 00:00:00+00:00 to=2023-10-29 00:00:00+00:00
2025-10-29 00:52:21,254 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-10-22&to=2023-10-29&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:40<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:29<00:07,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-22 to 2023-10-29:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 42/52.0 [00:30<00:07,  1.40it/s][A
Fetching FUELINST from 2023-10-22 to 2023-10-29:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:30<00:06,  1.39it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:21,257 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:21,258 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:21,259 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:21,259 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:21,260 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:21,260 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:21,263 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:21,263 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:21,263 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:21,263 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:21,263 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:21,264 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:21,264 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:21,264 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:21,269 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:21,270 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:21,270 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:21,888 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-10-22 00:00:00+00:00-2023-10-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:21,891 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-10-29 00:00:00+00:00 to=2023-11-05 00:00:00+00:00
2025-10-29 00:52:22,014 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-10-29&to=2023-11-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:22,020 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:22,022 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:22,023 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:22,023 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:22,024 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:22,025 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:22,031 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:22,031 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:22,032 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:22,032 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:22,032 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:22,033 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:22,033 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:22,034 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:22,043 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:22,043 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:22,043 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-10-29 to 2023-11-05:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 43/52.0 [00:31<00:06,  1.39it/s][A
Fetching FUELINST from 2023-10-29 to 2023-11-05:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:41<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-05 to 2023-11-12:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 44/52.0 [00:31<00:05,  1.36it/s][A
Fetching FUELINST from 2023-11-05 to 2023-11-12:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:31<00:04,  1.41it/s][A
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:31<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:31<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:22,654 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-10-29 00:00:00+00:00-2023-11-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:22,656 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-11-05 00:00:00+00:00 to=2023-11-12 00:00:00+00:00
2025-10-29 00:52:22,767 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-11-05&to=2023-11-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:22,827 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:22,828 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:22,828 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:22,829 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:22,829 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:22,829 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:22,831 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:22,832 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:22,832 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:22,832 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:22,832 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:22,832 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:22,833 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:22,833 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:22,837 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:22,837 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:22,837 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:23,312 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-11-05 00:00:00+00:00-2023-11-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:23,314 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-11-12 00:00:00+00:00 to=2023-11-19 00:00:00+00:00
2025-10-29 00:52:23,428 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-11-12&to=2023-11-19&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:42<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-12 to 2023-11-19:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 45/52.0 [00:32<00:04,  1.41it/s][A
Fetching FUELINST from 2023-11-12 to 2023-11-19:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:32<00:04,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:23,433 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:23,435 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:23,436 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:23,436 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:23,437 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:23,437 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:23,442 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:23,442 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:23,442 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:23,443 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:23,443 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:23,443 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:23,444 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:23,444 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:23,451 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:23,452 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:23,452 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:23,945 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-11-12 00:00:00+00:00-2023-11-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:23,947 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-11-19 00:00:00+00:00 to=2023-11-26 00:00:00+00:00
2025-10-29 00:52:24,067 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-11-19&to=2023-11-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:24,073 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:24,074 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:24,075 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:24,075 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:24,076 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:24,076 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:24,079 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:24,080 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:24,080 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:24,080 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:24,080 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:24,081 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:24,081 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:24,081 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:24,087 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:24,087 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:24,088 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-19 to 2023-11-26:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 46/52.0 [00:33<00:04,  1.45it/s][A
Fetching FUELINST from 2023-11-19 to 2023-11-26:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:43<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-11-26 to 2023-12-03:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 47/52.0 [00:33<00:03,  1.48it/s][A
Fetching FUELINST from 2023-11-26 to 2023-12-03:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:33<00:02,  1.47it/s][A
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:33<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:33<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:24,592 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-11-19 00:00:00+00:00-2023-11-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:24,594 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-11-26 00:00:00+00:00 to=2023-12-03 00:00:00+00:00
2025-10-29 00:52:24,713 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-11-26&to=2023-12-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:24,717 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:24,718 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:24,719 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:24,720 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:24,720 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:24,721 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:24,725 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:24,725 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:24,725 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:24,725 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:24,726 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:24,726 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:24,726 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:24,726 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:24,733 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:24,734 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:24,734 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:25,279 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-11-26 00:00:00+00:00-2023-12-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:25,281 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-12-03 00:00:00+00:00 to=2023-12-10 00:00:00+00:00
2025-10-29 00:52:25,457 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-12-03&to=2023-12-10&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:44<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-03 to 2023-12-10:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 48/52.0 [00:34<00:02,  1.47it/s][A
Fetching FUELINST from 2023-12-03 to 2023-12-10:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:34<00:02,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [A2025-10-29 00:52:25,465 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:25,467 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:25,468 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:25,469 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:25,469 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:25,470 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:25,475 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:25,475 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:25,476 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:25,476 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:25,476 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:25,477 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:25,477 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:25,477 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:25,486 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:25,486 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:25,487 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:26,008 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-12-03 00:00:00+00:00-2023-12-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:26,010 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-12-10 00:00:00+00:00 to=2023-12-17 00:00:00+00:00
2025-10-29 00:52:26,146 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-12-10&to=2023-12-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:26,153 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:52:26,155 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:26,157 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:26,157 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:26,159 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:26,159 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:26,165 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:26,165 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:26,166 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:26,166 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:26,166 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:26,167 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:26,167 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:26,167 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:26,177 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:52:26,177 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:26,178 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-10 to 2023-12-17:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 49/52.0 [00:35<00:02,  1.44it/s][A
Fetching FUELINST from 2023-12-10 to 2023-12-17:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:45<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-17 to 2023-12-24:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 50/52.0 [00:35<00:01,  1.43it/s][A
Fetching FUELINST from 2023-12-17 to 2023-12-24:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:35<00:00,  1.46it/s][A
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:35<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:35<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [A2025-10-29 00:52:26,714 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-12-10 00:00:00+00:00-2023-12-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:26,718 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-12-17 00:00:00+00:00 to=2023-12-24 00:00:00+00:00
2025-10-29 00:52:26,855 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-12-17&to=2023-12-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:52:26,863 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:52:26,865 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:26,866 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:26,866 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:26,867 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:26,868 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:26,873 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:26,873 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:26,874 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:26,874 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:26,874 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:26,875 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:26,875 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:26,875 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:26,884 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:52:26,884 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:26,884 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:27,370 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-12-17 00:00:00+00:00-2023-12-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:27,374 - INFO - üåê Fetching BMRS dataset=FUELINST from=2023-12-24 00:00:00+00:00 to=2023-12-31 00:00:00+00:00
2025-10-29 00:52:27,518 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2023-12-24&to=2023-12-31&format=json "HTTP/1.1 200 OK"
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:46<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                 
                                                                                                  [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [03:47<03:09, 189.56s/it]
Fetching FUELINST from 2023-12-24 to 2023-12-31:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 51/52.0 [00:36<00:00,  1.46it/s][A
Fetching FUELINST from 2023-12-24 to 2023-12-31: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 52/52.0 [00:36<00:00,  1.44it/s][A
                                                                                                  [ADataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [03:47<00:00, 100.29s/it]Dataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [03:47<00:00, 113.68s/it]
2025-10-29 00:52:27,524 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:52:27,526 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:52:27,527 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:27,527 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:52:27,528 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:52:27,529 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:52:27,534 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:52:27,534 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:52:27,535 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:52:27,535 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:52:27,536 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:52:27,536 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:52:27,537 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:52:27,537 - INFO - --- Final sanitization complete ---
2025-10-29 00:52:27,546 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:52:27,546 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:52:27,546 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:52:28,088 - ERROR - ‚ùå Failed to load data for FUELINST in window 2023-12-24 00:00:00+00:00-2023-12-31 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1895, in main
    logging.warning(
           ^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:52:28,092 - INFO - ‚úÖ Ingestion run completed.
