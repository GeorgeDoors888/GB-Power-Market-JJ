2025-10-29 00:53:46,953 - INFO - BigQuery dataset 'uk_energy_prod' exists.
All Datasets:   0%|          | 0/2 [00:00<?, ?it/s]Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:00<?, ?it/s]                                                      Dataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]2025-10-29 00:53:46,979 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelhh between 2025-01-01 00:00:00+00:00 and 2025-10-28 00:00:00+00:00
2025-10-29 00:53:48,010 - INFO - Found 0 existing windows for bmrs_fuelhh

Windows for FUELHH:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                     [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A
Fetching FUELHH from 2025-01-01 to 2025-01-08:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:01<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:34,  1.21it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:53:48,011 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-01-01 00:00:00+00:00 to=2025-01-08 00:00:00+00:00
2025-10-29 00:53:48,141 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-01-01&to=2025-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:48,143 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:48,145 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:48,145 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:48,145 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:48,146 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:48,146 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:48,146 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:48,147 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:48,147 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:48,147 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:48,147 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:48,148 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:48,148 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:48,148 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:48,148 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:48,150 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:48,150 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:48,150 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:48,826 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-01-01 00:00:00+00:00-2025-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:48,835 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-01-08 00:00:00+00:00 to=2025-01-15 00:00:00+00:00
2025-10-29 00:53:48,949 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-01-08&to=2025-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:48,950 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:48,952 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:48,952 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:48,953 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:48,954 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:48,954 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:48,955 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:48,955 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:48,956 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:48,956 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:48,957 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:48,957 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:48,957 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:48,958 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:48,958 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:48,960 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:48,960 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:48,960 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:34,  1.21it/s][A
Fetching FUELHH from 2025-01-08 to 2025-01-15:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:02<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:29,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:02<00:29,  1.38it/s][A
Fetching FUELHH from 2025-01-15 to 2025-01-22:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [A2025-10-29 00:53:49,489 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-01-08 00:00:00+00:00-2025-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:49,492 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-01-15 00:00:00+00:00 to=2025-01-22 00:00:00+00:00
2025-10-29 00:53:49,583 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-01-15&to=2025-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:49,584 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:49,585 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:49,586 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:49,586 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:49,587 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:49,587 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:49,587 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:49,588 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:49,588 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:49,588 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:49,589 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:49,589 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:49,589 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:49,590 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:49,590 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:49,591 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:49,591 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:49,592 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:50,157 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-01-15 00:00:00+00:00-2025-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:27,  1.43it/s][A
Fetching FUELHH from 2025-01-22 to 2025-01-29:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:03<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:02<00:27,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:53:50,162 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-01-22 00:00:00+00:00 to=2025-01-29 00:00:00+00:00
2025-10-29 00:53:50,265 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-01-22&to=2025-01-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:50,266 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:50,267 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:50,268 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:50,268 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:50,269 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:50,269 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:50,270 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:50,270 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:50,271 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:50,271 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:50,271 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:50,272 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:50,272 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:50,272 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:50,273 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:50,274 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:50,275 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:50,275 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:50,873 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-01-22 00:00:00+00:00-2025-01-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:50,875 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-01-29 00:00:00+00:00 to=2025-02-05 00:00:00+00:00
2025-10-29 00:53:50,987 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-01-29&to=2025-02-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:50,988 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:50,990 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:50,991 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:50,991 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:50,992 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:50,992 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:50,993 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:50,993 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:50,994 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:50,994 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:50,994 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:50,995 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:50,995 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:50,996 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:50,996 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:50,998 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:50,998 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:50,998 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:27,  1.42it/s][A
Fetching FUELHH from 2025-01-29 to 2025-02-05:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:04<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:03<00:28,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:28,  1.34it/s][A
Fetching FUELHH from 2025-02-05 to 2025-02-12:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [A2025-10-29 00:53:51,694 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-01-29 00:00:00+00:00-2025-02-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:51,697 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-02-05 00:00:00+00:00 to=2025-02-12 00:00:00+00:00
2025-10-29 00:53:51,818 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-02-05&to=2025-02-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:51,819 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:51,819 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:51,820 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:51,820 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:51,820 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:51,821 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:51,821 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:51,821 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:51,821 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:51,821 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:51,822 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:51,822 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:51,822 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:51,822 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:51,822 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:51,823 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:51,823 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:51,824 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:52,379 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-02-05 00:00:00+00:00-2025-02-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:26,  1.38it/s][A
Fetching FUELHH from 2025-02-12 to 2025-02-19:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:04<00:24,  1.47it/s][A
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:04<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:05<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:04<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [A2025-10-29 00:53:52,382 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-02-12 00:00:00+00:00 to=2025-02-19 00:00:00+00:00
2025-10-29 00:53:52,470 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-02-12&to=2025-02-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:52,471 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:52,472 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:52,472 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:52,473 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:52,473 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:52,473 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:52,474 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:52,474 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:52,474 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:52,475 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:52,475 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:52,475 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:52,476 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:52,476 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:52,476 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:52,478 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:52,478 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:52,478 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:52,960 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-02-12 00:00:00+00:00-2025-02-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:52,964 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-02-19 00:00:00+00:00 to=2025-02-26 00:00:00+00:00
2025-10-29 00:53:53,057 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-02-19&to=2025-02-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:53,058 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:53,059 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:53,060 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:53,060 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:53,061 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:53,061 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:53,062 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:53,062 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:53,063 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:53,063 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:53,063 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:53,064 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:53,064 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:53,064 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:53,065 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:53,066 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:53,066 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:53,067 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:24,  1.47it/s][A
Fetching FUELHH from 2025-02-19 to 2025-02-26:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:06<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:05<00:24,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:24,  1.41it/s][A
Fetching FUELHH from 2025-02-26 to 2025-03-05:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [A2025-10-29 00:53:53,740 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-02-19 00:00:00+00:00-2025-02-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:53,744 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-02-26 00:00:00+00:00 to=2025-03-05 00:00:00+00:00
2025-10-29 00:53:53,834 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-02-26&to=2025-03-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:53,841 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:53,843 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:53,843 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:53,844 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:53,844 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:53,844 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:53,845 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:53,845 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:53,845 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:53,846 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:53,846 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:53,846 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:53,847 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:53,847 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:53,847 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:53,849 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:53,849 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:53,849 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:54,456 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-02-26 00:00:00+00:00-2025-03-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:07<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:06<00:24,  1.40it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                             [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:24,  1.40it/s][A
Fetching FUELHH from 2025-03-05 to 2025-03-12:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:54,460 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-03-05 00:00:00+00:00 to=2025-03-12 00:00:00+00:00
2025-10-29 00:53:54,549 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-03-05&to=2025-03-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:54,550 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:54,552 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:54,552 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:54,553 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:54,553 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:54,554 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:54,554 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:54,555 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:54,555 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:54,555 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:54,556 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:54,556 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:54,556 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:54,557 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:54,557 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:54,558 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:54,559 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:54,559 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:55,040 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-03-05 00:00:00+00:00-2025-03-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:55,042 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-03-12 00:00:00+00:00 to=2025-03-19 00:00:00+00:00
2025-10-29 00:53:55,145 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-03-12&to=2025-03-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:55,146 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:55,147 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:55,147 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:55,148 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:55,148 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:55,149 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:55,149 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:55,149 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:55,150 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:55,150 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:55,150 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:55,151 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:55,151 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:55,151 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:55,152 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:55,153 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:55,153 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:55,153 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:22,  1.49it/s][A
Fetching FUELHH from 2025-03-12 to 2025-03-19:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:08<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:07<00:21,  1.50it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:21,  1.50it/s][A
Fetching FUELHH from 2025-03-19 to 2025-03-26:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [A2025-10-29 00:53:55,686 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-03-12 00:00:00+00:00-2025-03-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:55,690 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-03-19 00:00:00+00:00 to=2025-03-26 00:00:00+00:00
2025-10-29 00:53:55,806 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-03-19&to=2025-03-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:55,807 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:55,809 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:55,809 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:55,810 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:55,810 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:55,811 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:55,812 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:55,812 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:55,813 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:55,813 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:55,813 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:55,814 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:55,814 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:55,815 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:55,815 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:55,817 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:55,817 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:55,817 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:56,299 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-03-19 00:00:00+00:00-2025-03-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:09<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:08<00:20,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:20,  1.54it/s][A
Fetching FUELHH from 2025-03-26 to 2025-04-02:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:56,302 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-03-26 00:00:00+00:00 to=2025-04-02 00:00:00+00:00
2025-10-29 00:53:56,386 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-03-26&to=2025-04-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:56,387 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:56,390 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:56,391 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:56,391 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:56,392 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:56,396 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:56,400 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:56,422 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:56,426 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:56,427 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:56,427 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:56,427 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:56,427 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:56,437 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:56,437 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:56,440 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:56,440 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:56,440 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:57,016 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-03-26 00:00:00+00:00-2025-04-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:57,018 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-04-02 00:00:00+00:00 to=2025-04-09 00:00:00+00:00
2025-10-29 00:53:57,109 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-04-02&to=2025-04-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:57,111 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:57,112 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:57,112 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:57,113 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:57,113 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:57,114 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:57,114 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:57,115 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:57,115 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:57,115 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:57,116 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:57,116 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:57,116 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:57,117 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:57,117 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:57,118 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:57,119 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:57,119 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:09<00:19,  1.49it/s][A
Fetching FUELHH from 2025-04-02 to 2025-04-09:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:09<00:21,  1.35it/s][A
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:09<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:10<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:09<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:10<00:21,  1.35it/s][A
Fetching FUELHH from 2025-04-09 to 2025-04-16:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [A2025-10-29 00:53:57,925 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-04-02 00:00:00+00:00-2025-04-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:57,927 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-04-09 00:00:00+00:00 to=2025-04-16 00:00:00+00:00
2025-10-29 00:53:58,019 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-04-09&to=2025-04-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:58,021 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:58,022 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:58,022 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:58,023 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:58,023 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:58,024 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:58,024 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:58,024 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:58,025 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:58,025 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:58,025 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:58,026 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:58,026 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:58,026 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:58,026 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:58,028 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:58,028 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:58,028 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:58,759 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-04-09 00:00:00+00:00-2025-04-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:11<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:10<00:21,  1.30it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:11<00:21,  1.30it/s][A
Fetching FUELHH from 2025-04-16 to 2025-04-23:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:12<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:11<00:19,  1.35it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:53:58,763 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-04-16 00:00:00+00:00 to=2025-04-23 00:00:00+00:00
2025-10-29 00:53:58,861 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-04-16&to=2025-04-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:58,862 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:58,863 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:58,864 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:58,864 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:58,865 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:58,865 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:58,866 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:58,866 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:58,867 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:58,867 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:58,868 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:58,868 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:58,868 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:58,869 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:58,869 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:58,871 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:58,871 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:58,871 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:53:59,425 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-04-16 00:00:00+00:00-2025-04-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:53:59,429 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-04-23 00:00:00+00:00 to=2025-04-30 00:00:00+00:00
2025-10-29 00:53:59,520 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-04-23&to=2025-04-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:53:59,521 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:53:59,522 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:59,522 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:53:59,523 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:53:59,523 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:53:59,523 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:53:59,524 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:53:59,524 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:53:59,525 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:53:59,525 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:53:59,525 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:53:59,526 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:53:59,526 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:53:59,526 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:53:59,527 - INFO - --- Final sanitization complete ---
2025-10-29 00:53:59,528 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:53:59,528 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:53:59,528 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:19,  1.35it/s][A
Fetching FUELHH from 2025-04-23 to 2025-04-30:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:12<00:18,  1.42it/s][A
Fetching FUELHH from 2025-04-30 to 2025-05-07:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:00,045 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-04-23 00:00:00+00:00-2025-04-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:00,047 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-04-30 00:00:00+00:00 to=2025-05-07 00:00:00+00:00
2025-10-29 00:54:00,136 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-04-30&to=2025-05-07&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:00,144 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:00,145 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:00,146 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:00,146 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:00,146 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:00,147 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:00,147 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:00,148 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:00,148 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:00,148 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:00,149 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:00,149 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:00,149 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:00,150 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:00,150 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:00,151 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:00,151 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:00,152 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:00,671 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-04-30 00:00:00+00:00-2025-05-07 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:13<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:12<00:16,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:13<00:16,  1.47it/s][A
Fetching FUELHH from 2025-05-07 to 2025-05-14:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:14<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:13<00:15,  1.49it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:00,673 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-05-07 00:00:00+00:00 to=2025-05-14 00:00:00+00:00
2025-10-29 00:54:00,775 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-05-07&to=2025-05-14&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:00,777 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:00,778 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:00,779 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:00,779 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:00,780 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:00,780 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:00,780 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:00,781 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:00,781 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:00,782 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:00,782 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:00,782 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:00,783 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:00,783 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:00,783 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:00,785 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:00,785 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:00,785 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:01,318 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-05-07 00:00:00+00:00-2025-05-14 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:01,322 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-05-14 00:00:00+00:00 to=2025-05-21 00:00:00+00:00
2025-10-29 00:54:01,422 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-05-14&to=2025-05-21&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:01,423 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:01,424 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:01,425 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:01,425 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:01,426 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:01,426 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:01,427 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:01,427 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:01,427 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:01,427 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:01,428 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:01,428 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:01,428 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:01,429 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:01,429 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:01,431 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:01,431 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:01,431 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:14<00:15,  1.49it/s][A
Fetching FUELHH from 2025-05-14 to 2025-05-21:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:14<00:15,  1.46it/s][A
Fetching FUELHH from 2025-05-21 to 2025-05-28:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:02,034 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-05-14 00:00:00+00:00-2025-05-21 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:02,036 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-05-21 00:00:00+00:00 to=2025-05-28 00:00:00+00:00
2025-10-29 00:54:02,127 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-05-21&to=2025-05-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:02,128 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:02,130 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:02,130 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:02,131 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:02,131 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:02,132 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:02,132 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:02,132 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:02,133 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:02,133 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:02,134 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:02,134 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:02,134 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:02,135 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:02,135 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:02,137 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:02,137 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:02,137 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:02,753 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-05-21 00:00:00+00:00-2025-05-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:15<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:14<00:15,  1.44it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:15<00:15,  1.44it/s][A
Fetching FUELHH from 2025-05-28 to 2025-06-04:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:16<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:15<00:14,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:02,757 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-05-28 00:00:00+00:00 to=2025-06-04 00:00:00+00:00
2025-10-29 00:54:02,872 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-05-28&to=2025-06-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:02,874 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:02,875 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:02,876 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:02,877 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:02,877 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:02,878 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:02,878 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:02,879 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:02,879 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:02,880 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:02,880 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:02,881 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:02,881 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:02,882 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:02,882 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:02,884 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:02,884 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:02,884 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:03,432 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-05-28 00:00:00+00:00-2025-06-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:03,435 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-06-04 00:00:00+00:00 to=2025-06-11 00:00:00+00:00
2025-10-29 00:54:03,543 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-06-04&to=2025-06-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:03,544 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:03,545 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:03,546 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:03,546 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:03,547 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:03,547 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:03,548 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:03,548 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:03,548 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:03,549 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:03,549 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:03,549 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:03,550 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:03,550 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:03,550 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:03,552 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:03,552 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:03,552 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:16<00:14,  1.45it/s][A
Fetching FUELHH from 2025-06-04 to 2025-06-11:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:16<00:14,  1.41it/s][A
Fetching FUELHH from 2025-06-11 to 2025-06-18:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:04,183 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-06-04 00:00:00+00:00-2025-06-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:04,187 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-06-11 00:00:00+00:00 to=2025-06-18 00:00:00+00:00
2025-10-29 00:54:04,278 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-06-11&to=2025-06-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:04,280 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:04,281 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:04,281 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:04,282 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:04,282 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:04,283 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:04,283 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:04,284 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:04,284 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:04,285 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:04,285 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:04,285 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:04,286 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:04,286 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:04,286 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:04,288 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:04,288 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:04,288 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:04,901 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-06-11 00:00:00+00:00-2025-06-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:17<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:16<00:13,  1.41it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:17<00:13,  1.41it/s][A
Fetching FUELHH from 2025-06-18 to 2025-06-25:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:18<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:17<00:12,  1.42it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:04,904 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-06-18 00:00:00+00:00 to=2025-06-25 00:00:00+00:00
2025-10-29 00:54:04,992 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-06-18&to=2025-06-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:04,993 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:04,995 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:04,995 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:04,996 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:04,996 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:04,997 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:04,997 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:04,997 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:04,998 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:04,998 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:04,998 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:04,999 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:04,999 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:05,000 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:05,000 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:05,002 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:05,002 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:05,002 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:05,582 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-06-18 00:00:00+00:00-2025-06-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:05,585 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-06-25 00:00:00+00:00 to=2025-07-02 00:00:00+00:00
2025-10-29 00:54:05,683 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-06-25&to=2025-07-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:05,685 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:05,686 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:05,686 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:05,687 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:05,687 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:05,688 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:05,688 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:05,689 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:05,689 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:05,689 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:05,690 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:05,690 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:05,691 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:05,691 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:05,691 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:05,693 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:05,693 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:05,693 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:18<00:12,  1.42it/s][A
Fetching FUELHH from 2025-06-25 to 2025-07-02:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:18<00:11,  1.48it/s][A
Fetching FUELHH from 2025-07-02 to 2025-07-09:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:06,196 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-06-25 00:00:00+00:00-2025-07-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:06,198 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-07-02 00:00:00+00:00 to=2025-07-09 00:00:00+00:00
2025-10-29 00:54:06,283 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-07-02&to=2025-07-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:06,293 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:06,294 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:06,294 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:06,295 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:06,295 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:06,296 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:06,296 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:06,296 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:06,297 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:06,297 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:06,297 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:06,297 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:06,298 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:06,298 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:06,298 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:06,299 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:06,300 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:06,300 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:06,789 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-07-02 00:00:00+00:00-2025-07-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:19<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:18<00:10,  1.54it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:19<00:10,  1.54it/s][A
Fetching FUELHH from 2025-07-09 to 2025-07-16:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:20<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:19<00:10,  1.45it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:06,793 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-07-09 00:00:00+00:00 to=2025-07-16 00:00:00+00:00
2025-10-29 00:54:06,879 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-07-09&to=2025-07-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:06,880 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:06,881 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:06,882 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:06,882 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:06,883 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:06,883 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:06,884 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:06,884 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:06,884 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:06,885 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:06,885 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:06,885 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:06,885 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:06,886 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:06,886 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:06,887 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:06,888 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:06,888 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:07,564 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-07-09 00:00:00+00:00-2025-07-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:07,568 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-07-16 00:00:00+00:00 to=2025-07-23 00:00:00+00:00
2025-10-29 00:54:07,666 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-07-16&to=2025-07-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:07,668 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:07,669 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:07,670 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:07,670 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:07,671 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:07,671 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:07,672 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:07,672 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:07,673 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:07,673 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:07,673 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:07,674 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:07,674 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:07,674 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:07,675 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:07,676 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:07,677 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:07,677 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:20<00:10,  1.45it/s][A
Fetching FUELHH from 2025-07-16 to 2025-07-23:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:20<00:09,  1.47it/s][A
Fetching FUELHH from 2025-07-23 to 2025-07-30:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:08,218 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-07-16 00:00:00+00:00-2025-07-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:08,222 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-07-23 00:00:00+00:00 to=2025-07-30 00:00:00+00:00
2025-10-29 00:54:08,321 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-07-23&to=2025-07-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:08,322 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:08,324 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:08,324 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:08,325 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:08,325 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:08,326 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:08,326 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:08,326 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:08,327 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:08,327 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:08,328 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:08,328 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:08,328 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:08,329 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:08,329 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:08,331 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:08,331 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:08,331 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:08,849 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-07-23 00:00:00+00:00-2025-07-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:21<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:20<00:08,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:21<00:08,  1.51it/s][A
Fetching FUELHH from 2025-07-30 to 2025-08-06:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:22<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:21<00:07,  1.51it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:08,851 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-07-30 00:00:00+00:00 to=2025-08-06 00:00:00+00:00
2025-10-29 00:54:08,954 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-07-30&to=2025-08-06&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:08,955 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:08,956 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:08,957 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:08,957 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:08,958 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:08,958 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:08,959 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:08,959 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:08,959 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:08,960 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:08,960 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:08,960 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:08,961 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:08,961 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:08,961 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:08,962 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:08,963 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:08,963 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:09,509 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-07-30 00:00:00+00:00-2025-08-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:09,512 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-08-06 00:00:00+00:00 to=2025-08-13 00:00:00+00:00
2025-10-29 00:54:09,608 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-08-06&to=2025-08-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:09,609 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:09,610 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:09,611 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:09,611 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:09,612 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:09,612 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:09,613 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:09,613 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:09,614 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:09,614 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:09,614 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:09,615 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:09,615 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:09,615 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:09,616 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:09,617 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:09,618 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:09,618 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:22<00:07,  1.51it/s][A
Fetching FUELHH from 2025-08-06 to 2025-08-13:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:23<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:22<00:07,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:23<00:07,  1.47it/s][A
Fetching FUELHH from 2025-08-13 to 2025-08-20:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:10,227 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-08-06 00:00:00+00:00-2025-08-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:10,231 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-08-13 00:00:00+00:00 to=2025-08-20 00:00:00+00:00
2025-10-29 00:54:10,327 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-08-13&to=2025-08-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:10,329 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:10,330 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:10,330 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:10,331 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:10,331 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:10,332 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:10,332 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:10,333 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:10,333 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:10,333 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:10,334 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:10,334 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:10,335 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:10,335 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:10,335 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:10,337 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:10,337 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:10,337 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:11,046 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-08-13 00:00:00+00:00-2025-08-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:23<00:07,  1.39it/s][A
Fetching FUELHH from 2025-08-20 to 2025-08-27:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:24<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:23<00:06,  1.47it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:11,049 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-08-20 00:00:00+00:00 to=2025-08-27 00:00:00+00:00
2025-10-29 00:54:11,137 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-08-20&to=2025-08-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:11,138 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:11,140 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:11,140 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:11,141 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:11,141 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:11,142 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:11,142 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:11,143 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:11,143 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:11,143 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:11,144 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:11,144 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:11,144 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:11,145 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:11,145 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:11,146 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:11,147 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:11,147 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:11,628 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-08-20 00:00:00+00:00-2025-08-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:11,631 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-08-27 00:00:00+00:00 to=2025-09-03 00:00:00+00:00
2025-10-29 00:54:11,736 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-08-27&to=2025-09-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:11,737 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:11,738 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:11,739 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:11,739 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:11,740 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:11,740 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:11,740 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:11,741 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:11,741 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:11,741 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:11,742 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:11,742 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:11,742 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:11,743 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:11,743 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:11,744 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:11,744 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:11,745 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:24<00:06,  1.47it/s][A
Fetching FUELHH from 2025-08-27 to 2025-09-03:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:24<00:05,  1.52it/s][A
Fetching FUELHH from 2025-09-03 to 2025-09-10:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:12,238 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-08-27 00:00:00+00:00-2025-09-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:12,242 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-09-03 00:00:00+00:00 to=2025-09-10 00:00:00+00:00
2025-10-29 00:54:12,334 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-09-03&to=2025-09-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:12,336 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:12,337 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:12,337 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:12,338 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:12,338 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:12,339 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:12,339 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:12,340 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:12,340 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:12,341 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:12,341 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:12,341 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:12,342 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:12,342 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:12,342 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:12,344 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:12,344 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:12,344 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:12,890 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-09-03 00:00:00+00:00-2025-09-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:25<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:24<00:04,  1.52it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:25<00:04,  1.52it/s][A
Fetching FUELHH from 2025-09-10 to 2025-09-17:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:26<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:25<00:03,  1.48it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:12,893 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-09-10 00:00:00+00:00 to=2025-09-17 00:00:00+00:00
2025-10-29 00:54:12,987 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-09-10&to=2025-09-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:12,988 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:12,989 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:12,989 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:12,990 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:12,990 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:12,991 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:12,991 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:12,992 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:12,992 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:12,993 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:12,993 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:12,993 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:12,994 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:12,994 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:12,994 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:12,996 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:12,996 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:12,996 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:13,606 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-09-10 00:00:00+00:00-2025-09-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:13,609 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-09-17 00:00:00+00:00 to=2025-09-24 00:00:00+00:00
2025-10-29 00:54:13,708 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-09-17&to=2025-09-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:13,709 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:13,711 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:13,711 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:13,712 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:13,712 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:13,713 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:13,713 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:13,714 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:13,714 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:13,714 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:13,715 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:13,715 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:13,715 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:13,716 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:13,716 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:13,718 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:13,718 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:13,718 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:26<00:03,  1.48it/s][A
Fetching FUELHH from 2025-09-17 to 2025-09-24:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:26<00:03,  1.53it/s][A
Fetching FUELHH from 2025-09-24 to 2025-10-01:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:26<00:02,  1.55it/s][A
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:26<00:02,  1.55it/s][A                                                      
                                                                                                              [A2025-10-29 00:54:14,206 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-09-17 00:00:00+00:00-2025-09-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:14,207 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-09-24 00:00:00+00:00 to=2025-10-01 00:00:00+00:00
2025-10-29 00:54:14,314 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-09-24&to=2025-10-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:14,315 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:14,315 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:14,315 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:14,316 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:14,316 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:14,316 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:14,316 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:14,317 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:14,317 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:14,317 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:14,317 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:14,317 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:14,317 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:14,318 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:14,318 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:14,318 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:14,319 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:14,319 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:14,829 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-09-24 00:00:00+00:00-2025-10-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:27<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:26<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:28<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:27<00:02,  1.55it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:28<00:02,  1.55it/s][A
Fetching FUELHH from 2025-10-01 to 2025-10-08:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:29<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:28<00:02,  1.13it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [A2025-10-29 00:54:14,844 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-10-01 00:00:00+00:00 to=2025-10-08 00:00:00+00:00
2025-10-29 00:54:15,332 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-10-01&to=2025-10-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:15,336 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:15,337 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:15,337 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:15,338 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:15,338 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:15,338 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:15,338 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:15,339 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:15,339 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:15,339 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:15,339 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:15,339 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:15,340 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:15,340 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:15,340 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:15,341 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:15,341 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:15,341 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:16,290 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-10-01 00:00:00+00:00-2025-10-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:16,293 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-10-08 00:00:00+00:00 to=2025-10-15 00:00:00+00:00
2025-10-29 00:54:16,367 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-10-08&to=2025-10-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:16,370 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:16,371 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:16,371 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:16,371 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:16,371 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:16,371 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:16,372 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:16,372 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:16,372 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:16,372 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:16,372 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:16,372 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:16,373 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:16,373 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:16,373 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:16,374 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:16,374 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:16,374 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
Dataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:29<00:02,  1.13it/s][A
Fetching FUELHH from 2025-10-08 to 2025-10-15:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:30<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:29<00:01,  1.07it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:30<00:01,  1.07it/s][A
Fetching FUELHH from 2025-10-15 to 2025-10-22:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:30<00:00,  1.13s/it][A
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:30<00:00,  1.13s/it][A                                                      
                                                                                                              [A2025-10-29 00:54:17,338 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-10-08 00:00:00+00:00-2025-10-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:17,341 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-10-15 00:00:00+00:00 to=2025-10-22 00:00:00+00:00
2025-10-29 00:54:17,434 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-10-15&to=2025-10-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:17,436 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:17,437 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:17,438 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:17,438 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:17,439 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:17,440 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:17,440 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:17,440 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:17,441 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:17,441 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:17,442 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:17,442 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:17,442 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:17,443 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:17,443 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:17,445 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:17,445 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:17,445 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:18,911 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-10-15 00:00:00+00:00-2025-10-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Dataset: FUELHH:   0%|          | 0/2 [00:31<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:30<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:32<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:31<00:00,  1.13s/it][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                      
                                                                                                              [ADataset: FUELHH:   0%|          | 0/2 [00:33<?, ?it/s]
Fetching FUELHH from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:32<00:00,  1.13s/it][A
/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/tqdm/std.py:636: TqdmWarning: clamping frac to range [0, 1]
  full_bar = Bar(frac,
Fetching FUELHH from 2025-10-22 to 2025-10-28: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 43/42.857142857142854 [00:32<00:00,  1.12s/it][A
                                                                                                              [ADataset: FUELHH:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:33<00:33, 33.05s/it]Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:33<00:33, 33.05s/it]                                                                Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:33<00:33, 33.05s/it]                                                                Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]2025-10-29 00:54:18,915 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-10-22 00:00:00+00:00 to=2025-10-28 00:00:00+00:00
2025-10-29 00:54:19,434 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/day-total?from=2025-10-22&to=2025-10-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:19,438 - INFO - Successfully fetched 11 records for FUELHH from Insights API.
2025-10-29 00:54:19,441 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:19,442 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-10-29 00:54:19,444 - INFO -  -> Forced object column 'psrType' to string.
2025-10-29 00:54:19,445 - INFO -  -> Converted float column 'halfHourUsage' to nullable Float64.
2025-10-29 00:54:19,447 - INFO -  -> Converted float column 'halfHourPercentage' to nullable Float64.
2025-10-29 00:54:19,448 - INFO -  -> Converted float column 'twentyFourHourUsage' to nullable Float64.
2025-10-29 00:54:19,448 - INFO -  -> Converted float column 'twentyFourHourPercentage' to nullable Float64.
2025-10-29 00:54:19,449 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:19,449 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:19,450 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:19,450 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:19,451 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:19,451 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:19,451 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:19,454 - INFO - Created hash keys for 11 rows using 5 content columns
2025-10-29 00:54:19,454 - WARNING - No corrected schema file found for dataset 'FUELHH' at 'schemas/corrected/bmrs_fuelhh.json'.
2025-10-29 00:54:19,454 - WARNING - Could not find corrected schema for FUELHH. Using autodetect.
2025-10-29 00:54:20,028 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-10-22 00:00:00+00:00-2025-10-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelhh. Cannot add fields (field: psrType)
2025-10-29 00:54:20,033 - INFO - üîé Querying existing windows for inner-cinema-476211-u9.uk_energy_prod.bmrs_fuelinst between 2025-01-01 00:00:00+00:00 and 2025-10-28 00:00:00+00:00
2025-10-29 00:54:21,065 - INFO - Found 0 existing windows for bmrs_fuelinst

Windows for FUELINST:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                       [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-01 to 2025-01-08:   0%|          | 0/42.857142857142854 [00:00<?, ?it/s][A
Fetching FUELINST from 2025-01-01 to 2025-01-08:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:33,  1.25it/s][A
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:34<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:00<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:54:21,066 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-01-01 00:00:00+00:00 to=2025-01-08 00:00:00+00:00
2025-10-29 00:54:21,195 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-01-01&to=2025-01-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:21,207 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:21,213 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:21,214 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:21,214 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:21,216 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:21,216 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:21,221 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:21,222 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:21,222 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:21,222 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:21,223 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:21,223 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:21,223 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:21,224 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:21,233 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:21,233 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:21,233 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:21,864 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-01-01 00:00:00+00:00-2025-01-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:21,867 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-01-08 00:00:00+00:00 to=2025-01-15 00:00:00+00:00
2025-10-29 00:54:22,063 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-01-08&to=2025-01-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:22,074 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:22,077 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:22,078 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:22,079 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:22,080 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:22,080 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:22,087 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:22,087 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:22,088 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:22,088 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:22,089 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:22,089 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:22,089 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:22,090 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:22,100 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:22,100 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:22,100 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-08 to 2025-01-15:   2%|‚ñè         | 1/42.857142857142854 [00:01<00:33,  1.25it/s][A
Fetching FUELINST from 2025-01-08 to 2025-01-15:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:35<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:01<00:33,  1.20it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-15 to 2025-01-22:   5%|‚ñç         | 2/42.857142857142854 [00:02<00:33,  1.20it/s][A
Fetching FUELINST from 2025-01-15 to 2025-01-22:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [A2025-10-29 00:54:22,719 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-01-08 00:00:00+00:00-2025-01-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:22,721 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-01-15 00:00:00+00:00 to=2025-01-22 00:00:00+00:00
2025-10-29 00:54:22,920 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-01-15&to=2025-01-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:22,928 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:54:22,931 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:22,932 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:22,933 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:22,934 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:22,935 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:22,941 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:22,941 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:22,942 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:22,942 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:22,943 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:22,943 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:22,943 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:22,944 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:22,954 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:54:22,954 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:22,954 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:23,736 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-01-15 00:00:00+00:00-2025-01-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:23,738 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-01-22 00:00:00+00:00 to=2025-01-29 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:36<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:02<00:36,  1.09it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-22 to 2025-01-29:   7%|‚ñã         | 3/42.857142857142854 [00:03<00:36,  1.09it/s][A
Fetching FUELINST from 2025-01-22 to 2025-01-29:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:37<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:03<00:33,  1.18it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:54:23,849 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-01-22&to=2025-01-29&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:23,859 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:23,861 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:23,863 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:23,863 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:23,864 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:23,865 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:23,871 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:23,872 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:23,872 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:23,872 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:23,873 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:23,873 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:23,874 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:23,874 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:23,884 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:23,884 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:23,884 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:24,485 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-01-22 00:00:00+00:00-2025-01-29 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:24,488 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-01-29 00:00:00+00:00 to=2025-02-05 00:00:00+00:00
2025-10-29 00:54:24,686 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-01-29&to=2025-02-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:24,694 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:24,697 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:24,699 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:24,699 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:24,700 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:24,701 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:24,707 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:24,708 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:24,708 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:24,708 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:24,709 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:24,709 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:24,710 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:24,710 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:24,720 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:24,720 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:24,721 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-01-29 to 2025-02-05:   9%|‚ñâ         | 4/42.857142857142854 [00:04<00:33,  1.18it/s][A
Fetching FUELINST from 2025-01-29 to 2025-02-05:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-05 to 2025-02-12:  12%|‚ñà‚ñè        | 5/42.857142857142854 [00:04<00:30,  1.25it/s][A
Fetching FUELINST from 2025-02-05 to 2025-02-12:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [A2025-10-29 00:54:25,201 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-01-29 00:00:00+00:00-2025-02-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:25,204 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-02-05 00:00:00+00:00 to=2025-02-12 00:00:00+00:00
2025-10-29 00:54:25,300 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-02-05&to=2025-02-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:25,308 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:25,309 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:25,309 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:25,309 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:25,310 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:25,310 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:25,312 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:25,313 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:25,314 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:25,318 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:25,318 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:25,318 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:25,830 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-02-05 00:00:00+00:00-2025-02-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:25,833 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-02-12 00:00:00+00:00 to=2025-02-19 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:38<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:04<00:27,  1.35it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-12 to 2025-02-19:  14%|‚ñà‚ñç        | 6/42.857142857142854 [00:05<00:27,  1.35it/s][A
Fetching FUELINST from 2025-02-12 to 2025-02-19:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:39<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:05<00:27,  1.32it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [A2025-10-29 00:54:25,965 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-02-12&to=2025-02-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:25,974 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:25,976 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:25,977 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:25,978 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:25,979 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:25,980 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:25,985 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:25,986 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:25,986 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:25,987 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:25,987 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:25,987 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:25,988 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:25,988 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:25,998 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:25,998 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:25,998 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:26,613 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-02-12 00:00:00+00:00-2025-02-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:26,617 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-02-19 00:00:00+00:00 to=2025-02-26 00:00:00+00:00
2025-10-29 00:54:26,830 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-02-19&to=2025-02-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:26,840 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:26,843 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:26,844 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:26,845 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:26,846 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:26,847 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:26,853 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:26,853 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:26,854 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:26,854 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:26,854 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:26,855 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:26,855 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:26,855 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:26,865 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:26,865 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:26,866 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-19 to 2025-02-26:  16%|‚ñà‚ñã        | 7/42.857142857142854 [00:06<00:27,  1.32it/s][A
Fetching FUELINST from 2025-02-19 to 2025-02-26:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:40<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:06<00:26,  1.30it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-02-26 to 2025-03-05:  19%|‚ñà‚ñä        | 8/42.857142857142854 [00:07<00:26,  1.30it/s][A
Fetching FUELINST from 2025-02-26 to 2025-03-05:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [A2025-10-29 00:54:27,414 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-02-19 00:00:00+00:00-2025-02-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:27,417 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-02-26 00:00:00+00:00 to=2025-03-05 00:00:00+00:00
2025-10-29 00:54:27,636 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-02-26&to=2025-03-05&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:27,644 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:27,648 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:27,649 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:27,650 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:27,651 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:27,651 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:27,658 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:27,658 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:27,659 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:27,659 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:27,659 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:27,660 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:27,660 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:27,660 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:27,670 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:27,671 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:27,671 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:28,213 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-02-26 00:00:00+00:00-2025-03-05 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:28,216 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-03-05 00:00:00+00:00 to=2025-03-12 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:41<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                               [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-05 to 2025-03-12:  21%|‚ñà‚ñà        | 9/42.857142857142854 [00:07<00:26,  1.28it/s][A
Fetching FUELINST from 2025-03-05 to 2025-03-12:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:25,  1.28it/s][A
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:07<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:28,416 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-03-05&to=2025-03-12&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:28,426 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:28,429 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:28,431 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:28,431 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:28,432 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:28,433 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:28,439 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:28,439 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:28,440 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:28,440 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:28,441 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:28,441 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:28,441 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:28,442 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:28,451 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:28,452 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:28,452 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:28,990 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-03-05 00:00:00+00:00-2025-03-12 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:28,992 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-03-12 00:00:00+00:00 to=2025-03-19 00:00:00+00:00
2025-10-29 00:54:29,100 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-03-12&to=2025-03-19&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:29,102 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:54:29,103 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:29,103 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:29,104 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:29,104 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:29,104 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:29,107 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:29,107 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:29,107 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:29,107 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:29,107 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:29,108 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:29,108 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:29,108 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:29,112 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:54:29,113 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:29,113 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-12 to 2025-03-19:  23%|‚ñà‚ñà‚ñé       | 10/42.857142857142854 [00:08<00:25,  1.28it/s][A
Fetching FUELINST from 2025-03-12 to 2025-03-19:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:42<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:08<00:24,  1.31it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-19 to 2025-03-26:  26%|‚ñà‚ñà‚ñå       | 11/42.857142857142854 [00:09<00:24,  1.31it/s][A
Fetching FUELINST from 2025-03-19 to 2025-03-26:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:29,728 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-03-12 00:00:00+00:00-2025-03-19 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:29,730 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-03-19 00:00:00+00:00 to=2025-03-26 00:00:00+00:00
2025-10-29 00:54:29,920 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-03-19&to=2025-03-26&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:29,928 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:29,930 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:29,932 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:29,933 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:29,934 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:29,934 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:29,940 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:29,941 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:29,941 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:29,942 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:29,942 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:29,943 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:29,943 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:29,943 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:29,953 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:29,954 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:29,954 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:30,535 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-03-19 00:00:00+00:00-2025-03-26 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:30,538 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-03-26 00:00:00+00:00 to=2025-04-02 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:43<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:09<00:24,  1.28it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-03-26 to 2025-04-02:  28%|‚ñà‚ñà‚ñä       | 12/42.857142857142854 [00:10<00:24,  1.28it/s][A
Fetching FUELINST from 2025-03-26 to 2025-04-02:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:44<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:10<00:23,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:30,664 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-03-26&to=2025-04-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:30,671 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:30,673 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:30,675 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:30,676 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:30,677 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:30,677 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:30,682 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:30,683 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:30,683 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:30,684 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:30,684 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:30,684 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:30,685 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:30,685 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:30,695 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:30,695 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:30,695 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:31,301 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-03-26 00:00:00+00:00-2025-04-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:31,304 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-04-02 00:00:00+00:00 to=2025-04-09 00:00:00+00:00
2025-10-29 00:54:31,505 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-04-02&to=2025-04-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:31,515 - INFO - Successfully fetched 326 records for FUELINST from Insights API.
2025-10-29 00:54:31,517 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:31,518 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:31,519 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:31,520 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:31,521 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:31,527 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:31,527 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:31,527 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:31,528 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:31,528 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:31,529 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:31,529 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:31,529 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:31,539 - INFO - Created hash keys for 326 rows using 3 content columns
2025-10-29 00:54:31,539 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:31,540 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-02 to 2025-04-09:  30%|‚ñà‚ñà‚ñà       | 13/42.857142857142854 [00:11<00:23,  1.29it/s][A
Fetching FUELINST from 2025-04-02 to 2025-04-09:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-09 to 2025-04-16:  33%|‚ñà‚ñà‚ñà‚ñé      | 14/42.857142857142854 [00:11<00:23,  1.24it/s][A
Fetching FUELINST from 2025-04-09 to 2025-04-16:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:11<00:21,  1.29it/s][A
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:11<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:45<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:11<00:21,  1.29it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:32,171 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-04-02 00:00:00+00:00-2025-04-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:32,174 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-04-09 00:00:00+00:00 to=2025-04-16 00:00:00+00:00
2025-10-29 00:54:32,355 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-04-09&to=2025-04-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:32,364 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:32,366 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:32,368 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:32,369 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:32,370 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:32,370 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:32,377 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:32,377 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:32,378 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:32,378 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:32,378 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:32,379 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:32,379 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:32,379 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:32,390 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:32,390 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:32,390 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:32,878 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-04-09 00:00:00+00:00-2025-04-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:32,882 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-04-16 00:00:00+00:00 to=2025-04-23 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-16 to 2025-04-23:  35%|‚ñà‚ñà‚ñà‚ñå      | 15/42.857142857142854 [00:12<00:21,  1.29it/s][A
Fetching FUELINST from 2025-04-16 to 2025-04-23:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:46<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:12<00:21,  1.27it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:33,072 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-04-16&to=2025-04-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:33,082 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:33,085 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:33,086 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:33,087 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:33,088 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:33,089 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:33,094 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:33,095 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:33,095 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:33,095 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:33,096 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:33,096 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:33,097 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:33,097 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:33,107 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:33,107 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:33,107 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:33,697 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-04-16 00:00:00+00:00-2025-04-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:33,700 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-04-23 00:00:00+00:00 to=2025-04-30 00:00:00+00:00
2025-10-29 00:54:33,924 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-04-23&to=2025-04-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:33,929 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:33,931 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:33,932 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:33,932 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:33,933 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:33,934 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:33,938 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:33,938 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:33,939 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:33,939 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:33,939 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:33,940 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:33,940 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:33,940 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:33,949 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:33,949 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:33,949 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-23 to 2025-04-30:  37%|‚ñà‚ñà‚ñà‚ñã      | 16/42.857142857142854 [00:13<00:21,  1.27it/s][A
Fetching FUELINST from 2025-04-23 to 2025-04-30:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:47<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:13<00:20,  1.24it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-04-30 to 2025-05-07:  40%|‚ñà‚ñà‚ñà‚ñâ      | 17/42.857142857142854 [00:14<00:20,  1.24it/s][A
Fetching FUELINST from 2025-04-30 to 2025-05-07:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:34,543 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-04-23 00:00:00+00:00-2025-04-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:34,546 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-04-30 00:00:00+00:00 to=2025-05-07 00:00:00+00:00
2025-10-29 00:54:34,714 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-04-30&to=2025-05-07&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:34,745 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:34,748 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:34,749 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:34,750 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:34,751 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:34,751 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:34,757 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:34,757 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:34,758 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:34,758 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:34,758 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:34,759 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:34,759 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:34,759 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:34,768 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:34,769 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:34,769 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:35,282 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-04-30 00:00:00+00:00-2025-05-07 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:35,285 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-05-07 00:00:00+00:00 to=2025-05-14 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:48<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-07 to 2025-05-14:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 18/42.857142857142854 [00:14<00:19,  1.27it/s][A
Fetching FUELINST from 2025-05-07 to 2025-05-14:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:14<00:18,  1.30it/s][A
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:14<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:14<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:35,501 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-05-07&to=2025-05-14&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:35,510 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:35,512 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:35,514 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:35,514 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:35,515 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:35,516 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:35,522 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:35,523 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:35,523 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:35,523 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:35,524 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:35,525 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:35,525 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:35,525 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:35,535 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:35,536 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:35,536 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:36,019 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-05-07 00:00:00+00:00-2025-05-14 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:36,021 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-05-14 00:00:00+00:00 to=2025-05-21 00:00:00+00:00
2025-10-29 00:54:36,217 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-05-14&to=2025-05-21&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:36,228 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:36,231 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:36,232 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:36,233 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:36,234 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:36,234 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:36,241 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:36,241 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:36,241 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:36,242 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:36,242 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:36,243 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:36,243 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:36,243 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:36,253 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:36,254 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:36,254 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-14 to 2025-05-21:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 19/42.857142857142854 [00:15<00:18,  1.30it/s][A
Fetching FUELINST from 2025-05-14 to 2025-05-21:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:15<00:18,  1.22it/s][A
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:15<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:49<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:15<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-21 to 2025-05-28:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 20/42.857142857142854 [00:16<00:18,  1.22it/s][A
Fetching FUELINST from 2025-05-21 to 2025-05-28:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:36,952 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-05-14 00:00:00+00:00-2025-05-21 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:36,955 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-05-21 00:00:00+00:00 to=2025-05-28 00:00:00+00:00
2025-10-29 00:54:37,140 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-05-21&to=2025-05-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:37,148 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:37,152 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:37,153 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:37,154 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:37,155 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:37,156 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:37,162 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:37,163 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:37,163 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:37,164 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:37,164 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:37,164 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:37,165 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:37,165 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:37,175 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:37,175 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:37,176 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:37,786 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-05-21 00:00:00+00:00-2025-05-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:37,788 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-05-28 00:00:00+00:00 to=2025-06-04 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:50<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:16<00:18,  1.21it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-05-28 to 2025-06-04:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 21/42.857142857142854 [00:17<00:18,  1.21it/s][A
Fetching FUELINST from 2025-05-28 to 2025-06-04:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:51<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:17<00:16,  1.27it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:37,911 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-05-28&to=2025-06-04&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:37,920 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:37,923 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:37,924 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:37,925 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:37,926 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:37,926 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:37,931 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:37,932 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:37,932 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:37,933 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:37,933 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:37,933 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:37,934 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:37,934 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:37,943 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:37,944 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:37,944 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:38,496 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-05-28 00:00:00+00:00-2025-06-04 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:38,498 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-06-04 00:00:00+00:00 to=2025-06-11 00:00:00+00:00
2025-10-29 00:54:38,706 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-06-04&to=2025-06-11&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:38,715 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:38,717 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:38,718 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:38,719 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:38,720 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:38,721 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:38,727 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:38,727 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:38,728 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:38,728 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:38,728 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:38,729 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:38,729 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:38,730 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:38,739 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:38,740 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:38,740 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-04 to 2025-06-11:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 22/42.857142857142854 [00:18<00:16,  1.27it/s][A
Fetching FUELINST from 2025-06-04 to 2025-06-11:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:52<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:18<00:16,  1.18it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-11 to 2025-06-18:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 23/42.857142857142854 [00:19<00:16,  1.18it/s][A
Fetching FUELINST from 2025-06-11 to 2025-06-18:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:39,468 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-06-04 00:00:00+00:00-2025-06-11 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:39,471 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-06-11 00:00:00+00:00 to=2025-06-18 00:00:00+00:00
2025-10-29 00:54:39,585 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-06-11&to=2025-06-18&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:39,589 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:39,590 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:39,591 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:39,591 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:39,591 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:39,592 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:39,594 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:39,594 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:39,594 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:39,595 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:39,595 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:39,595 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:39,595 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:39,595 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:39,600 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:39,600 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:39,600 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:40,217 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-06-11 00:00:00+00:00-2025-06-18 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:40,221 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-06-18 00:00:00+00:00 to=2025-06-25 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:53<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-18 to 2025-06-25:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 24/42.857142857142854 [00:19<00:15,  1.23it/s][A
Fetching FUELINST from 2025-06-18 to 2025-06-25:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:19<00:14,  1.24it/s][A
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:19<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:19<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:40,414 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-06-18&to=2025-06-25&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:40,420 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:40,422 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:40,423 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:40,424 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:40,425 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:40,425 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:40,431 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:40,431 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:40,431 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:40,432 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:40,432 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:40,432 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:40,433 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:40,433 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:40,442 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:40,442 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:40,442 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:40,993 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-06-18 00:00:00+00:00-2025-06-25 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:40,997 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-06-25 00:00:00+00:00 to=2025-07-02 00:00:00+00:00
2025-10-29 00:54:41,119 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-06-25&to=2025-07-02&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:41,128 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:41,130 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:41,131 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:41,132 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:41,133 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:41,133 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:41,139 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:41,139 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:41,140 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:41,140 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:41,140 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:41,141 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:41,141 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:41,142 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:41,151 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:41,151 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:41,152 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-06-25 to 2025-07-02:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 25/42.857142857142854 [00:20<00:14,  1.24it/s][A
Fetching FUELINST from 2025-06-25 to 2025-07-02:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:54<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:20<00:13,  1.25it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-02 to 2025-07-09:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 26/42.857142857142854 [00:21<00:13,  1.25it/s][A
Fetching FUELINST from 2025-07-02 to 2025-07-09:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:41,786 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-06-25 00:00:00+00:00-2025-07-02 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:41,789 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-07-02 00:00:00+00:00 to=2025-07-09 00:00:00+00:00
2025-10-29 00:54:41,983 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-07-02&to=2025-07-09&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:41,991 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:41,994 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:41,995 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:41,996 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:41,997 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:41,997 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:42,004 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:42,004 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:42,006 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:42,006 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:42,006 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:42,007 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:42,007 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:42,007 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:42,017 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:42,018 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:42,018 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:42,568 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-07-02 00:00:00+00:00-2025-07-09 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:42,571 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-07-09 00:00:00+00:00 to=2025-07-16 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:55<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:21<00:12,  1.26it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-09 to 2025-07-16:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 27/42.857142857142854 [00:22<00:12,  1.26it/s][A
Fetching FUELINST from 2025-07-09 to 2025-07-16:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:56<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:22<00:11,  1.26it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:42,694 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-07-09&to=2025-07-16&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:42,702 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:54:42,705 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:42,706 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:42,707 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:42,707 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:42,708 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:42,713 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:42,714 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:42,717 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:42,717 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:42,718 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:42,718 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:42,719 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:42,719 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:42,728 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:54:42,729 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:42,729 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:43,363 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-07-09 00:00:00+00:00-2025-07-16 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:43,366 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-07-16 00:00:00+00:00 to=2025-07-23 00:00:00+00:00
2025-10-29 00:54:43,558 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-07-16&to=2025-07-23&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:43,564 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:43,567 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:43,568 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:43,569 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:43,570 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:43,570 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:43,576 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:43,577 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:43,578 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:43,578 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:43,578 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:43,579 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:43,579 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:43,579 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:43,589 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:43,590 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:43,590 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-16 to 2025-07-23:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 28/42.857142857142854 [00:23<00:11,  1.26it/s][A
Fetching FUELINST from 2025-07-16 to 2025-07-23:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-23 to 2025-07-30:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 29/42.857142857142854 [00:23<00:11,  1.23it/s][A
Fetching FUELINST from 2025-07-23 to 2025-07-30:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:23<00:10,  1.26it/s][A
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:23<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:57<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:23<00:10,  1.26it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:44,226 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-07-16 00:00:00+00:00-2025-07-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:44,229 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-07-23 00:00:00+00:00 to=2025-07-30 00:00:00+00:00
2025-10-29 00:54:44,415 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-07-23&to=2025-07-30&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:44,424 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:44,427 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:44,428 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:44,429 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:44,430 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:44,430 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:44,436 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:44,437 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:44,437 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:44,438 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:44,438 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:44,438 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:44,439 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:44,439 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:44,449 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:44,449 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:44,449 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:44,966 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-07-23 00:00:00+00:00-2025-07-30 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:44,969 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-07-30 00:00:00+00:00 to=2025-08-06 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-07-30 to 2025-08-06:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 30/42.857142857142854 [00:24<00:10,  1.26it/s][A
Fetching FUELINST from 2025-07-30 to 2025-08-06:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:58<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:24<00:08,  1.37it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:45,130 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-07-30&to=2025-08-06&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:45,135 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:45,138 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:45,139 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:45,139 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:45,140 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:45,140 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:45,144 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:45,144 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:45,145 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:45,145 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:45,145 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:45,145 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:45,146 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:45,146 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:45,152 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:45,153 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:45,153 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:45,558 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-07-30 00:00:00+00:00-2025-08-06 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:45,560 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-08-06 00:00:00+00:00 to=2025-08-13 00:00:00+00:00
2025-10-29 00:54:45,724 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-08-06&to=2025-08-13&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:45,732 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:45,734 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:45,736 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:45,736 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:45,737 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:45,738 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:45,743 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:45,744 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:45,744 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:45,744 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:45,745 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:45,745 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:45,745 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:45,746 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:45,755 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:45,755 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:45,755 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-06 to 2025-08-13:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 31/42.857142857142854 [00:25<00:08,  1.37it/s][A
Fetching FUELINST from 2025-08-06 to 2025-08-13:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:59<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:25<00:08,  1.34it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-13 to 2025-08-20:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 32/42.857142857142854 [00:26<00:08,  1.34it/s][A
Fetching FUELINST from 2025-08-13 to 2025-08-20:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:46,344 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-08-06 00:00:00+00:00-2025-08-13 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:46,348 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-08-13 00:00:00+00:00 to=2025-08-20 00:00:00+00:00
2025-10-29 00:54:46,587 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-08-13&to=2025-08-20&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:46,596 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:46,598 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:46,600 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:46,600 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:46,601 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:46,602 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:46,608 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:46,609 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:46,609 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:46,609 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:46,610 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:46,610 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:46,611 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:46,611 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:46,621 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:46,621 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:46,622 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:47,396 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-08-13 00:00:00+00:00-2025-08-20 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:47,398 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-08-20 00:00:00+00:00 to=2025-08-27 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:00<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:26<00:08,  1.19it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-20 to 2025-08-27:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 33/42.857142857142854 [00:27<00:08,  1.19it/s][A
Fetching FUELINST from 2025-08-20 to 2025-08-27:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:47,622 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-08-20&to=2025-08-27&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:47,633 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:47,636 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:47,637 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:47,638 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:47,639 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:47,639 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:47,646 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:47,647 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:47,647 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:47,647 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:47,648 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:47,648 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:47,648 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:47,649 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:47,659 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:47,659 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:47,659 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:48,269 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-08-20 00:00:00+00:00-2025-08-27 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:48,272 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-08-27 00:00:00+00:00 to=2025-09-03 00:00:00+00:00
2025-10-29 00:54:48,388 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-08-27&to=2025-09-03&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:48,396 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:48,398 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:48,399 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:48,400 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:48,401 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:48,401 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:48,406 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:48,407 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:48,407 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:48,408 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:48,408 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:48,408 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:48,409 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:48,409 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:48,418 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:48,419 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:48,419 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-08-27 to 2025-09-03:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 34/42.857142857142854 [00:27<00:07,  1.18it/s][A
Fetching FUELINST from 2025-08-27 to 2025-09-03:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:27<00:06,  1.27it/s][A
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:27<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:01<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:27<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-03 to 2025-09-10:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 35/42.857142857142854 [00:28<00:06,  1.27it/s][A
Fetching FUELINST from 2025-09-03 to 2025-09-10:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:48,902 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-08-27 00:00:00+00:00-2025-09-03 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:48,904 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-09-03 00:00:00+00:00 to=2025-09-10 00:00:00+00:00
2025-10-29 00:54:49,132 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-09-03&to=2025-09-10&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:49,142 - INFO - Successfully fetched 330 records for FUELINST from Insights API.
2025-10-29 00:54:49,145 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:49,146 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:49,147 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:49,148 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:49,148 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:49,154 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:49,155 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:49,155 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:49,156 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:49,156 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:49,156 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:49,157 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:49,157 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:49,167 - INFO - Created hash keys for 330 rows using 3 content columns
2025-10-29 00:54:49,167 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:49,167 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:49,664 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-09-03 00:00:00+00:00-2025-09-10 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:49,667 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-09-10 00:00:00+00:00 to=2025-09-17 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:02<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:28<00:05,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-10 to 2025-09-17:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 36/42.857142857142854 [00:29<00:05,  1.29it/s][A
Fetching FUELINST from 2025-09-10 to 2025-09-17:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:03<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:29<00:04,  1.29it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:49,849 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-09-10&to=2025-09-17&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:49,858 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:49,861 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:49,863 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:49,863 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:49,865 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:49,865 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:49,872 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:49,872 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:49,872 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:49,873 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:49,873 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:49,874 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:49,874 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:49,874 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:49,884 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:49,885 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:49,885 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:50,432 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-09-10 00:00:00+00:00-2025-09-17 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:50,435 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-09-17 00:00:00+00:00 to=2025-09-24 00:00:00+00:00
2025-10-29 00:54:50,560 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-09-17&to=2025-09-24&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:50,569 - INFO - Successfully fetched 336 records for FUELINST from Insights API.
2025-10-29 00:54:50,571 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:50,573 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:50,573 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:50,574 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:50,575 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:50,580 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:50,580 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:50,581 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:50,581 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:50,582 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:50,582 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:50,582 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:50,583 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:50,592 - INFO - Created hash keys for 336 rows using 3 content columns
2025-10-29 00:54:50,592 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:50,592 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-17 to 2025-09-24:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 37/42.857142857142854 [00:30<00:04,  1.29it/s][A
Fetching FUELINST from 2025-09-17 to 2025-09-24:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-09-24 to 2025-10-01:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 38/42.857142857142854 [00:30<00:03,  1.37it/s][A
Fetching FUELINST from 2025-09-24 to 2025-10-01:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:04<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:51,065 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-09-17 00:00:00+00:00-2025-09-24 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:51,068 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-09-24 00:00:00+00:00 to=2025-10-01 00:00:00+00:00
2025-10-29 00:54:51,274 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-09-24&to=2025-10-01&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:51,283 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:51,285 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:51,287 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:51,287 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:51,288 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:51,289 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:51,295 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:51,295 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:51,296 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:51,296 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:51,297 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:51,297 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:51,297 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:51,297 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:51,308 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:51,308 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:51,308 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:51,813 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-09-24 00:00:00+00:00-2025-10-01 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:51,816 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-10-01 00:00:00+00:00 to=2025-10-08 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:30<00:02,  1.36it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-01 to 2025-10-08:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 39/42.857142857142854 [00:31<00:02,  1.36it/s][A
Fetching FUELINST from 2025-10-01 to 2025-10-08:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:05<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:31<00:02,  1.22it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [A2025-10-29 00:54:52,022 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-10-01&to=2025-10-08&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:52,032 - INFO - Successfully fetched 335 records for FUELINST from Insights API.
2025-10-29 00:54:52,034 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:52,035 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:52,036 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:52,037 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:52,038 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:52,044 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:52,044 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:52,045 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:52,045 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:52,045 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:52,046 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:52,046 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:52,046 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:52,056 - INFO - Created hash keys for 335 rows using 3 content columns
2025-10-29 00:54:52,056 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:52,057 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:52,823 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-10-01 00:00:00+00:00-2025-10-08 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:52,826 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-10-08 00:00:00+00:00 to=2025-10-15 00:00:00+00:00
2025-10-29 00:54:53,029 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-10-08&to=2025-10-15&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:53,037 - INFO - Successfully fetched 334 records for FUELINST from Insights API.
2025-10-29 00:54:53,040 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:53,041 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:53,042 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:53,043 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:53,044 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:53,050 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:53,050 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:53,051 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:53,051 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:53,051 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:53,052 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:53,052 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:53,052 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:53,062 - INFO - Created hash keys for 334 rows using 3 content columns
2025-10-29 00:54:53,063 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:53,063 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-08 to 2025-10-15:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 40/42.857142857142854 [00:32<00:02,  1.22it/s][A
Fetching FUELINST from 2025-10-08 to 2025-10-15:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:06<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:32<00:01,  1.23it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-15 to 2025-10-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 41/42.857142857142854 [00:33<00:01,  1.23it/s][A
Fetching FUELINST from 2025-10-15 to 2025-10-22:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [A2025-10-29 00:54:53,624 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-10-08 00:00:00+00:00-2025-10-15 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:53,627 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-10-15 00:00:00+00:00 to=2025-10-22 00:00:00+00:00
2025-10-29 00:54:53,844 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-10-15&to=2025-10-22&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:53,855 - INFO - Successfully fetched 337 records for FUELINST from Insights API.
2025-10-29 00:54:53,857 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:53,858 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:53,859 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:53,860 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:53,861 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:53,867 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:53,867 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:53,868 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:53,868 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:53,868 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:53,869 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:53,869 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:53,869 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:53,879 - INFO - Created hash keys for 337 rows using 3 content columns
2025-10-29 00:54:53,880 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:53,880 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:54,393 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-10-15 00:00:00+00:00-2025-10-22 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:54,397 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-10-22 00:00:00+00:00 to=2025-10-28 00:00:00+00:00
Dataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:07<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:33<00:00,  1.25it/s][A/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/_pandas_helpers.py:484: FutureWarning: Loading pandas DataFrame into BigQuery will require pandas-gbq package version 0.26.1 or greater in the future. Tried to import pandas-gbq and got: No module named 'pandas_gbq'
  warnings.warn(
                                                                
                                                                                                                [ADataset: FUELINST:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [01:08<00:33, 33.05s/it]
Fetching FUELINST from 2025-10-22 to 2025-10-28:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 42/42.857142857142854 [00:34<00:00,  1.25it/s][A
/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/tqdm/std.py:636: TqdmWarning: clamping frac to range [0, 1]
  full_bar = Bar(frac,
Fetching FUELINST from 2025-10-22 to 2025-10-28: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 43/42.857142857142854 [00:34<00:00,  1.26it/s][A
                                                                                                                [ADataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [01:08<00:00, 34.28s/it]Dataset: FUELINST: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [01:08<00:00, 34.10s/it]
2025-10-29 00:54:54,634 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type?from=2025-10-22&to=2025-10-28&format=json "HTTP/1.1 200 OK"
2025-10-29 00:54:54,640 - INFO - Successfully fetched 289 records for FUELINST from Insights API.
2025-10-29 00:54:54,642 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-10-29 00:54:54,643 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:54,644 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-10-29 00:54:54,645 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-10-29 00:54:54,646 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-10-29 00:54:54,651 - INFO -  -> Forced object column 'data' to string.
2025-10-29 00:54:54,651 - INFO -  -> Forced object column '_dataset' to string.
2025-10-29 00:54:54,651 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-10-29 00:54:54,652 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-10-29 00:54:54,652 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-10-29 00:54:54,653 - INFO -  -> Forced object column '_source_columns' to string.
2025-10-29 00:54:54,653 - INFO -  -> Forced object column '_source_api' to string.
2025-10-29 00:54:54,653 - INFO - --- Final sanitization complete ---
2025-10-29 00:54:54,662 - INFO - Created hash keys for 289 rows using 3 content columns
2025-10-29 00:54:54,662 - WARNING - No corrected schema file found for dataset 'FUELINST' at 'schemas/corrected/bmrs_fuelinst.json'.
2025-10-29 00:54:54,662 - WARNING - Could not find corrected schema for FUELINST. Using autodetect.
2025-10-29 00:54:55,173 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-10-22 00:00:00+00:00-2025-10-28 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
               ^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
               ^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/GB Power Market JJ/ingest_elexon_fixed.py", line 1899, in main
    load_job = client.load_table_from_dataframe(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/GB Power Market JJ/.venv/lib/python3.11/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/inner-cinema-476211-u9/jobs?uploadType=multipart: Provided Schema does not match Table inner-cinema-476211-u9:uk_energy_prod.bmrs_fuelinst. Cannot add fields (field: data)
2025-10-29 00:54:55,176 - INFO - ‚úÖ Ingestion run completed.
