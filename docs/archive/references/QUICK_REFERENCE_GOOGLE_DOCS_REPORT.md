# Quick Reference: Google Docs Report Generation

## üìÑ Report Access
**Direct Link**: https://docs.google.com/document/d/1S39H_9ZCqdfAUJrbzF-icUkwVMGivSPpbsOegcG4pVU/edit

## üöÄ Generate New Report

### Prerequisites
```bash
# Ensure token is valid (run if you get auth errors)
python refresh_token.py
```

### Generate Report
```bash
# Generate comprehensive 22-month analysis report
python generate_google_docs_report_simple.py
```

### Expected Output
```
‚úÖ Document created
‚úÖ Content written successfully
   Characters: 27,432
üìÑ Document URL: https://docs.google.com/document/d/...
```

## üìä Report Contents

### Executive Summary
- Analysis period: Jan 2024 - Oct 2025 (22 months)
- Key findings: ¬£126.63/MWh avg spread, 36.1% renewables
- 32,016 settlement periods analyzed

### Section 1: Bid-Offer Spread Analysis
- Mean spread: ¬£126.63/MWh (100% profitable)
- Seasonal patterns: Winter ¬£141/MWh, Autumn ¬£112/MWh
- Intraday peak: 03:00-05:00 (¬£131/MWh)
- Investment case: ¬£555k annual revenue (50MW/100MWh)

### Section 2: Generation Mix
- Renewable: 36.1% (Wind 26.8%, Solar 5.7%)
- Thermal: 63.5% (CCGT 30.9%, Nuclear 12.3%)
- Coal phase-out: 0.4%
- Shannon Diversity: 2.34 (high)

### Section 3: Demand Patterns
- Average: 26,107 MW
- Load factor: 72.5%
- Weekday/weekend: -14% difference
- Price-demand correlation: -0.128 (weak negative)

### Section 4: Predictive Analysis
- 30-day MA: ¬£139.76/MWh (upward trend)
- Volatility: ¬£24.12/MWh (low)
- 12-month forecast: ¬£138/MWh expected
- Bull/Base/Bear scenarios

### Section 5: Strategic Recommendations
- Optimal dispatch: Charge 13:00-15:00, Discharge 03:00-05:00
- Seasonal optimization strategies
- Revenue diversification: ¬£555k total (4 streams)
- Risk mitigation approaches
- Investment metrics: 11-14% IRR

### Appendix: Technical Methodology
- Data sources (bmrs_bod, bmrs_fuelinst, demand_outturn)
- Statistical methods (t-tests, correlation, time series)
- Validation procedures
- Reproducibility instructions

## üîß Troubleshooting

### Issue: "Reauthentication is needed"
```bash
# Solution: Refresh OAuth token
python refresh_token.py
# Follow browser authentication flow
# Then retry report generation
```

### Issue: "Index must be less than the end index"
```bash
# Solution: Use simplified version (already default)
python generate_google_docs_report_simple.py
# NOT: generate_google_docs_report.py (deprecated)
```

### Issue: "credentials.json not found"
```bash
# Solution: Token-based auth doesn't need credentials.json
# Use token.pickle (generated by refresh_token.py)
ls -la token.pickle  # Verify it exists
```

## üìù Next Steps After Generation

### 1. Format Document
- Apply Heading 1 to section titles (1., 2., 3., etc.)
- Apply Heading 2 to subsections
- Apply Heading 3 to sub-subsections

### 2. Add Charts
**Option A: Manual**
- Insert > Chart
- Link to data in Google Sheets
- Create charts for:
  - Seasonal spread pattern
  - Intraday spread pattern
  - Generation mix pie chart
  - Demand pattern line chart
  - Moving averages

**Option B: Automated** (Future Enhancement)
- Create charts in Google Sheets first
- Use Sheets API to generate charts
- Use Docs API to embed charts

### 3. Share Report
- Click "Share" button
- Add stakeholder emails
- Set permissions (Viewer/Commenter/Editor)
- Send link

### 4. Export PDF
- File > Download > PDF Document (.pdf)
- Choose page orientation (Portrait recommended)
- Include page numbers
- Save for distribution

## üìö Related Documentation

- **[GOOGLE_DOCS_REPORT_SUMMARY.md](GOOGLE_DOCS_REPORT_SUMMARY.md)** - Complete documentation
- **[ENHANCED_ANALYSIS_RESULTS.md](ENHANCED_ANALYSIS_RESULTS.md)** - Detailed statistical results
- **[STATISTICAL_ANALYSIS_GUIDE.md](STATISTICAL_ANALYSIS_GUIDE.md)** - Analysis methodology
- **[README.md](README.md)** - Project overview

## üîê Authentication Details

### OAuth Flow
1. User runs `refresh_token.py`
2. Browser opens for Google authentication
3. User grants permissions (Sheets, Drive, Docs)
4. Token saved to `token.pickle`
5. Token auto-refreshes when expired (in scripts)

### Scopes Required
- `https://www.googleapis.com/auth/spreadsheets`
- `https://www.googleapis.com/auth/drive`
- `https://www.googleapis.com/auth/documents`

### Token Lifecycle
- Initial grant: Manual via browser
- Refresh: Automatic in scripts
- Expiration: ~1 hour (access token)
- Refresh token: Long-lived (until revoked)

## üí° Tips

1. **Token Refresh**: If you haven't used Google APIs in a while, refresh token first
2. **Script Version**: Always use `generate_google_docs_report_simple.py` (not original version)
3. **Content Length**: Report is 27,432 characters - stays well under Google Docs limits
4. **Formatting**: Plain text inserted - apply styles manually for best control
5. **Updates**: To regenerate with new data, run enhanced_statistical_analysis.py first, then report generator
6. **Backup**: Download as PDF periodically as backup

## üéØ Quick Commands

```bash
# Full workflow from scratch
python enhanced_statistical_analysis.py      # Run analysis (if new data)
python refresh_token.py                      # Refresh auth (if needed)
python generate_google_docs_report_simple.py # Generate report
open "https://docs.google.com/document/d/1S39H_9ZCqdfAUJrbzF-icUkwVMGivSPpbsOegcG4pVU/edit"
```

## üìä Report Statistics

- **Total Characters**: 27,432
- **Sections**: 5 main + Executive Summary + Appendix
- **Analysis Period**: 22 months (666 days)
- **Settlement Periods**: 32,016
- **Data Records**: 391M+ analyzed
- **Generation Time**: ~5 seconds
- **File Size**: ~27 KB (text only)

## üÜò Support

For issues:
1. Check [GOOGLE_DOCS_REPORT_SUMMARY.md](GOOGLE_DOCS_REPORT_SUMMARY.md) - Lessons Learned section
2. Review [DOCUMENTATION_INDEX.md](DOCUMENTATION_INDEX.md) - Complete documentation index
3. Check error messages - usually auth-related (run refresh_token.py)

---

**Last Updated**: 31 October 2025  
**Script Version**: generate_google_docs_report_simple.py (v1.0)  
**Status**: ‚úÖ Production Ready
