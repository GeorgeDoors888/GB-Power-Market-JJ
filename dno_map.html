<!DOCTYPE html>
<html>

<head>
    <title>DNO License Areas Map</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 100vh;
        }
    </style>
</head>

<body>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
    <script>
        // Initialize the map centered on the UK
        var map = L.map('map').setView([54.5, -2.5], 6);

        // Add a base map layer (OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to get a color based on the DNO Name
        function getColor(dnoName) {
            // Simple hash function to get a color for a string
            var hash = 0;
            for (var i = 0; i < dnoName.length; i++) {
                hash = dnoName.charCodeAt(i) + ((hash << 5) - hash);
            }
            var color = '#';
            for (var i = 0; i < 3; i++) {
                var value = (hash >> (i * 8)) & 0xFF;
                color += ('00' + value.toString(16)).substr(-2);
            }
            return color;
        }

        // Load the DNO license areas GeoJSON file
        var geojsonLayer = new L.GeoJSON.AJAX("system_regulatory/gis/dno_license_areas_20200506_simplified.geojson", {
            style: function (feature) {
                return {
                    color: getColor(feature.properties.LongName),
                    weight: 2,
                    opacity: 0.8,
                    fillOpacity: 0.5
                };
            },
            onEachFeature: function (feature, layer) {
                // Add a popup with the DNO information
                if (feature.properties) {
                    layer.bindPopup(
                        "<strong>DNO:</strong> " + feature.properties.LongName + "<br>" +
                        "<strong>ID:</strong> " + feature.properties.ID
                    );
                }
            }
        }).addTo(map);
    </script>

</body>

</html>