â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‰ APPS SCRIPT FULLY INTEGRATED - QUICK REFERENCE              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“ FILE: /home/george/GB-Power-Market-JJ/Code.gs              â”‚
â”‚  ğŸ“Š SIZE: 828 lines                                             â”‚
â”‚  ğŸ”§ FUNCTIONS: 10 total                                          â”‚
â”‚  ğŸ“¦ FEATURES: 3 major systems                                    â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ—ºï¸  DNO MAP TOOLS                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… createDNOMap()                                              â”‚
â”‚     â†’ Interactive UK DNO boundaries (GeoJSON from GitHub)       â”‚
â”‚     â†’ Menu: ğŸ—ºï¸ DNO Map â†’ View Interactive Map                 â”‚
â”‚                                                                 â”‚
â”‚  âœ… createDNOMapWithSites()                                     â”‚
â”‚     â†’ Map + battery site marker (geocoded from postcode)       â”‚
â”‚     â†’ Menu: ğŸ—ºï¸ DNO Map â†’ View Map with Site Markers           â”‚
â”‚                                                                 â”‚
â”‚  âœ… embedMapInSheet()                                           â”‚
â”‚     â†’ Upload to Drive + embed via IMAGE() formula              â”‚
â”‚     â†’ Menu: ğŸ—ºï¸ DNO Map â†’ Embed Map in DNO Sheet               â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”‹ BESS TOOLS                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… generateHHDataDirect()                                      â”‚
â”‚     â†’ Reads B17-B19 (Min/Avg/Max kW)                           â”‚
â”‚     â†’ Calls Python webhook or shows command                    â”‚
â”‚     â†’ Generates 17,520 half-hourly demand values               â”‚
â”‚     â†’ Menu: ğŸ”‹ BESS Tools â†’ ğŸ“Š Generate HH Data               â”‚
â”‚                                                                 â”‚
â”‚  âœ… manualRefreshDno()                                          â”‚
â”‚     â†’ Reads A6 (postcode) or B6 (MPAN)                         â”‚
â”‚     â†’ Geocodes via postcodes.io                                â”‚
â”‚     â†’ Maps to MPAN via coordinatesToMpan()                     â”‚
â”‚     â†’ Calls Python webhook for BigQuery lookup                 â”‚
â”‚     â†’ Writes DNO info to C6-H6, rates to row 9                 â”‚
â”‚     â†’ Menu: ğŸ”‹ BESS Tools â†’ ğŸ”„ Refresh DNO Data               â”‚
â”‚                                                                 â”‚
â”‚  âœ… calculatePPAAnalysis()                                      â”‚
â”‚     â†’ Shows Python command for battery arbitrage               â”‚
â”‚     â†’ Menu: ğŸ”‹ BESS Tools â†’ ğŸ’° Calculate PPA Analysis         â”‚
â”‚                                                                 â”‚
â”‚  âœ… showHHDataStatus()                                          â”‚
â”‚     â†’ Validates HH Data sheet                                  â”‚
â”‚     â†’ Shows row count, date range, statistics                  â”‚
â”‚     â†’ Menu: ğŸ”‹ BESS Tools â†’ ğŸ“ˆ Show HH Data Status            â”‚
â”‚                                                                 â”‚
â”‚  âœ… coordinatesToMpan(lat, lng)                                 â”‚
â”‚     â†’ Internal: Maps lat/lng to MPAN ID                        â”‚
â”‚     â†’ 14 UK regions defined                                    â”‚
â”‚                                                                 â”‚
â”‚  âœ… onEdit(e)                                                   â”‚
â”‚     â†’ Auto-trigger: Detects A6/B6 edits on BESS sheet         â”‚
â”‚     â†’ Waits 1.5s then calls manualRefreshDno()                â”‚
â”‚     â†’ Requires manual trigger setup in Apps Script             â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸš€ DEPLOYMENT STATUS                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Deployment ID: AKfycbxwFCjNeh7YRiO46aSceM5D03XFa11dPosYs...   â”‚
â”‚  Version: 3 (8 Dec 2025, 22:31)                                â”‚
â”‚  Status: âœ… Live and deployed                                   â”‚
â”‚  Web App: https://script.google.com/macros/s/AKfyc...          â”‚
â”‚  Library: https://script.google.com/macros/library/d/1zwD...   â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š TARGET SPREADSHEET                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  URL: https://docs.google.com/spreadsheets/d/12jY0d4jzD6lXF... â”‚
â”‚  Title: GB Energy Dashboard                                    â”‚
â”‚  Key Sheets: BESS, DNO, HH Data, Dashboard                     â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš¡ USAGE                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1ï¸âƒ£  DNO LOOKUP:                                               â”‚
â”‚     â€¢ Enter postcode in A6 (e.g., "SW1A 1AA")                  â”‚
â”‚     â€¢ Click: ğŸ”‹ BESS Tools â†’ Refresh DNO Data                 â”‚
â”‚     â€¢ DNO info appears in C6-H6 + rates in row 9               â”‚
â”‚                                                                 â”‚
â”‚  2ï¸âƒ£  GENERATE HH DATA:                                         â”‚
â”‚     â€¢ Enter Min/Avg/Max kW in B17-B19                          â”‚
â”‚     â€¢ Click: ğŸ”‹ BESS Tools â†’ Generate HH Data                 â”‚
â”‚     â€¢ 17,520 rows created in "HH Data" sheet                   â”‚
â”‚                                                                 â”‚
â”‚  3ï¸âƒ£  VIEW DNO MAP:                                             â”‚
â”‚     â€¢ Click: ğŸ—ºï¸ DNO Map â†’ View Interactive Map                â”‚
â”‚     â€¢ Hover regions, click to zoom                             â”‚
â”‚     â€¢ Or: View Map with Site Markers (needs postcode in A6)    â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ SETUP STEPS                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Step 1: Copy Code                                             â”‚
â”‚    cp /home/george/GB-Power-Market-JJ/Code.gs [clipboard]     â”‚
â”‚                                                                 â”‚
â”‚  Step 2: Open Spreadsheet                                      â”‚
â”‚    https://docs.google.com/spreadsheets/d/12jY0d4jzD6lXF...   â”‚
â”‚                                                                 â”‚
â”‚  Step 3: Paste into Apps Script                                â”‚
â”‚    Extensions â†’ Apps Script â†’ Paste â†’ Save                     â”‚
â”‚                                                                 â”‚
â”‚  Step 4: Refresh Spreadsheet                                   â”‚
â”‚    Press F5 or Ctrl+R                                          â”‚
â”‚                                                                 â”‚
â”‚  Step 5: Check Menus Appear                                    â”‚
â”‚    Look for: ğŸ—ºï¸ DNO Map and ğŸ”‹ BESS Tools                    â”‚
â”‚                                                                 â”‚
â”‚  Step 6 (Optional): Enable Auto-Trigger                        â”‚
â”‚    Apps Script â†’ Triggers (clock icon) â†’ Add Trigger           â”‚
â”‚    Function: onEdit, Event: On edit                            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ› TROUBLESHOOTING                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âŒ "Menu doesn't appear"                                       â”‚
â”‚     â†’ Save code (Ctrl+S), refresh spreadsheet (F5)             â”‚
â”‚                                                                 â”‚
â”‚  âŒ "DNO lookup fails"                                          â”‚
â”‚     â†’ Check postcode format, run manual Python command         â”‚
â”‚                                                                 â”‚
â”‚  âŒ "Permission denied"                                         â”‚
â”‚     â†’ Run function from editor â†’ Review Permissions â†’ Allow    â”‚
â”‚                                                                 â”‚
â”‚  âŒ "Webhook not available"                                     â”‚
â”‚     â†’ Apps Script shows Python command to run manually         â”‚
â”‚     â†’ Start webhook: python3 dno_webhook_server.py             â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”— RELATED FILES                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“„ APPS_SCRIPT_INTEGRATED.md    - Full integration guide      â”‚
â”‚  ğŸ“„ Code.gs                      - Main Apps Script (828 lines)â”‚
â”‚  ğŸ“„ dno_lookup_python.py         - Python DNO backend          â”‚
â”‚  ğŸ“„ generate_hh_profile.py       - Python HH generator         â”‚
â”‚  ğŸ“ gb_power_map_deployment/     - GeoJSON boundaries          â”‚
â”‚  ğŸ“ bg-sparklines-clasp/         - Sparkline version (900+)    â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ SUPPORT                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Repository: https://github.com/GeorgeDoors888/GB-Power-Mark...â”‚
â”‚  Maintainer: George Major (george@upowerenergy.uk)             â”‚
â”‚  Status: âœ… Production (Dec 2025)                               â”‚
â”‚  Last Updated: 8 Dec 2025, 23:00                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
