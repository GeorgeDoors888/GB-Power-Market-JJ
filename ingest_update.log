2025-09-23 12:23:38,903 - INFO - BigQuery dataset 'elexon_data_landing_zone' exists.
All Datasets:   0%|          | 0/65 [00:00<?, ?it/s]Dataset: B1610:   0%|          | 0/65 [00:00<?, ?it/s]
Windows for B1610:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching B1610 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: B1610:   0%|          | 0/65 [00:00<?, ?it/s]
Fetching B1610 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                      
                                                                                                     [ADataset: B1610:   0%|          | 0/65 [00:00<?, ?it/s]
Fetching B1610 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching B1610 from 2025-09-22 to 2025-09-23: : 1it [00:00,  6.39it/s]                               [A
                                                                      [ADataset: B1610:   2%|‚ñè         | 1/65 [00:00<00:10,  6.36it/s]Dataset: B1630:   2%|‚ñè         | 1/65 [00:00<00:10,  6.36it/s]2025-09-23 12:23:38,926 - INFO - üåê Fetching BMRS dataset=B1610 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:23:39,082 - INFO - No data returned for B1610 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for B1630:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching B1630 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: B1630:   2%|‚ñè         | 1/65 [00:00<00:10,  6.36it/s]
Fetching B1630 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: B1630:   2%|‚ñè         | 1/65 [00:00<00:10,  6.36it/s]
Fetching B1630 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching B1630 from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  5.08it/s][A
                                                                                             [ADataset: B1630:   3%|‚ñé         | 2/65 [00:00<00:11,  5.53it/s]Dataset: B1770:   3%|‚ñé         | 2/65 [00:00<00:11,  5.53it/s]2025-09-23 12:23:39,083 - INFO - üåê Fetching BMRS dataset=B1630 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:23:39,280 - INFO - No data returned for B1630 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for B1770:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching B1770 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: B1770:   3%|‚ñé         | 2/65 [00:00<00:11,  5.53it/s]
Fetching B1770 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: B1770:   3%|‚ñé         | 2/65 [00:00<00:11,  5.53it/s]
Fetching B1770 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]2025-09-23 12:23:39,281 - INFO - üåê Fetching BMRS dataset=B1770 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:23:39,379 - INFO - No data returned for B1770 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for BOALF:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:00<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                              
                                                                                     [ADataset: BOALF:   5%|‚ñç         | 3/65 [00:01<00:11,  5.53it/s]
Fetching BOALF from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A
Fetching BOALF from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:01<00:00,  1.16s/it][A
                                                                                             [ADataset: BOALF:   6%|‚ñå         | 4/65 [00:01<00:28,  2.16it/s]Dataset: BOD:   6%|‚ñå         | 4/65 [00:01<00:28,  2.16it/s]  2025-09-23 12:23:39,380 - INFO - üåê Fetching BMRS dataset=BOALF from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:23:39,899 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:23:39,904 - INFO - Converting column 'acceptanceTime' to pandas datetime (UTC)
2025-09-23 12:23:39,912 - INFO - --- Starting final sanitization for BQ load on DataFrame with 23 columns ---
2025-09-23 12:23:39,913 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:23:39,920 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:23:39,920 - INFO -  -> Converted integer column 'settlementPeriodFrom' to nullable Int64 based on schema.
2025-09-23 12:23:39,920 - INFO -  -> Converted integer column 'settlementPeriodTo' to nullable Int64 based on schema.
2025-09-23 12:23:39,921 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:23:39,921 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:23:39,921 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:23:39,922 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:23:39,922 - INFO -  -> Converted integer column 'acceptanceNumber' to nullable Int64 based on schema.
2025-09-23 12:23:39,926 - INFO -  -> Converted datetime column 'acceptanceTime' to timezone-naive.
2025-09-23 12:23:39,926 - INFO -  -> Forced object column 'amendmentFlag' to string.
2025-09-23 12:23:39,927 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:23:39,927 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:23:39,927 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:23:39,928 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:23:39,928 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:23:39,928 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:23:39,929 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:23:39,930 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:23:39,930 - INFO - --- Final sanitization complete ---
2025-09-23 12:23:40,206 - INFO - Created hash keys for 14252 rows using 17 content columns
2025-09-23 12:23:40,207 - INFO - Loaded corrected schema for BOALF
2025-09-23 12:23:40,357 - ERROR - ‚ùå Failed to load data for BOALF in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray

Windows for BOD:   0%|          | 0/24.0 [00:00<?, ?it/s][A
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:00<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:00<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:02<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:06<?, ?it/s][A                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:06<?, ?it/s][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                    [ADataset: BOD:   6%|‚ñå         | 4/65 [00:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   0%|          | 0/24.0 [00:06<?, ?it/s][A
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:06<02:34,  6.70s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:06<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:06<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:09<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:12<02:34,  6.70s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:12<02:34,  6.70s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [A2025-09-23 12:23:40,543 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 00:00:00+00:00 to=2025-09-22 01:00:00+00:00
2025-09-23 12:23:43,140 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:23:43,203 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:23:43,205 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:23:43,211 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:23:43,212 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:23:43,219 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:23:43,220 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:23:43,227 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:23:43,227 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:23:43,228 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:23:43,239 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:23:43,250 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:23:43,256 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:23:43,265 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:23:43,268 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:23:43,270 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:23:43,272 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:23:43,274 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:23:43,277 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:23:43,290 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:23:43,290 - INFO - --- Final sanitization complete ---
2025-09-23 12:23:46,617 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:23:46,635 - INFO - Loaded corrected schema for BOD
2025-09-23 12:23:47,238 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 00:00:00+00:00-2025-09-22 01:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:23:47,241 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 01:00:00+00:00 to=2025-09-22 02:00:00+00:00
2025-09-23 12:23:49,815 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:23:49,881 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:23:49,885 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:23:49,891 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:23:49,892 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:23:49,898 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:23:49,899 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:23:49,906 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:23:49,907 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:23:49,908 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:23:49,918 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:23:49,930 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:23:49,937 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:23:49,944 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:23:49,946 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:23:49,949 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:23:49,951 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:23:49,953 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:23:49,955 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:23:49,966 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:23:49,966 - INFO - --- Final sanitization complete ---
2025-09-23 12:23:52,558 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:23:52,572 - INFO - Loaded corrected schema for BOD
2025-09-23 12:23:53,291 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 01:00:00+00:00-2025-09-22 02:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [00:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   4%|‚ñç         | 1/24.0 [00:12<02:34,  6.70s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:12<02:19,  6.32s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:12<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:12<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:15<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:17<02:19,  6.32s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:17<02:19,  6.32s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:20<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:   8%|‚ñä         | 2/24.0 [00:18<02:19,  6.32s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:18<02:07,  6.07s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:18<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:20<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:18<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:22<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:25<02:07,  6.07s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:25<02:07,  6.07s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [A
2025-09-23 12:23:53,294 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 02:00:00+00:00 to=2025-09-22 03:00:00+00:00
2025-09-23 12:23:55,948 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:23:56,008 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:23:56,010 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:23:56,016 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:23:56,016 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:23:56,023 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:23:56,024 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:23:56,030 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:23:56,031 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:23:56,031 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:23:56,041 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:23:56,053 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:23:56,059 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:23:56,066 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:23:56,069 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:23:56,071 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:23:56,073 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:23:56,076 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:23:56,078 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:23:56,089 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:23:56,089 - INFO - --- Final sanitization complete ---
2025-09-23 12:23:58,509 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:23:58,519 - INFO - Loaded corrected schema for BOD
2025-09-23 12:23:59,066 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 02:00:00+00:00-2025-09-22 03:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:23:59,069 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 03:00:00+00:00 to=2025-09-22 04:00:00+00:00
2025-09-23 12:24:03,020 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:03,084 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:03,087 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:03,093 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:03,094 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:03,100 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:03,101 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:03,107 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:03,108 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:03,109 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:03,119 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:03,131 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:03,137 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:03,145 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:03,147 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:03,150 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:03,152 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:03,154 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:03,156 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:03,167 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:03,167 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:06,201 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:06,216 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:06,774 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 03:00:00+00:00-2025-09-22 04:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [00:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  12%|‚ñà‚ñé        | 3/24.0 [00:26<02:07,  6.07s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:26<02:14,  6.72s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:26<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:26<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:29<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:33<02:14,  6.72s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:33<02:14,  6.72s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:36<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  17%|‚ñà‚ñã        | 4/24.0 [00:34<02:14,  6.72s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:34<02:19,  7.35s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:34<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:36<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:34<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:39<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:43<02:19,  7.35s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:43<02:19,  7.35s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [A
2025-09-23 12:24:06,782 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 04:00:00+00:00 to=2025-09-22 05:00:00+00:00
2025-09-23 12:24:09,852 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:09,921 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:09,924 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:09,929 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:09,931 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:09,937 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:09,938 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:09,945 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:09,947 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:09,948 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:09,960 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:09,972 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:09,988 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:10,007 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:10,029 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:10,036 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:10,042 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:10,046 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:10,050 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:10,109 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:10,110 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:14,353 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:14,375 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:15,233 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 04:00:00+00:00-2025-09-22 05:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:24:15,238 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 05:00:00+00:00 to=2025-09-22 06:00:00+00:00
2025-09-23 12:24:19,683 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:19,767 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:19,772 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:19,780 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:19,781 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:19,788 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:19,790 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:19,798 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:19,800 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:19,800 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:19,815 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:19,829 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:19,838 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:19,848 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:19,851 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:19,854 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:19,857 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:19,861 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:19,864 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:19,880 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:19,881 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:24,411 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:24,430 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:25,023 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 05:00:00+00:00-2025-09-22 06:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [00:46<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  21%|‚ñà‚ñà        | 5/24.0 [00:44<02:19,  7.35s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:44<02:27,  8.18s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:44<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:46<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:44<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:49<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:48<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:51<02:27,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:51<02:27,  8.18s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:54<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  25%|‚ñà‚ñà‚ñå       | 6/24.0 [00:52<02:27,  8.18s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:52<02:19,  8.18s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:52<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:54<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:52<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:56<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [00:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:57<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:59<02:19,  8.18s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [00:59<02:19,  8.18s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [A
2025-09-23 12:24:25,026 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 06:00:00+00:00 to=2025-09-22 07:00:00+00:00
2025-09-23 12:24:28,778 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:28,850 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:28,852 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:28,858 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:28,862 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:28,869 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:28,870 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:28,877 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:28,878 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:28,879 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:28,891 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:28,905 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:28,913 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:28,921 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:28,925 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:28,928 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:28,931 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:28,933 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:28,936 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:28,948 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:28,948 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:32,328 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:32,362 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:33,200 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 06:00:00+00:00-2025-09-22 07:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:24:33,212 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 07:00:00+00:00 to=2025-09-22 08:00:00+00:00
2025-09-23 12:24:37,429 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:37,498 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:37,501 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:37,507 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:37,507 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:37,515 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:37,516 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:37,523 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:37,524 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:37,525 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:37,536 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:37,548 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:37,554 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:37,562 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:37,564 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:37,566 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:37,569 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:37,571 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:37,573 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:37,584 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:37,584 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:40,231 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:40,248 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:40,781 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 07:00:00+00:00-2025-09-22 08:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  29%|‚ñà‚ñà‚ñâ       | 7/24.0 [01:00<02:19,  8.18s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:00<02:07,  7.99s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:00<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:00<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:02<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:03<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:05<02:07,  7.99s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:05<02:07,  7.99s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  33%|‚ñà‚ñà‚ñà‚ñé      | 8/24.0 [01:06<02:07,  7.99s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:06<01:50,  7.38s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:06<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:07<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:06<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:08<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:11<01:50,  7.38s/it][A                                                            
                                                                                            [ADataset: BOD:   6%|‚ñå         | 4/65 [01:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:11<01:50,  7.38s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                            [A
2025-09-23 12:24:40,784 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 08:00:00+00:00 to=2025-09-22 09:00:00+00:00
2025-09-23 12:24:43,457 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:43,513 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:43,515 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:43,521 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:43,522 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:43,528 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:43,529 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:43,535 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:43,536 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:43,536 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:43,547 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:43,559 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:43,565 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:43,571 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:43,573 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:43,576 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:43,578 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:43,580 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:43,582 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:43,593 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:43,593 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:46,266 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:46,277 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:46,831 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 08:00:00+00:00-2025-09-22 09:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:24:46,835 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 09:00:00+00:00 to=2025-09-22 10:00:00+00:00
2025-09-23 12:24:49,391 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:49,454 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:49,457 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:49,462 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:49,463 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:49,469 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:49,470 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:49,476 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:49,477 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:49,478 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:49,487 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:49,498 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:49,504 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:49,511 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:49,514 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:49,516 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:49,518 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:49,520 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:49,523 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:49,534 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:49,534 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:52,122 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:52,137 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:52,732 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 09:00:00+00:00-2025-09-22 10:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  38%|‚ñà‚ñà‚ñà‚ñä      | 9/24.0 [01:12<01:50,  7.38s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:12<01:36,  6.92s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:12<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:13<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:12<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:15<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:17<01:36,  6.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:17<01:36,  6.92s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 10/24.0 [01:18<01:36,  6.92s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:18<01:26,  6.68s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:18<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:18<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:21<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:25<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:23<01:26,  6.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:25<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:23<01:26,  6.68s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:24:52,735 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 10:00:00+00:00 to=2025-09-22 11:00:00+00:00
2025-09-23 12:24:55,592 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:24:55,661 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:24:55,664 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:24:55,670 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:24:55,671 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:24:55,677 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:24:55,678 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:24:55,685 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:24:55,686 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:24:55,687 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:24:55,697 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:24:55,708 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:24:55,714 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:24:55,721 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:24:55,724 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:24:55,726 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:24:55,729 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:24:55,731 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:24:55,733 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:24:55,745 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:24:55,745 - INFO - --- Final sanitization complete ---
2025-09-23 12:24:58,296 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:24:58,307 - INFO - Loaded corrected schema for BOD
2025-09-23 12:24:58,855 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 10:00:00+00:00-2025-09-22 11:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:24:58,858 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 11:00:00+00:00 to=2025-09-22 12:00:00+00:00
2025-09-23 12:25:01,549 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:01,637 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:01,641 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:01,649 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:01,650 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:01,657 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:01,661 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:01,669 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:01,670 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:01,671 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:01,682 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:01,693 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:01,699 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:01,706 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:01,710 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:01,712 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:01,714 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:01,717 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:01,719 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:01,732 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:01,733 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:04,319 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:04,333 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:04,882 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 11:00:00+00:00-2025-09-22 12:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:25<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 11/24.0 [01:24<01:26,  6.68s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:24<01:17,  6.48s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:24<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:25<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:24<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:28<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:26<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:29<01:17,  6.48s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:29<01:17,  6.48s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 12/24.0 [01:29<01:17,  6.48s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:29<01:08,  6.21s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:29<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:31<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:29<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:32<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:36<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:34<01:08,  6.21s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:36<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:34<01:08,  6.21s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:25:04,884 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 12:00:00+00:00 to=2025-09-22 13:00:00+00:00
2025-09-23 12:25:07,301 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:07,359 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:07,361 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:07,366 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:07,367 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:07,374 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:07,375 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:07,381 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:07,382 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:07,382 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:07,393 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:07,403 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:07,409 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:07,415 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:07,418 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:07,420 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:07,422 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:07,424 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:07,426 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:07,436 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:07,436 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:09,756 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:09,768 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:10,459 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 12:00:00+00:00-2025-09-22 13:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:25:10,462 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 13:00:00+00:00 to=2025-09-22 14:00:00+00:00
2025-09-23 12:25:12,944 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:13,000 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:13,003 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:13,009 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:13,009 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:13,015 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:13,016 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:13,022 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:13,023 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:13,024 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:13,033 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:13,044 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:13,051 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:13,058 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:13,061 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:13,063 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:13,065 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:13,068 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:13,070 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:13,080 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:13,080 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:15,414 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:15,424 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:15,958 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 13:00:00+00:00-2025-09-22 14:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:37<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 13/24.0 [01:35<01:08,  6.21s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:35<00:59,  5.99s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:35<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:37<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:35<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:38<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:42<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:40<00:59,  5.99s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:42<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:40<00:59,  5.99s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:42<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 14/24.0 [01:41<00:59,  5.99s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:41<00:53,  5.92s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:41<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:42<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:41<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:45<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:43<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:47<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:46<00:53,  5.92s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:47<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:46<00:53,  5.92s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:25:15,960 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 14:00:00+00:00 to=2025-09-22 15:00:00+00:00
2025-09-23 12:25:18,785 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:18,844 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:18,846 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:18,851 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:18,851 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:18,857 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:18,858 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:18,864 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:18,865 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:18,866 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:18,876 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:18,886 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:18,891 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:18,898 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:18,900 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:18,902 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:18,905 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:18,907 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:18,910 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:18,920 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:18,920 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:21,189 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:21,199 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:21,717 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 14:00:00+00:00-2025-09-22 15:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:25:21,720 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 15:00:00+00:00 to=2025-09-22 16:00:00+00:00
2025-09-23 12:25:24,188 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:24,246 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:24,248 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:24,254 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:24,255 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:24,261 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:24,262 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:24,269 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:24,270 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:24,270 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:24,281 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:24,291 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:24,297 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:24,304 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:24,307 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:24,309 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:24,311 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:24,313 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:24,315 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:24,326 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:24,326 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:26,593 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:26,604 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:27,122 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 15:00:00+00:00-2025-09-22 16:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:48<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 15/24.0 [01:46<00:53,  5.92s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:46<00:46,  5.77s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:46<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:48<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:46<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:50<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:49<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:51<00:46,  5.77s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:51<00:46,  5.77s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 16/24.0 [01:52<00:46,  5.77s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:52<00:39,  5.68s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:52<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:53<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:52<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:54<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:55<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:56<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:55<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:57<00:39,  5.68s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:58<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:57<00:39,  5.68s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:25:27,125 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 16:00:00+00:00 to=2025-09-22 17:00:00+00:00
2025-09-23 12:25:29,665 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:29,722 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:29,725 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:29,730 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:29,730 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:29,737 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:29,737 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:29,744 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:29,744 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:29,745 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:29,755 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:29,765 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:29,771 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:29,778 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:29,780 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:29,782 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:29,784 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:29,787 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:29,789 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:29,799 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:29,799 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:32,062 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:32,072 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:32,599 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 16:00:00+00:00-2025-09-22 17:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:25:32,602 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 17:00:00+00:00 to=2025-09-22 18:00:00+00:00
2025-09-23 12:25:35,407 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:35,471 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:35,474 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:35,479 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:35,479 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:35,485 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:35,486 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:35,492 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:35,493 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:35,493 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:35,503 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:35,513 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:35,519 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:35,525 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:35,528 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:35,530 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:35,532 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:35,534 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:35,536 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:35,546 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:35,546 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:37,798 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:37,810 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:38,333 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 17:00:00+00:00-2025-09-22 18:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [01:59<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 17/24.0 [01:57<00:39,  5.68s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [01:57<00:34,  5.70s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [01:57<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [01:59<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [01:57<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:01<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:02<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:00<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:02<00:34,  5.70s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:02<00:34,  5.70s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 18/24.0 [02:03<00:34,  5.70s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:03<00:28,  5.64s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:03<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:04<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:03<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:06<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:07<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:07<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:07<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:08<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:07<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:09<00:28,  5.64s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:10<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:09<00:28,  5.64s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:25:38,336 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 18:00:00+00:00 to=2025-09-22 19:00:00+00:00
2025-09-23 12:25:40,833 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:40,890 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:40,892 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:40,897 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:40,898 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:40,904 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:40,905 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:40,911 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:40,912 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:40,912 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:40,922 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:40,932 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:40,938 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:40,944 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:40,947 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:40,949 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:40,951 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:40,953 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:40,955 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:40,965 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:40,966 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:43,255 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:43,265 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:43,846 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 18:00:00+00:00-2025-09-22 19:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:25:43,849 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 19:00:00+00:00 to=2025-09-22 20:00:00+00:00
2025-09-23 12:25:47,406 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:47,468 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:47,470 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:47,476 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:47,477 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:47,484 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:47,485 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:47,492 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:47,493 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:47,493 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:47,505 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:47,517 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:47,524 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:47,532 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:47,535 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:47,538 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:47,541 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:47,544 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:47,547 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:47,559 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:47,559 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:49,834 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:49,846 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:50,430 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 19:00:00+00:00-2025-09-22 20:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [02:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 19/24.0 [02:09<00:28,  5.64s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:09<00:23,  5.93s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:09<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:11<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:09<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:14<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:12<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:15<00:23,  5.93s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:16<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:15<00:23,  5.93s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 20/24.0 [02:15<00:23,  5.93s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:15<00:17,  5.86s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:15<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:17<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:15<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:17<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:19<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:18<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:22<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:21<00:17,  5.86s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:23<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:21<00:17,  5.86s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:25:50,438 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 20:00:00+00:00 to=2025-09-22 21:00:00+00:00
2025-09-23 12:25:53,091 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:53,148 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:53,150 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:53,155 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:53,156 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:53,162 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:53,163 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:53,169 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:53,170 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:53,171 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:53,181 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:53,192 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:53,197 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:53,204 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:53,206 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:53,208 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:53,210 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:53,212 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:53,215 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:53,226 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:53,226 - INFO - --- Final sanitization complete ---
2025-09-23 12:25:55,591 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:25:55,602 - INFO - Loaded corrected schema for BOD
2025-09-23 12:25:56,137 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 20:00:00+00:00-2025-09-22 21:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:25:56,140 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 21:00:00+00:00 to=2025-09-22 22:00:00+00:00
2025-09-23 12:25:58,494 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:25:58,552 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:25:58,555 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:25:58,560 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:25:58,561 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:25:58,567 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:25:58,568 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:25:58,574 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:25:58,575 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:25:58,576 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:25:58,586 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:25:58,596 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:25:58,601 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:25:58,607 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:25:58,610 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:25:58,612 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:25:58,614 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:25:58,617 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:25:58,619 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:25:58,629 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:25:58,629 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:01,871 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:26:02,037 - INFO - Loaded corrected schema for BOD
2025-09-23 12:26:03,585 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 21:00:00+00:00-2025-09-22 22:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [02:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 21/24.0 [02:23<00:17,  5.86s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:23<00:12,  6.34s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:23<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:24<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:23<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:27<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:25<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:29<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:28<00:12,  6.34s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:29<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:28<00:12,  6.34s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-22:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 22/24.0 [02:28<00:12,  6.34s/it][A
Fetching BOD from 2025-09-22 to 2025-09-22:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:28<00:06,  6.16s/it][A
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:28<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:30<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:28<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:34<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:35<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:33<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:37<00:06,  6.16s/it][A                                                            
                                                                                             [ADataset: BOD:   6%|‚ñå         | 4/65 [02:39<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:37<00:06,  6.16s/it][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                             [A
2025-09-23 12:26:03,589 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 22:00:00+00:00 to=2025-09-22 23:00:00+00:00
2025-09-23 12:26:06,374 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:06,440 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:26:06,443 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:06,448 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:06,449 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:06,455 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:26:06,456 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:26:06,462 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:26:06,463 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:26:06,464 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:26:06,474 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:26:06,485 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:26:06,490 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:06,497 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:06,499 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:06,502 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:06,504 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:06,506 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:06,508 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:06,519 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:06,519 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:08,798 - INFO - Created hash keys for 165516 rows using 12 content columns
2025-09-23 12:26:08,810 - INFO - Loaded corrected schema for BOD
2025-09-23 12:26:09,332 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 22:00:00+00:00-2025-09-22 23:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
2025-09-23 12:26:09,334 - INFO - üåê Fetching BMRS dataset=BOD from=2025-09-22 23:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:13,915 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:14,015 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:26:14,021 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:14,028 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:14,029 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:14,039 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:26:14,040 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:26:14,051 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:26:14,052 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:26:14,053 - INFO -  -> Converted integer column 'pairId' to nullable Int64 based on schema.
2025-09-23 12:26:14,068 - INFO -  -> Converted float column 'offer' to nullable Float64 based on schema.
2025-09-23 12:26:14,084 - INFO -  -> Converted float column 'bid' to nullable Float64 based on schema.
2025-09-23 12:26:14,093 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:14,105 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:14,109 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:14,112 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:14,116 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:14,120 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:14,123 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:14,141 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:14,141 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:18,235 - INFO - Created hash keys for 258734 rows using 12 content columns
2025-09-23 12:26:18,261 - INFO - Loaded corrected schema for BOD
2025-09-23 12:26:19,467 - ERROR - ‚ùå Failed to load data for BOD in window 2025-09-22 23:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArrayDataset: BOD:   6%|‚ñå         | 4/65 [02:40<00:28,  2.16it/s]
Fetching BOD from 2025-09-22 to 2025-09-23:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 23/24.0 [02:38<00:06,  6.16s/it][A
Fetching BOD from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 24/24.0 [02:38<00:00,  7.35s/it][A
                                                                                             [ADataset: BOD:   8%|‚ñä         | 5/65 [02:40<49:28, 49.48s/it]Dataset: COSTS:   8%|‚ñä         | 5/65 [02:40<49:28, 49.48s/it]

Windows for COSTS:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:40<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py:600: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  item["_ingested_utc"] = datetime.utcnow().isoformat()
                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                     [ADataset: COSTS:   8%|‚ñä         | 5/65 [02:41<49:28, 49.48s/it]
Fetching COSTS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A
Fetching COSTS from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:01<00:00,  1.32s/it][A
                                                                                             [ADataset: COSTS:   9%|‚ñâ         | 6/65 [02:41<34:08, 34.72s/it]Dataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:41<34:08, 34.72s/it]2025-09-23 12:26:19,475 - INFO - üåê Fetching BMRS dataset=COSTS from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:19,937 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:19,940 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:19,940 - INFO - Converting column 'createdDateTime' to pandas datetime (UTC)
2025-09-23 12:26:19,942 - INFO - --- Starting final sanitization for BQ load on DataFrame with 28 columns ---
2025-09-23 12:26:19,943 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:19,944 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:19,944 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:19,944 - INFO -  -> Converted datetime column 'createdDateTime' to timezone-naive.
2025-09-23 12:26:19,944 - INFO -  -> Converted float column 'systemSellPrice' to nullable Float64 based on schema.
2025-09-23 12:26:19,945 - INFO -  -> Converted float column 'systemBuyPrice' to nullable Float64 based on schema.
2025-09-23 12:26:19,945 - INFO -  -> Forced object column 'priceDerivationCode' to string.
2025-09-23 12:26:19,945 - INFO -  -> Converted float column 'reserveScarcityPrice' to nullable Float64 based on schema.
2025-09-23 12:26:19,946 - INFO -  -> Converted float column 'netImbalanceVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,946 - INFO -  -> Converted float column 'sellPriceAdjustment' to nullable Float64 based on schema.
2025-09-23 12:26:19,946 - INFO -  -> Converted float column 'buyPriceAdjustment' to nullable Float64 based on schema.
2025-09-23 12:26:19,946 - INFO -  -> Converted float column 'replacementPrice' to nullable Float64 based on schema.
2025-09-23 12:26:19,947 - INFO -  -> Converted float column 'replacementPriceReferenceVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,947 - INFO -  -> Converted float column 'totalAcceptedOfferVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,947 - INFO -  -> Converted float column 'totalAcceptedBidVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,947 - INFO -  -> Converted float column 'totalAdjustmentSellVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,948 - INFO -  -> Converted float column 'totalAdjustmentBuyVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,948 - INFO -  -> Converted float column 'totalSystemTaggedAcceptedOfferVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,948 - INFO -  -> Converted float column 'totalSystemTaggedAcceptedBidVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,948 - INFO -  -> Converted float column 'totalSystemTaggedAdjustmentSellVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,948 - INFO -  -> Converted float column 'totalSystemTaggedAdjustmentBuyVolume' to nullable Float64 based on schema.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:19,949 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:19,950 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:19,953 - INFO - Created hash keys for 72 rows using 22 content columns
2025-09-23 12:26:19,954 - INFO - Loaded corrected schema for COSTS
2025-09-23 12:26:20,791 - ERROR - ‚ùå Failed to load data for COSTS in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for DEMAND_FORECAST:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:41<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:42<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                               [ADataset: DEMAND_FORECAST:   9%|‚ñâ         | 6/65 [02:43<34:08, 34.72s/it]
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A
Fetching DEMAND_FORECAST from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:01<00:00,  1.18s/it][A
                                                                                                       [ADataset: DEMAND_FORECAST:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]Dataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]        2025-09-23 12:26:20,795 - INFO - üåê Fetching BMRS dataset=DEMAND_FORECAST from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:20,990 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/forecast/demand/total/day-ahead?from=2025-09-22&to=2025-09-23&format=json "HTTP/1.1 200 OK"
2025-09-23 12:26:20,992 - INFO - Successfully fetched 49 records for DEMAND_FORECAST from Insights API.
2025-09-23 12:26:20,993 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:20,994 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:20,994 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:20,995 - WARNING - No corrected schema file found for dataset 'DEMAND_FORECAST' at 'schemas/corrected/bmrs_demand_forecast.json'.
2025-09-23 12:26:20,995 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-09-23 12:26:20,996 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:20,996 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:20,996 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:20,997 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:20,997 - INFO -  -> Converted float column 'quantity' to nullable Float64.
2025-09-23 12:26:20,997 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:20,997 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:20,998 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:20,998 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:20,998 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:20,998 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:20,998 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:21,000 - INFO - Created hash keys for 49 rows using 5 content columns
2025-09-23 12:26:21,001 - WARNING - No corrected schema file found for dataset 'DEMAND_FORECAST' at 'schemas/corrected/bmrs_demand_forecast.json'.
2025-09-23 12:26:21,001 - WARNING - Could not find corrected schema for DEMAND_FORECAST. Using autodetect.
2025-09-23 12:26:21,973 - ERROR - ‚ùå Failed to load data for DEMAND_FORECAST in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for DISBSAD:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                       [ADataset: DISBSAD:  11%|‚ñà         | 7/65 [02:43<23:41, 24.51s/it]
Fetching DISBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching DISBSAD from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  6.98it/s][A
                                                                                               [ADataset: DISBSAD:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]Dataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]2025-09-23 12:26:21,974 - INFO - üåê Fetching BMRS dataset=DISBSAD from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:22,097 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:22,099 - INFO - --- Starting final sanitization for BQ load on DataFrame with 18 columns ---
2025-09-23 12:26:22,099 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:22,100 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:22,101 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:22,101 - INFO -  -> Converted integer column 'id' to nullable Int64 based on schema.
2025-09-23 12:26:22,102 - INFO -  -> Converted float column 'cost' to nullable Float64 based on schema.
2025-09-23 12:26:22,102 - INFO -  -> Converted float column 'volume' to nullable Float64 based on schema.
2025-09-23 12:26:22,102 - INFO -  -> Forced object column 'partyId' to string.
2025-09-23 12:26:22,102 - INFO -  -> Forced object column 'assetId' to string.
2025-09-23 12:26:22,103 - INFO -  -> Forced object column 'isTendered' to string.
2025-09-23 12:26:22,103 - INFO -  -> Forced object column 'service' to string.
2025-09-23 12:26:22,103 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:22,103 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:22,104 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:22,104 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:22,104 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:22,104 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:22,104 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:22,110 - INFO - Created hash keys for 254 rows using 12 content columns
2025-09-23 12:26:22,111 - INFO - Loaded corrected schema for DISBSAD
2025-09-23 12:26:22,116 - ERROR - ‚ùå Failed to load data for DISBSAD in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Could not convert 'False' with type str: tried to convert to boolean
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowInvalid: Could not convert 'False' with type str: tried to convert to boolean

Windows for FOU2T14D:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][AError converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                                 
                                                                                                        [ADataset: FOU2T14D:  12%|‚ñà‚ñè        | 8/65 [02:43<16:15, 17.12s/it]
Fetching FOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching FOU2T14D from 2025-09-22 to 2025-09-23: : 1it [00:00,  5.68it/s]                               [A
                                                                         [ADataset: FOU2T14D:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]Dataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]2025-09-23 12:26:22,118 - INFO - üåê Fetching BMRS dataset=FOU2T14D from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:22,277 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:22,278 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:22,279 - INFO - --- Starting final sanitization for BQ load on DataFrame with 16 columns ---
2025-09-23 12:26:22,279 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:22,280 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:22,280 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:22,281 - INFO -  -> Forced object column 'systemZone' to string.
2025-09-23 12:26:22,281 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:22,281 - INFO -  -> Forced object column 'forecastDateTimezone' to string.
2025-09-23 12:26:22,282 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:22,282 - INFO -  -> Forced object column 'biddingZone' to string.
2025-09-23 12:26:22,282 - INFO -  -> Forced object column 'interconnectorName' to string.
2025-09-23 12:26:22,282 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:22,282 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:22,283 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:22,283 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:22,283 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:22,283 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:22,283 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:22,288 - INFO - Created hash keys for 247 rows using 10 content columns
2025-09-23 12:26:22,289 - INFO - Loaded corrected schema for FOU2T14D
2025-09-23 12:26:22,292 - ERROR - ‚ùå Failed to load data for FOU2T14D in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray

Windows for FOU2T3YW:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:43<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                        [ADataset: FOU2T3YW:  14%|‚ñà‚ñç        | 9/65 [02:44<11:12, 12.00s/it]
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching FOU2T3YW from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.19it/s]                               [A
                                                                         [ADataset: FOU2T3YW:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]Dataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]    2025-09-23 12:26:22,294 - INFO - üåê Fetching BMRS dataset=FOU2T3YW from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:22,528 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:22,532 - INFO - --- Starting final sanitization for BQ load on DataFrame with 16 columns ---
2025-09-23 12:26:22,533 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:22,533 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:22,535 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:22,535 - INFO -  -> Forced object column 'systemZone' to string.
2025-09-23 12:26:22,536 - INFO -  -> Converted integer column 'calendarWeekNumber' to nullable Int64 based on schema.
2025-09-23 12:26:22,536 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:22,536 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:22,537 - INFO -  -> Forced object column 'biddingZone' to string.
2025-09-23 12:26:22,537 - INFO -  -> Forced object column 'interconnectorName' to string.
2025-09-23 12:26:22,537 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:22,538 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:22,538 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:22,538 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:22,538 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:22,538 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:22,539 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:22,579 - INFO - Created hash keys for 2945 rows using 10 content columns
2025-09-23 12:26:22,580 - INFO - Loaded corrected schema for FOU2T3YW
2025-09-23 12:26:23,132 - ERROR - ‚ùå Failed to load data for FOU2T3YW in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for FREQ:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: FREQ:  15%|‚ñà‚ñå        | 10/65 [02:44<07:54,  8.64s/it]
Fetching FREQ from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FREQ from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.34it/s][A
                                                                                            [ADataset: FREQ:  17%|‚ñà‚ñã        | 11/65 [02:44<05:38,  6.26s/it]Dataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:44<05:38,  6.26s/it]2025-09-23 12:26:23,132 - INFO - üåê Fetching BMRS dataset=FREQ from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:23,351 - INFO - Converting column 'measurementTime' to pandas datetime (UTC)
2025-09-23 12:26:23,355 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-09-23 12:26:23,356 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:23,359 - INFO -  -> Converted datetime column 'measurementTime' to timezone-naive.
2025-09-23 12:26:23,359 - INFO -  -> Converted float column 'frequency' to nullable Float64 based on schema.
2025-09-23 12:26:23,360 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:23,360 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:23,361 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:23,361 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:23,361 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:23,362 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:23,362 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:23,414 - INFO - Created hash keys for 5761 rows using 3 content columns
2025-09-23 12:26:23,415 - INFO - Loaded corrected schema for FREQ
2025-09-23 12:26:23,878 - ERROR - ‚ùå Failed to load data for FREQ in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for FUELHH:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:44<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                
                                                                                      [ADataset: FUELHH:  17%|‚ñà‚ñã        | 11/65 [02:45<05:38,  6.26s/it]
Fetching FUELHH from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FUELHH from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.57it/s][A
                                                                                              [ADataset: FUELHH:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]Dataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]2025-09-23 12:26:23,881 - INFO - üåê Fetching BMRS dataset=FUELHH from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:24,013 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:24,015 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:24,016 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:24,019 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:24,019 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:24,021 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:24,022 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:24,024 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:24,025 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:24,026 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:24,027 - INFO -  -> Converted integer column 'generation' to nullable Int64 based on schema.
2025-09-23 12:26:24,027 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:24,028 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:24,028 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:24,030 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:24,030 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:24,031 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:24,031 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:24,046 - INFO - Created hash keys for 480 rows using 7 content columns
2025-09-23 12:26:24,046 - INFO - Loaded corrected schema for FUELHH
2025-09-23 12:26:24,516 - ERROR - ‚ùå Failed to load data for FUELHH in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for FUELINST:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:45<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: FUELINST:  18%|‚ñà‚ñä        | 12/65 [02:46<04:02,  4.57s/it]
Fetching FUELINST from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching FUELINST from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.33it/s][A
                                                                                                [ADataset: FUELINST:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]Dataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]2025-09-23 12:26:24,520 - INFO - üåê Fetching BMRS dataset=FUELINST from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:24,629 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:24,631 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:24,632 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:24,638 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:24,638 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:24,641 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:24,644 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:24,646 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:24,647 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:24,647 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:24,647 - INFO -  -> Converted integer column 'generation' to nullable Int64 based on schema.
2025-09-23 12:26:24,648 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:24,648 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:24,649 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:24,649 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:24,649 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:24,650 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:24,650 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:24,699 - INFO - Created hash keys for 2980 rows using 7 content columns
2025-09-23 12:26:24,700 - INFO - Loaded corrected schema for FUELINST
2025-09-23 12:26:25,271 - ERROR - ‚ùå Failed to load data for FUELINST in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for IMBALNGC:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:46<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: IMBALNGC:  20%|‚ñà‚ñà        | 13/65 [02:47<02:58,  3.42s/it]
Fetching IMBALNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching IMBALNGC from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.08it/s]                               [A
                                                                         [ADataset: IMBALNGC:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]Dataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]  2025-09-23 12:26:25,274 - INFO - üåê Fetching BMRS dataset=IMBALNGC from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:25,494 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:25,496 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:25,498 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:25,612 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:25,613 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:25,615 - INFO -  -> Converted integer column 'imbalance' to nullable Int64 based on schema.
2025-09-23 12:26:25,618 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:25,621 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:25,624 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:25,624 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:25,625 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:25,626 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:25,626 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:25,627 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:25,627 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:25,628 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:25,628 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:25,629 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:25,668 - INFO - Created hash keys for 1458 rows using 7 content columns
2025-09-23 12:26:25,669 - INFO - Loaded corrected schema for IMBALNGC
2025-09-23 12:26:26,197 - ERROR - ‚ùå Failed to load data for IMBALNGC in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for INDDEM:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:47<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDDEM:  22%|‚ñà‚ñà‚ñè       | 14/65 [02:48<02:16,  2.67s/it]
Fetching INDDEM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDDEM from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.26it/s]                               [A
                                                                       [ADataset: INDDEM:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]Dataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]2025-09-23 12:26:26,201 - INFO - üåê Fetching BMRS dataset=INDDEM from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:26,319 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:26,321 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:26,323 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:26,326 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:26,326 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:26,327 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:26,329 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:26,331 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:26,333 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:26,333 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:26,333 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:26,334 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:26,334 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:26,335 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:26,335 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:26,335 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:26,336 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:26,336 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:26,368 - INFO - Created hash keys for 1458 rows using 7 content columns
2025-09-23 12:26:26,369 - INFO - Loaded corrected schema for INDDEM
2025-09-23 12:26:26,994 - ERROR - ‚ùå Failed to load data for INDDEM in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for INDGEN:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INDGEN:  23%|‚ñà‚ñà‚ñé       | 15/65 [02:48<01:45,  2.11s/it]
Fetching INDGEN from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDGEN from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.51it/s]                               [A
                                                                       [ADataset: INDGEN:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]Dataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]  2025-09-23 12:26:26,997 - INFO - üåê Fetching BMRS dataset=INDGEN from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:27,147 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:27,148 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:27,149 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:27,150 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:27,151 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:27,151 - INFO -  -> Converted integer column 'generation' to nullable Int64 based on schema.
2025-09-23 12:26:27,152 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:27,153 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:27,154 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:27,154 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:27,154 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:27,154 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:27,155 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:27,155 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:27,155 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:27,155 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:27,155 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:27,155 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:27,176 - INFO - Created hash keys for 1458 rows using 7 content columns
2025-09-23 12:26:27,176 - INFO - Loaded corrected schema for INDGEN
2025-09-23 12:26:27,657 - ERROR - ‚ùå Failed to load data for INDGEN in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for INDO:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:48<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: INDO:  25%|‚ñà‚ñà‚ñç       | 16/65 [02:49<01:22,  1.68s/it]
Fetching INDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INDO from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.63it/s]                               [A
                                                                     [ADataset: INDO:  26%|‚ñà‚ñà‚ñå       | 17/65 [02:49<01:05,  1.36s/it]Dataset: INTBPT:  26%|‚ñà‚ñà‚ñå       | 17/65 [02:49<01:05,  1.36s/it]2025-09-23 12:26:27,660 - INFO - üåê Fetching BMRS dataset=INDO from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:27,722 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:27,724 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:27,725 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:27,771 - INFO - --- Starting final sanitization for BQ load on DataFrame with 12 columns ---
2025-09-23 12:26:27,773 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:27,774 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:27,774 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:27,775 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:27,776 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:27,777 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:27,778 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:27,778 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:27,778 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:27,778 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:27,779 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:27,779 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:27,779 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:27,780 - INFO - Created hash keys for 1 rows using 6 content columns
2025-09-23 12:26:27,780 - INFO - Loaded corrected schema for INDO
2025-09-23 12:26:28,270 - ERROR - ‚ùå Failed to load data for INDO in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for INTBPT:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INTBPT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INTBPT:  26%|‚ñà‚ñà‚ñå       | 17/65 [02:49<01:05,  1.36s/it]
Fetching INTBPT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: INTBPT:  26%|‚ñà‚ñà‚ñå       | 17/65 [02:49<01:05,  1.36s/it]
Fetching INTBPT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching INTBPT from 2025-09-22 to 2025-09-23: : 1it [00:00,  9.31it/s]                               [A
                                                                       [ADataset: INTBPT:  28%|‚ñà‚ñà‚ñä       | 18/65 [02:49<00:46,  1.02it/s]Dataset: INTERCONNECTOR_FLOWS:  28%|‚ñà‚ñà‚ñä       | 18/65 [02:49<00:46,  1.02it/s]2025-09-23 12:26:28,273 - INFO - üåê Fetching BMRS dataset=INTBPT from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:28,380 - INFO - No data returned for INTBPT in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for INTERCONNECTOR_FLOWS:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching INTERCONNECTOR_FLOWS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                              
                                                                                                    [ADataset: INTERCONNECTOR_FLOWS:  28%|‚ñà‚ñà‚ñä       | 18/65 [02:49<00:46,  1.02it/s]
Fetching INTERCONNECTOR_FLOWS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                              
                                                                                                    [ADataset: INTERCONNECTOR_FLOWS:  28%|‚ñà‚ñà‚ñä       | 18/65 [02:49<00:46,  1.02it/s]
Fetching INTERCONNECTOR_FLOWS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
                                                                                                    [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]               2025-09-23 12:26:28,381 - INFO - üåê Fetching BMRS dataset=INTERCONNECTOR_FLOWS from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:28,476 - INFO - No data returned for INTERCONNECTOR_FLOWS in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for ITSDO:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:49<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: ITSDO:  29%|‚ñà‚ñà‚ñâ       | 19/65 [02:50<00:45,  1.02it/s]
Fetching ITSDO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching ITSDO from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.42it/s]                               [A
                                                                      [ADataset: ITSDO:  31%|‚ñà‚ñà‚ñà       | 20/65 [02:50<00:32,  1.40it/s]Dataset: MARKET_INDEX_PRICES:  31%|‚ñà‚ñà‚ñà       | 20/65 [02:50<00:32,  1.40it/s]2025-09-23 12:26:28,476 - INFO - üåê Fetching BMRS dataset=ITSDO from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:28,622 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:28,622 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:28,623 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:28,624 - INFO - --- Starting final sanitization for BQ load on DataFrame with 12 columns ---
2025-09-23 12:26:28,625 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:28,625 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:28,625 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:28,625 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:28,626 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:28,626 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:28,626 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:28,626 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:28,626 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:28,627 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:28,627 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:28,627 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:28,627 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:28,628 - INFO - Created hash keys for 1 rows using 6 content columns
2025-09-23 12:26:28,628 - INFO - Loaded corrected schema for ITSDO
2025-09-23 12:26:29,177 - ERROR - ‚ùå Failed to load data for ITSDO in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for MARKET_INDEX_PRICES:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching MARKET_INDEX_PRICES from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                             
                                                                                                   [ADataset: MARKET_INDEX_PRICES:  31%|‚ñà‚ñà‚ñà       | 20/65 [02:50<00:32,  1.40it/s]
Fetching MARKET_INDEX_PRICES from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                             
                                                                                                   [ADataset: MARKET_INDEX_PRICES:  31%|‚ñà‚ñà‚ñà       | 20/65 [02:50<00:32,  1.40it/s]
Fetching MARKET_INDEX_PRICES from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]                2025-09-23 12:26:29,179 - INFO - üåê Fetching BMRS dataset=MARKET_INDEX_PRICES from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:29,263 - INFO - No data returned for MARKET_INDEX_PRICES in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for MDP:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:50<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDP:  32%|‚ñà‚ñà‚ñà‚ñè      | 21/65 [02:51<00:31,  1.40it/s]
Fetching MDP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MDP from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.35it/s]                               [A
                                                                    [ADataset: MDP:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]Dataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]2025-09-23 12:26:29,263 - INFO - üåê Fetching BMRS dataset=MDP from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:29,322 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:29,322 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:29,323 - WARNING - No corrected schema file found for dataset 'MDP' at 'schemas/corrected/bmrs_mdp.json'.
2025-09-23 12:26:29,323 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:29,323 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:29,324 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:29,324 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:29,324 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:29,325 - INFO -  -> Converted integer column 'periodMax' to nullable Int64.
2025-09-23 12:26:29,325 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:29,325 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:29,326 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:29,326 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:29,326 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:29,327 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:29,327 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:29,327 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:29,327 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:29,328 - INFO - Created hash keys for 1 rows using 7 content columns
2025-09-23 12:26:29,328 - WARNING - No corrected schema file found for dataset 'MDP' at 'schemas/corrected/bmrs_mdp.json'.
2025-09-23 12:26:29,329 - WARNING - Could not find corrected schema for MDP. Using autodetect.
2025-09-23 12:26:30,002 - ERROR - ‚ùå Failed to load data for MDP in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for MDV:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MDV:  34%|‚ñà‚ñà‚ñà‚ñç      | 22/65 [02:51<00:25,  1.68it/s]
Fetching MDV from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MDV from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.24it/s]                               [A
                                                                    [ADataset: MDV:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:51<00:26,  1.56it/s]Dataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:51<00:26,  1.56it/s]2025-09-23 12:26:30,004 - INFO - üåê Fetching BMRS dataset=MDV from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:30,140 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:30,141 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:30,141 - WARNING - No corrected schema file found for dataset 'MDV' at 'schemas/corrected/bmrs_mdv.json'.
2025-09-23 12:26:30,142 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:30,142 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:30,142 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:30,142 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:30,143 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:30,143 - INFO -  -> Converted integer column 'volumeMax' to nullable Int64.
2025-09-23 12:26:30,143 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:30,143 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:30,143 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:30,144 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:30,144 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:30,144 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:30,144 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:30,144 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:30,144 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:30,145 - INFO - Created hash keys for 1 rows using 7 content columns
2025-09-23 12:26:30,145 - WARNING - No corrected schema file found for dataset 'MDV' at 'schemas/corrected/bmrs_mdv.json'.
2025-09-23 12:26:30,145 - WARNING - Could not find corrected schema for MDV. Using autodetect.
2025-09-23 12:26:30,812 - ERROR - ‚ùå Failed to load data for MDV in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for MELNGC:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:51<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: MELNGC:  35%|‚ñà‚ñà‚ñà‚ñå      | 23/65 [02:52<00:26,  1.56it/s]
Fetching MELNGC from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MELNGC from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.52it/s]                               [A
                                                                       [ADataset: MELNGC:  37%|‚ñà‚ñà‚ñà‚ñã      | 24/65 [02:52<00:26,  1.55it/s]Dataset: MELS:  37%|‚ñà‚ñà‚ñà‚ñã      | 24/65 [02:52<00:26,  1.55it/s]                                                                Dataset: MELS:  37%|‚ñà‚ñà‚ñà‚ñã      | 24/65 [02:52<00:26,  1.55it/s]Dataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s] 2025-09-23 12:26:30,813 - INFO - üåê Fetching BMRS dataset=MELNGC from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:31,016 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:31,017 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:31,018 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:31,036 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:31,037 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:31,037 - INFO -  -> Converted integer column 'margin' to nullable Int64 based on schema.
2025-09-23 12:26:31,038 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:31,039 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:31,041 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:31,041 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:31,041 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:31,042 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:31,042 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:31,042 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:31,042 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:31,042 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:31,043 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:31,043 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:31,066 - INFO - Created hash keys for 1458 rows using 7 content columns
2025-09-23 12:26:31,066 - INFO - Loaded corrected schema for MELNGC
2025-09-23 12:26:31,468 - ERROR - ‚ùå Failed to load data for MELNGC in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
2025-09-23 12:26:31,469 - INFO - Skipping likely offline dataset: MELS

Windows for MID:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:52<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MID:  38%|‚ñà‚ñà‚ñà‚ñä      | 25/65 [02:53<00:25,  1.55it/s]
Fetching MID from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MID from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.03it/s]                               [A
                                                                    [ADataset: MID:  40%|‚ñà‚ñà‚ñà‚ñà      | 26/65 [02:53<00:18,  2.07it/s]Dataset: MILS:  40%|‚ñà‚ñà‚ñà‚ñà      | 26/65 [02:53<00:18,  2.07it/s]                                                              Dataset: MILS:  40%|‚ñà‚ñà‚ñà‚ñà      | 26/65 [02:53<00:18,  2.07it/s]Dataset: MIP:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 27/65 [02:53<00:18,  2.07it/s] 2025-09-23 12:26:31,469 - INFO - üåê Fetching BMRS dataset=MID from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:31,531 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:31,531 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:31,534 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:31,535 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:31,535 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:31,535 - INFO -  -> Forced object column 'dataProvider' to string.
2025-09-23 12:26:31,536 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:31,536 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:31,538 - INFO -  -> Converted float column 'price' to nullable Float64 based on schema.
2025-09-23 12:26:31,539 - INFO -  -> Converted float column 'volume' to nullable Float64 based on schema.
2025-09-23 12:26:31,539 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:31,539 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:31,539 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:31,539 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:31,540 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:31,540 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:31,540 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:31,542 - INFO - Created hash keys for 98 rows using 7 content columns
2025-09-23 12:26:31,543 - INFO - Loaded corrected schema for MID
2025-09-23 12:26:31,960 - ERROR - ‚ùå Failed to load data for MID in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
2025-09-23 12:26:31,962 - INFO - Skipping likely offline dataset: MILS

Windows for MIP:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MIP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MIP:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 27/65 [02:53<00:18,  2.07it/s]
Fetching MIP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MIP:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 27/65 [02:53<00:18,  2.07it/s]
Fetching MIP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MIP from 2025-09-22 to 2025-09-23: : 1it [00:00,  8.58it/s]                               [A
                                                                    [ADataset: MIP:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]Dataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]2025-09-23 12:26:31,963 - INFO - üåê Fetching BMRS dataset=MIP from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:32,079 - INFO - No data returned for MIP in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for MNZT:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: MNZT:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 28/65 [02:53<00:12,  3.06it/s]
Fetching MNZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MNZT from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.38it/s]                               [A
                                                                     [ADataset: MNZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]Dataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s] 2025-09-23 12:26:32,080 - INFO - üåê Fetching BMRS dataset=MNZT from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:32,136 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:32,137 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:32,138 - WARNING - No corrected schema file found for dataset 'MNZT' at 'schemas/corrected/bmrs_mnzt.json'.
2025-09-23 12:26:32,138 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:32,139 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:32,140 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:32,140 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:32,141 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:32,142 - INFO -  -> Converted integer column 'periodMin' to nullable Int64.
2025-09-23 12:26:32,142 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:32,142 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:32,143 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:32,143 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:32,143 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:32,144 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:32,144 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:32,144 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:32,144 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:32,147 - INFO - Created hash keys for 63 rows using 7 content columns
2025-09-23 12:26:32,147 - WARNING - No corrected schema file found for dataset 'MNZT' at 'schemas/corrected/bmrs_mnzt.json'.
2025-09-23 12:26:32,147 - WARNING - Could not find corrected schema for MNZT. Using autodetect.
2025-09-23 12:26:32,805 - ERROR - ‚ùå Failed to load data for MNZT in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for MZT:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:53<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: MZT:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 29/65 [02:54<00:14,  2.44it/s]
Fetching MZT from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching MZT from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.08it/s]                               [A
                                                                    [ADataset: MZT:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]Dataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]2025-09-23 12:26:32,806 - INFO - üåê Fetching BMRS dataset=MZT from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:32,863 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:32,865 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:32,868 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:32,868 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:32,869 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:32,870 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:32,870 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:32,871 - INFO -  -> Converted integer column 'periodMin' to nullable Int64 based on schema.
2025-09-23 12:26:32,871 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:32,871 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:32,872 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:32,872 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:32,872 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:32,872 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:32,873 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:32,873 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:32,873 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:32,875 - INFO - Created hash keys for 52 rows using 7 content columns
2025-09-23 12:26:32,876 - INFO - Loaded corrected schema for MZT
2025-09-23 12:26:33,285 - ERROR - ‚ùå Failed to load data for MZT in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NDF:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDF:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 30/65 [02:54<00:14,  2.35it/s]
Fetching NDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDF from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.79it/s]                               [A
                                                                    [ADataset: NDF:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:54<00:15,  2.18it/s]Dataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:54<00:15,  2.18it/s]2025-09-23 12:26:33,287 - INFO - üåê Fetching BMRS dataset=NDF from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:33,380 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:33,380 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:33,381 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:33,384 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:33,384 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:33,384 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:33,385 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:33,385 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:33,386 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:33,386 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:33,386 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:33,386 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:33,387 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:33,387 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:33,387 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:33,387 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:33,388 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:33,388 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:33,391 - INFO - Created hash keys for 81 rows using 7 content columns
2025-09-23 12:26:33,392 - INFO - Loaded corrected schema for NDF
2025-09-23 12:26:33,845 - ERROR - ‚ùå Failed to load data for NDF in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NDFD:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:54<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:54<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:54<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFD:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 31/65 [02:55<00:15,  2.18it/s]
Fetching NDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDFD from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.81it/s]                               [A
                                                                     [ADataset: NDFD:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]Dataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]2025-09-23 12:26:33,846 - INFO - üåê Fetching BMRS dataset=NDFD from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:33,897 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:33,898 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:34,033 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:26:34,034 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:34,034 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:34,034 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:34,035 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:34,035 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:34,035 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:34,035 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:34,035 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:34,036 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:34,036 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:34,036 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:34,037 - INFO - Created hash keys for 13 rows using 4 content columns
2025-09-23 12:26:34,037 - INFO - Loaded corrected schema for NDFD
2025-09-23 12:26:34,397 - ERROR - ‚ùå Failed to load data for NDFD in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NDFW:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: NDFW:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 32/65 [02:55<00:15,  2.07it/s]
Fetching NDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDFW from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.17it/s]                               [A
                                                                     [ADataset: NDFW:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:55<00:15,  2.09it/s]Dataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:55<00:15,  2.09it/s] 2025-09-23 12:26:34,398 - INFO - üåê Fetching BMRS dataset=NDFW from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:34,479 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:34,480 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-09-23 12:26:34,480 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:34,481 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:34,481 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:34,481 - INFO -  -> Converted integer column 'week' to nullable Int64 based on schema.
2025-09-23 12:26:34,482 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:34,482 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:34,482 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:34,482 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:34,483 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:34,483 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:34,483 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:34,483 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:34,485 - INFO - Created hash keys for 51 rows using 5 content columns
2025-09-23 12:26:34,485 - INFO - Loaded corrected schema for NDFW
2025-09-23 12:26:34,859 - ERROR - ‚ùå Failed to load data for NDFW in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NDZ:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:55<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NDZ:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 33/65 [02:56<00:15,  2.09it/s]
Fetching NDZ from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NDZ from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.60it/s]                               [A
                                                                    [ADataset: NDZ:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]Dataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]2025-09-23 12:26:34,860 - INFO - üåê Fetching BMRS dataset=NDZ from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:34,939 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:34,944 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:34,948 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:34,950 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:34,952 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:34,956 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:34,961 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:34,967 - INFO -  -> Converted integer column 'notice' to nullable Int64 based on schema.
2025-09-23 12:26:34,972 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:34,974 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:34,975 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:34,975 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:34,976 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:34,976 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:34,978 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:34,980 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:34,980 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:34,987 - INFO - Created hash keys for 70 rows using 7 content columns
2025-09-23 12:26:34,988 - INFO - Loaded corrected schema for NDZ
2025-09-23 12:26:35,482 - ERROR - ‚ùå Failed to load data for NDZ in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NETBSAD:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:56<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                 
                                                                                       [ADataset: NETBSAD:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 34/65 [02:57<00:16,  1.93it/s]
Fetching NETBSAD from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching NETBSAD from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.37it/s][A
                                                                                               [ADataset: NETBSAD:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]Dataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]  2025-09-23 12:26:35,487 - INFO - üåê Fetching BMRS dataset=NETBSAD from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:35,655 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:35,669 - INFO - --- Starting final sanitization for BQ load on DataFrame with 17 columns ---
2025-09-23 12:26:35,669 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:35,670 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:35,670 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:35,671 - INFO -  -> Converted float column 'netBuyPriceCostAdjustmentEnergy' to nullable Float64 based on schema.
2025-09-23 12:26:35,671 - INFO -  -> Converted float column 'netBuyPriceVolumeAdjustmentEnergy' to nullable Float64 based on schema.
2025-09-23 12:26:35,671 - INFO -  -> Converted float column 'netBuyPriceVolumeAdjustmentSystem' to nullable Float64 based on schema.
2025-09-23 12:26:35,671 - INFO -  -> Converted float column 'buyPricePriceAdjustment' to nullable Float64 based on schema.
2025-09-23 12:26:35,672 - INFO -  -> Converted float column 'netSellPriceCostAdjustmentEnergy' to nullable Float64 based on schema.
2025-09-23 12:26:35,672 - INFO -  -> Converted float column 'netSellPriceVolumeAdjustmentEnergy' to nullable Float64 based on schema.
2025-09-23 12:26:35,672 - INFO -  -> Converted float column 'netSellPriceVolumeAdjustmentSystem' to nullable Float64 based on schema.
2025-09-23 12:26:35,672 - INFO -  -> Converted float column 'sellPricePriceAdjustment' to nullable Float64 based on schema.
2025-09-23 12:26:35,672 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:35,673 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:35,673 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:35,673 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:35,673 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:35,673 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:35,674 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:35,676 - INFO - Created hash keys for 49 rows using 11 content columns
2025-09-23 12:26:35,677 - INFO - Loaded corrected schema for NETBSAD
2025-09-23 12:26:36,215 - ERROR - ‚ùå Failed to load data for NETBSAD in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NONBM:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: NONBM:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 35/65 [02:57<00:17,  1.72it/s]
Fetching NONBM from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NONBM from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.06it/s]                               [A
                                                                      [ADataset: NONBM:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]Dataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]2025-09-23 12:26:36,218 - INFO - üåê Fetching BMRS dataset=NONBM from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:36,278 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:36,279 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:36,279 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:36,287 - INFO - --- Starting final sanitization for BQ load on DataFrame with 12 columns ---
2025-09-23 12:26:36,288 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:36,288 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:36,288 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:36,289 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:36,289 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:36,290 - INFO -  -> Converted integer column 'generation' to nullable Int64 based on schema.
2025-09-23 12:26:36,290 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:36,291 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:36,291 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:36,292 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:36,294 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:36,295 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:36,295 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:36,297 - INFO - Created hash keys for 48 rows using 6 content columns
2025-09-23 12:26:36,298 - INFO - Loaded corrected schema for NONBM
2025-09-23 12:26:36,702 - ERROR - ‚ùå Failed to load data for NONBM in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NOU2T14D:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][AError converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                                  
                                                                                                        [ADataset: NOU2T14D:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 36/65 [02:57<00:16,  1.81it/s]
Fetching NOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]2025-09-23 12:26:36,703 - INFO - üåê Fetching BMRS dataset=NOU2T14D from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:36,777 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:36,778 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:36,782 - INFO - --- Starting final sanitization for BQ load on DataFrame with 12 columns ---
2025-09-23 12:26:36,783 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:36,783 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:36,784 - INFO -  -> Forced object column 'systemZone' to string.
2025-09-23 12:26:36,784 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:36,784 - INFO -  -> Forced object column 'forecastDateTimezone' to string.
2025-09-23 12:26:36,785 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:36,785 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:36,785 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:36,786 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:36,786 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:36,786 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:36,787 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:36,787 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:36,788 - INFO - Created hash keys for 13 rows using 6 content columns
2025-09-23 12:26:36,789 - INFO - Loaded corrected schema for NOU2T14D
2025-09-23 12:26:36,793 - ERROR - ‚ùå Failed to load data for NOU2T14D in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "forecastDateTimezone" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray

Windows for NOU2T3YW:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:57<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: NOU2T3YW:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 37/65 [02:58<00:15,  1.81it/s]
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NOU2T3YW from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.76it/s]                               [A
                                                                         [ADataset: NOU2T3YW:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]Dataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]     2025-09-23 12:26:36,795 - INFO - üåê Fetching BMRS dataset=NOU2T3YW from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:36,862 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:36,864 - INFO - --- Starting final sanitization for BQ load on DataFrame with 12 columns ---
2025-09-23 12:26:36,865 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:36,866 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:36,866 - INFO -  -> Forced object column 'systemZone' to string.
2025-09-23 12:26:36,866 - INFO -  -> Converted integer column 'calendarWeekNumber' to nullable Int64 based on schema.
2025-09-23 12:26:36,867 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:36,867 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:36,867 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:36,868 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:36,868 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:36,868 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:36,869 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:36,869 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:36,869 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:36,872 - INFO - Created hash keys for 155 rows using 6 content columns
2025-09-23 12:26:36,873 - INFO - Loaded corrected schema for NOU2T3YW
2025-09-23 12:26:37,361 - ERROR - ‚ùå Failed to load data for NOU2T3YW in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NTB:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:58<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTB:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 38/65 [02:59<00:12,  2.21it/s]
Fetching NTB from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NTB from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.29it/s]                               [A
                                                                    [ADataset: NTB:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]Dataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]2025-09-23 12:26:37,366 - INFO - üåê Fetching BMRS dataset=NTB from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:37,520 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:37,522 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:37,523 - WARNING - No corrected schema file found for dataset 'NTB' at 'schemas/corrected/bmrs_ntb.json'.
2025-09-23 12:26:37,524 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:37,524 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:37,524 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:37,525 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:37,525 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:37,525 - INFO -  -> Converted integer column 'notice' to nullable Int64.
2025-09-23 12:26:37,525 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:37,525 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:37,526 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:37,527 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:37,528 - INFO - Created hash keys for 19 rows using 7 content columns
2025-09-23 12:26:37,528 - WARNING - No corrected schema file found for dataset 'NTB' at 'schemas/corrected/bmrs_ntb.json'.
2025-09-23 12:26:37,528 - WARNING - Could not find corrected schema for NTB. Using autodetect.
2025-09-23 12:26:38,141 - ERROR - ‚ùå Failed to load data for NTB in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for NTO:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: NTO:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 39/65 [02:59<00:13,  1.88it/s]
Fetching NTO from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching NTO from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.81it/s]                               [A
                                                                    [ADataset: NTO:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]Dataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]2025-09-23 12:26:38,144 - INFO - üåê Fetching BMRS dataset=NTO from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:38,208 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:38,210 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:38,210 - WARNING - No corrected schema file found for dataset 'NTO' at 'schemas/corrected/bmrs_nto.json'.
2025-09-23 12:26:38,210 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:38,211 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:38,211 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:38,211 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:38,212 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:38,212 - INFO -  -> Converted integer column 'notice' to nullable Int64.
2025-09-23 12:26:38,212 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:38,213 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:38,213 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:38,213 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:38,213 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:38,213 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:38,214 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:38,214 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:38,214 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:38,215 - INFO - Created hash keys for 19 rows using 7 content columns
2025-09-23 12:26:38,215 - WARNING - No corrected schema file found for dataset 'NTO' at 'schemas/corrected/bmrs_nto.json'.
2025-09-23 12:26:38,215 - WARNING - Could not find corrected schema for NTO. Using autodetect.
2025-09-23 12:26:38,696 - ERROR - ‚ùå Failed to load data for NTO in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for OCNMF3Y:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [02:59<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMF3Y:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 40/65 [03:00<00:13,  1.86it/s]
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMF3Y from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.00it/s]                               [A
                                                                        [ADataset: OCNMF3Y:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]Dataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]2025-09-23 12:26:38,697 - INFO - üåê Fetching BMRS dataset=OCNMF3Y from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:38,761 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:38,765 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-09-23 12:26:38,766 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:38,766 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:38,767 - INFO -  -> Converted integer column 'week' to nullable Int64 based on schema.
2025-09-23 12:26:38,767 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:38,767 - INFO -  -> Converted integer column 'surplus' to nullable Int64 based on schema.
2025-09-23 12:26:38,768 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:38,768 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:38,768 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:38,768 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:38,769 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:38,769 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:38,769 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:38,772 - INFO - Created hash keys for 155 rows using 5 content columns
2025-09-23 12:26:38,772 - INFO - Loaded corrected schema for OCNMF3Y
2025-09-23 12:26:39,197 - ERROR - ‚ùå Failed to load data for OCNMF3Y in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for OCNMF3Y2:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                  
                                                                                                        [ADataset: OCNMF3Y2:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 41/65 [03:00<00:12,  1.90it/s]
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMF3Y2 from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.11it/s]                               [A
                                                                         [ADataset: OCNMF3Y2:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]Dataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]  2025-09-23 12:26:39,198 - INFO - üåê Fetching BMRS dataset=OCNMF3Y2 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:39,265 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:39,266 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-09-23 12:26:39,266 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:39,267 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:39,267 - INFO -  -> Converted integer column 'week' to nullable Int64 based on schema.
2025-09-23 12:26:39,267 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:39,268 - INFO -  -> Converted integer column 'margin' to nullable Int64 based on schema.
2025-09-23 12:26:39,268 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:39,268 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:39,268 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:39,268 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:39,268 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:39,269 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:39,269 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:39,271 - INFO - Created hash keys for 155 rows using 5 content columns
2025-09-23 12:26:39,271 - INFO - Loaded corrected schema for OCNMF3Y2
2025-09-23 12:26:39,670 - ERROR - ‚ùå Failed to load data for OCNMF3Y2 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for OCNMFD:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:00<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                
                                                                                                      [ADataset: OCNMFD:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 42/65 [03:01<00:11,  1.95it/s]
Fetching OCNMFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMFD from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.32it/s]                               [A
                                                                       [ADataset: OCNMFD:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]Dataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]2025-09-23 12:26:39,672 - INFO - üåê Fetching BMRS dataset=OCNMFD from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:39,741 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:39,741 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:39,744 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:26:39,744 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:39,745 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:39,745 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:39,746 - INFO -  -> Converted integer column 'surplus' to nullable Int64 based on schema.
2025-09-23 12:26:39,746 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:39,746 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:39,746 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:39,746 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:39,747 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:39,747 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:39,747 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:39,748 - INFO - Created hash keys for 13 rows using 4 content columns
2025-09-23 12:26:39,748 - INFO - Loaded corrected schema for OCNMFD
2025-09-23 12:26:40,101 - ERROR - ‚ùå Failed to load data for OCNMFD in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for OCNMFD2:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: OCNMFD2:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 43/65 [03:01<00:10,  2.04it/s]
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching OCNMFD2 from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.47it/s]                               [A
                                                                        [ADataset: OCNMFD2:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:01<00:09,  2.15it/s]Dataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:01<00:09,  2.15it/s]     2025-09-23 12:26:40,102 - INFO - üåê Fetching BMRS dataset=OCNMFD2 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:40,173 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:40,175 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:40,177 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:26:40,178 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:40,179 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:40,179 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:40,180 - INFO -  -> Converted integer column 'margin' to nullable Int64 based on schema.
2025-09-23 12:26:40,180 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:40,180 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:40,181 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:40,181 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:40,181 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:40,182 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:40,182 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:40,184 - INFO - Created hash keys for 13 rows using 4 content columns
2025-09-23 12:26:40,184 - INFO - Loaded corrected schema for OCNMFD2
2025-09-23 12:26:40,505 - ERROR - ‚ùå Failed to load data for OCNMFD2 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for PN:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:01<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:03<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:05<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:03<?, ?it/s][A                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:05<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:03<?, ?it/s][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                            
                                                                                  [ADataset: PN:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 44/65 [03:05<00:09,  2.15it/s]
Fetching PN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:04<?, ?it/s][A
Fetching PN from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:04<00:00,  4.27s/it][A
                                                                                          [ADataset: PN:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 45/65 [03:05<00:31,  1.58s/it]Dataset: QAS:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 45/65 [03:05<00:31,  1.58s/it]2025-09-23 12:26:40,508 - INFO - üåê Fetching BMRS dataset=PN from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:42,824 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:42,878 - INFO - --- Starting final sanitization for BQ load on DataFrame with 15 columns ---
2025-09-23 12:26:42,880 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:42,885 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:42,886 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:42,890 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:26:42,895 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:26:42,896 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:26:42,897 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:26:42,901 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:42,905 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:42,907 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:42,910 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:42,911 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:42,913 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:42,915 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:42,923 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:42,923 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:44,363 - INFO - Created hash keys for 119535 rows using 9 content columns
2025-09-23 12:26:44,373 - INFO - Loaded corrected schema for PN
2025-09-23 12:26:44,772 - ERROR - ‚ùå Failed to load data for PN in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray

Windows for QAS:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching QAS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                             
                                                                                   [ADataset: QAS:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 45/65 [03:05<00:31,  1.58s/it]
Fetching QAS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                             
                                                                                   [ADataset: QAS:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 45/65 [03:05<00:31,  1.58s/it]
Fetching QAS from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching QAS from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  8.18it/s][A
                                                                                           [ADataset: QAS:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:05<00:21,  1.15s/it]Dataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:05<00:21,  1.15s/it]2025-09-23 12:26:44,775 - INFO - üåê Fetching BMRS dataset=QAS from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:44,897 - INFO - No data returned for QAS in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for QPN:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:05<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:07<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:09<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:03<?, ?it/s][A                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:09<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:03<?, ?it/s][AError converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
                                                             
                                                                                   [ADataset: QPN:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 46/65 [03:09<00:21,  1.15s/it]
Fetching QPN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:03<?, ?it/s][A
Fetching QPN from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:03<00:00,  3.53s/it][A
                                                                                           [ADataset: QPN:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]Dataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]2025-09-23 12:26:44,897 - INFO - üåê Fetching BMRS dataset=QPN from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:46,667 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:46,729 - INFO - --- Starting final sanitization for BQ load on DataFrame with 15 columns ---
2025-09-23 12:26:46,731 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:46,737 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:46,738 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:46,743 - INFO -  -> Forced object column 'timeFrom' to string.
2025-09-23 12:26:46,747 - INFO -  -> Forced object column 'timeTo' to string.
2025-09-23 12:26:46,748 - INFO -  -> Converted integer column 'levelFrom' to nullable Int64 based on schema.
2025-09-23 12:26:46,748 - INFO -  -> Converted integer column 'levelTo' to nullable Int64 based on schema.
2025-09-23 12:26:46,753 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:46,759 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:46,761 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:46,762 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:46,764 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:46,765 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:46,767 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:46,774 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:46,774 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:48,088 - INFO - Created hash keys for 106623 rows using 9 content columns
2025-09-23 12:26:48,095 - INFO - Loaded corrected schema for QPN
2025-09-23 12:26:48,426 - ERROR - ‚ùå Failed to load data for QPN in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 375, in bq_to_arrow_array
    return pyarrow.Array.from_pandas(series, type=arrow_type)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pyarrow/array.pxi", line 1259, in pyarrow.lib.Array.from_pandas
  File "pyarrow/array.pxi", line 365, in pyarrow.lib.array
  File "pyarrow/array.pxi", line 91, in pyarrow.lib._ndarray_to_array
  File "pyarrow/error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: object of type <class 'str'> cannot be converted to int

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2891, in load_table_from_dataframe
    _pandas_helpers.dataframe_to_parquet(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        dataframe,
        ^^^^^^^^^^
    ...<3 lines>...
        parquet_use_compliant_nested_type=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 717, in dataframe_to_parquet
    arrow_table = dataframe_to_arrow(dataframe, bq_schema)
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 660, in dataframe_to_arrow
    bq_to_arrow_array(get_column_or_index(dataframe, bq_field.name), bq_field)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/_pandas_helpers.py", line 379, in bq_to_arrow_array
    raise pyarrow.ArrowTypeError(msg)
pyarrow.lib.ArrowTypeError: Error converting Pandas column with name: "timeFrom" and datatype: "object" to an appropriate pyarrow datatype: Array, ListArray, or StructArray

Windows for RDRE:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:09<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRE:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 47/65 [03:10<00:33,  1.85s/it]
Fetching RDRE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RDRE from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.33it/s][A
                                                                                            [ADataset: RDRE:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]Dataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]2025-09-23 12:26:48,428 - INFO - üåê Fetching BMRS dataset=RDRE from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:48,684 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:48,685 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:48,686 - WARNING - No corrected schema file found for dataset 'RDRE' at 'schemas/corrected/bmrs_rdre.json'.
2025-09-23 12:26:48,686 - INFO - --- Starting final sanitization for BQ load on DataFrame with 17 columns ---
2025-09-23 12:26:48,687 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:48,687 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:48,688 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:48,688 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:48,689 - INFO -  -> Converted float column 'rate1' to nullable Float64.
2025-09-23 12:26:48,689 - INFO -  -> Converted float column 'elbow2' to nullable Float64.
2025-09-23 12:26:48,689 - INFO -  -> Converted float column 'rate2' to nullable Float64.
2025-09-23 12:26:48,690 - INFO -  -> Converted float column 'elbow3' to nullable Float64.
2025-09-23 12:26:48,690 - INFO -  -> Converted float column 'rate3' to nullable Float64.
2025-09-23 12:26:48,690 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:48,691 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:48,692 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:48,692 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:48,692 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:48,693 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:48,693 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:48,693 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:48,694 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:48,697 - INFO - Created hash keys for 49 rows using 11 content columns
2025-09-23 12:26:48,697 - WARNING - No corrected schema file found for dataset 'RDRE' at 'schemas/corrected/bmrs_rdre.json'.
2025-09-23 12:26:48,697 - WARNING - Could not find corrected schema for RDRE. Using autodetect.
2025-09-23 12:26:49,176 - ERROR - ‚ùå Failed to load data for RDRE in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for RDRI:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RDRI:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 48/65 [03:10<00:25,  1.53s/it]
Fetching RDRI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RDRI from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.81it/s][A
                                                                                            [ADataset: RDRI:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:10<00:19,  1.24s/it]Dataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:10<00:19,  1.24s/it]2025-09-23 12:26:49,179 - INFO - üåê Fetching BMRS dataset=RDRI from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:49,361 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:49,362 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:49,385 - INFO - --- Starting final sanitization for BQ load on DataFrame with 17 columns ---
2025-09-23 12:26:49,385 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:49,386 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:49,386 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:49,386 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:49,386 - INFO -  -> Converted float column 'rate1' to nullable Float64 based on schema.
2025-09-23 12:26:49,388 - INFO -  -> Converted float column 'elbow2' to nullable Float64 based on schema.
2025-09-23 12:26:49,389 - INFO -  -> Converted float column 'rate2' to nullable Float64 based on schema.
2025-09-23 12:26:49,389 - INFO -  -> Converted float column 'elbow3' to nullable Float64 based on schema.
2025-09-23 12:26:49,390 - INFO -  -> Converted float column 'rate3' to nullable Float64 based on schema.
2025-09-23 12:26:49,390 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:49,390 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:49,391 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:49,391 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:49,391 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:49,391 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:49,391 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:49,392 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:49,392 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:49,393 - INFO - Created hash keys for 1 rows using 11 content columns
2025-09-23 12:26:49,393 - INFO - Loaded corrected schema for RDRI
2025-09-23 12:26:49,731 - ERROR - ‚ùå Failed to load data for RDRI in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for RURE:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:10<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURE:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 49/65 [03:11<00:19,  1.24s/it]
Fetching RURE from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RURE from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.49it/s][A
                                                                                            [ADataset: RURE:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]Dataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]2025-09-23 12:26:49,732 - INFO - üåê Fetching BMRS dataset=RURE from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:49,960 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:49,961 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:49,966 - INFO - --- Starting final sanitization for BQ load on DataFrame with 17 columns ---
2025-09-23 12:26:49,968 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:49,970 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:49,971 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:49,971 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:49,972 - INFO -  -> Converted float column 'rate1' to nullable Float64 based on schema.
2025-09-23 12:26:49,972 - INFO -  -> Converted float column 'elbow2' to nullable Float64 based on schema.
2025-09-23 12:26:49,973 - INFO -  -> Converted float column 'rate2' to nullable Float64 based on schema.
2025-09-23 12:26:49,974 - INFO -  -> Converted float column 'elbow3' to nullable Float64 based on schema.
2025-09-23 12:26:49,975 - INFO -  -> Converted float column 'rate3' to nullable Float64 based on schema.
2025-09-23 12:26:49,975 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:49,976 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:49,976 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:49,976 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:49,977 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:49,977 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:49,977 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:49,977 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:49,977 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:49,982 - INFO - Created hash keys for 133 rows using 11 content columns
2025-09-23 12:26:49,983 - INFO - Loaded corrected schema for RURE
2025-09-23 12:26:50,402 - ERROR - ‚ùå Failed to load data for RURE in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for RURI:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:11<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: RURI:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 50/65 [03:12<00:16,  1.07s/it]
Fetching RURI from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching RURI from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.87it/s][A
                                                                                            [ADataset: RURI:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 51/65 [03:12<00:12,  1.10it/s]Dataset: S0621:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 51/65 [03:12<00:12,  1.10it/s]2025-09-23 12:26:50,406 - INFO - üåê Fetching BMRS dataset=RURI from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:50,588 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:50,588 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:50,591 - INFO - --- Starting final sanitization for BQ load on DataFrame with 17 columns ---
2025-09-23 12:26:50,591 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:50,592 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:50,592 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:50,593 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:50,593 - INFO -  -> Converted float column 'rate1' to nullable Float64 based on schema.
2025-09-23 12:26:50,593 - INFO -  -> Converted float column 'elbow2' to nullable Float64 based on schema.
2025-09-23 12:26:50,594 - INFO -  -> Converted float column 'rate2' to nullable Float64 based on schema.
2025-09-23 12:26:50,594 - INFO -  -> Converted float column 'elbow3' to nullable Float64 based on schema.
2025-09-23 12:26:50,594 - INFO -  -> Converted float column 'rate3' to nullable Float64 based on schema.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:50,595 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:50,596 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:50,596 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:50,596 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:50,597 - INFO - Created hash keys for 1 rows using 11 content columns
2025-09-23 12:26:50,598 - INFO - Loaded corrected schema for RURI
2025-09-23 12:26:50,939 - ERROR - ‚ùå Failed to load data for RURI in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for S0621:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching S0621 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                               
                                                                                     [ADataset: S0621:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 51/65 [03:12<00:12,  1.10it/s]
Fetching S0621 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                               
                                                                                     [ADataset: S0621:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 51/65 [03:12<00:12,  1.10it/s]
Fetching S0621 from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching S0621 from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  4.63it/s][A
                                                                                             [ADataset: S0621:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]Dataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]  2025-09-23 12:26:50,941 - INFO - üåê Fetching BMRS dataset=S0621 from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:51,156 - INFO - No data returned for S0621 in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for SEL:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SEL:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 52/65 [03:12<00:09,  1.43it/s]
Fetching SEL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching SEL from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.78it/s]                               [A
                                                                    [ADataset: SEL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]Dataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]2025-09-23 12:26:51,158 - INFO - üåê Fetching BMRS dataset=SEL from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:51,285 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:51,287 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:51,293 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:51,294 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:51,295 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:51,296 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:51,298 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:51,298 - INFO -  -> Converted integer column 'level' to nullable Int64 based on schema.
2025-09-23 12:26:51,299 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:51,299 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:51,300 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:51,300 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:51,300 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:51,301 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:51,301 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:51,302 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:51,302 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:51,309 - INFO - Created hash keys for 166 rows using 7 content columns
2025-09-23 12:26:51,309 - INFO - Loaded corrected schema for SEL
2025-09-23 12:26:51,718 - ERROR - ‚ùå Failed to load data for SEL in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for SIL:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:12<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                             
                                                                                                   [ADataset: SIL:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 53/65 [03:13<00:07,  1.51it/s]
Fetching SIL from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching SIL from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.56it/s]                               [A
                                                                    [ADataset: SIL:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 54/65 [03:13<00:07,  1.53it/s]Dataset: STOR:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 54/65 [03:13<00:07,  1.53it/s]2025-09-23 12:26:51,721 - INFO - üåê Fetching BMRS dataset=SIL from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:51,794 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:51,796 - INFO - Converting column 'time' to pandas datetime (UTC)
2025-09-23 12:26:51,798 - WARNING - No corrected schema file found for dataset 'SIL' at 'schemas/corrected/bmrs_sil.json'.
2025-09-23 12:26:51,798 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:51,799 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:51,800 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:51,801 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:26:51,802 - INFO -  -> Converted datetime column 'time' to timezone-naive.
2025-09-23 12:26:51,802 - INFO -  -> Converted integer column 'level' to nullable Int64.
2025-09-23 12:26:51,802 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:51,803 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:51,803 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:51,804 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:51,804 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:51,804 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:51,805 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:51,805 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:51,805 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:51,809 - INFO - Created hash keys for 58 rows using 7 content columns
2025-09-23 12:26:51,809 - WARNING - No corrected schema file found for dataset 'SIL' at 'schemas/corrected/bmrs_sil.json'.
2025-09-23 12:26:51,809 - WARNING - Could not find corrected schema for SIL. Using autodetect.
2025-09-23 12:26:52,360 - ERROR - ‚ùå Failed to load data for SIL in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for STOR:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching STOR from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: STOR:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 54/65 [03:13<00:07,  1.53it/s]
Fetching STOR from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                              
                                                                                    [ADataset: STOR:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 54/65 [03:13<00:07,  1.53it/s]
Fetching STOR from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching STOR from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  7.87it/s][A
                                                                                            [ADataset: STOR:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]Dataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]2025-09-23 12:26:52,363 - INFO - üåê Fetching BMRS dataset=STOR from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:52,489 - INFO - No data returned for STOR in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for SURPLUS_MARGIN:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: SURPLUS_MARGIN:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 55/65 [03:13<00:04,  2.01it/s]
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching SURPLUS_MARGIN from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  2.55it/s][A
                                                                                                      [ADataset: SURPLUS_MARGIN:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:13<00:04,  2.15it/s]Dataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:13<00:04,  2.15it/s]          2025-09-23 12:26:52,491 - INFO - üåê Fetching BMRS dataset=SURPLUS_MARGIN from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:52,560 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/forecast/surplus/daily?from=2025-09-22&to=2025-09-23&format=json "HTTP/1.1 200 OK"
2025-09-23 12:26:52,563 - INFO - Successfully fetched 13 records for SURPLUS_MARGIN from Insights API.
2025-09-23 12:26:52,565 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:52,566 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:52,567 - WARNING - No corrected schema file found for dataset 'SURPLUS_MARGIN' at 'schemas/corrected/bmrs_surplus_margin.json'.
2025-09-23 12:26:52,568 - INFO - --- Starting final sanitization for BQ load on DataFrame with 9 columns ---
2025-09-23 12:26:52,569 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:52,569 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:52,570 - INFO -  -> Converted integer column 'surplus' to nullable Int64.
2025-09-23 12:26:52,570 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:52,570 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:52,571 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:52,571 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:52,572 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:52,572 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:52,572 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:52,574 - INFO - Created hash keys for 13 rows using 3 content columns
2025-09-23 12:26:52,575 - WARNING - No corrected schema file found for dataset 'SURPLUS_MARGIN' at 'schemas/corrected/bmrs_surplus_margin.json'.
2025-09-23 12:26:52,575 - WARNING - Could not find corrected schema for SURPLUS_MARGIN. Using autodetect.
2025-09-23 12:26:52,857 - ERROR - ‚ùå Failed to load data for SURPLUS_MARGIN in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/jibber-jabber-knowledge/jobs?uploadType=multipart: Provided Schema does not match Table jibber-jabber-knowledge:elexon_data_landing_zone.bmrs_surplus_margin. Field forecastdate has changed type from STRING to DATETIME
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
        file_obj, job_resource, size, num_retries, timeout, project=project
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
        self._http, data, metadata, _GENERIC_CONTENT_TYPE, timeout=timeout
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        retriable_request, self._get_status_code, self._retry_strategy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
    ...<5 lines>...
    )
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        tmpfile,
        ^^^^^^^^
    ...<9 lines>...
        timeout=timeout,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/jibber-jabber-knowledge/jobs?uploadType=multipart: Provided Schema does not match Table jibber-jabber-knowledge:elexon_data_landing_zone.bmrs_surplus_margin. Field forecastdate has changed type from STRING to DATETIME

Windows for TEMP:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:13<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TEMP:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 56/65 [03:14<00:04,  2.15it/s]
Fetching TEMP from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TEMP from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.05it/s]                               [A
                                                                     [ADataset: TEMP:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]Dataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]2025-09-23 12:26:52,883 - INFO - üåê Fetching BMRS dataset=TEMP from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:52,953 - INFO - Converting column 'measurementDate' to pandas datetime (UTC)
2025-09-23 12:26:52,954 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:52,956 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:26:52,957 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:52,958 - INFO -  -> Converted datetime column 'measurementDate' to timezone-naive.
2025-09-23 12:26:52,958 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:52,959 - INFO -  -> Converted float column 'temperature' to nullable Float64 based on schema.
2025-09-23 12:26:52,960 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:52,960 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:52,961 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:52,961 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:52,962 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:52,962 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:52,962 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:52,965 - INFO - Created hash keys for 31 rows using 4 content columns
2025-09-23 12:26:52,966 - INFO - Loaded corrected schema for TEMP
2025-09-23 12:26:53,367 - ERROR - ‚ùå Failed to load data for TEMP in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for TSDF:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: TSDF:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 57/65 [03:14<00:03,  2.12it/s]
Fetching TSDF from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDF from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.05it/s]                               [A
                                                                     [ADataset: TSDF:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:14<00:03,  2.10it/s]Dataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:14<00:03,  2.10it/s]2025-09-23 12:26:53,371 - INFO - üåê Fetching BMRS dataset=TSDF from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:53,461 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:53,462 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:26:53,463 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:26:53,466 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:53,466 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:53,466 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:53,467 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:53,468 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:26:53,469 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:26:53,470 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64 based on schema.
2025-09-23 12:26:53,470 - INFO -  -> Forced object column 'boundary' to string.
2025-09-23 12:26:53,470 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:53,470 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:53,471 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:53,471 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:53,471 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:53,471 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:53,471 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:53,494 - INFO - Created hash keys for 1458 rows using 7 content columns
2025-09-23 12:26:53,494 - INFO - Loaded corrected schema for TSDF
2025-09-23 12:26:53,855 - ERROR - ‚ùå Failed to load data for TSDF in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for TSDFD:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:14<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFD:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 58/65 [03:15<00:03,  2.10it/s]
Fetching TSDFD from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDFD from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.11it/s]                               [A
                                                                      [ADataset: TSDFD:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]Dataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]2025-09-23 12:26:53,859 - INFO - üåê Fetching BMRS dataset=TSDFD from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:53,935 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:53,936 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:53,938 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:26:53,939 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:53,940 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:53,940 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:53,941 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:53,942 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:53,942 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:53,942 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:53,943 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:53,943 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:53,944 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:53,944 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:53,946 - INFO - Created hash keys for 13 rows using 4 content columns
2025-09-23 12:26:53,947 - INFO - Loaded corrected schema for TSDFD
2025-09-23 12:26:54,331 - ERROR - ‚ùå Failed to load data for TSDFD in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for TSDFW:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                               
                                                                                                     [ADataset: TSDFW:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 59/65 [03:15<00:02,  2.10it/s]
Fetching TSDFW from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching TSDFW from 2025-09-22 to 2025-09-23: : 1it [00:00,  2.25it/s]                               [A
                                                                      [ADataset: TSDFW:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:15<00:02,  2.14it/s]Dataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:15<00:02,  2.14it/s]2025-09-23 12:26:54,335 - INFO - üåê Fetching BMRS dataset=TSDFW from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:54,409 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:54,413 - INFO - --- Starting final sanitization for BQ load on DataFrame with 11 columns ---
2025-09-23 12:26:54,413 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:54,414 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:54,415 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:54,416 - INFO -  -> Converted integer column 'week' to nullable Int64 based on schema.
2025-09-23 12:26:54,417 - INFO -  -> Converted integer column 'demand' to nullable Int64 based on schema.
2025-09-23 12:26:54,417 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:54,418 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:54,418 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:54,418 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:54,419 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:54,420 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:54,420 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:54,423 - INFO - Created hash keys for 51 rows using 5 content columns
2025-09-23 12:26:54,423 - INFO - Loaded corrected schema for TSDFW
2025-09-23 12:26:54,778 - ERROR - ‚ùå Failed to load data for TSDFW in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for UOU2T14D:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:15<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T14D:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 60/65 [03:16<00:02,  2.14it/s]
Fetching UOU2T14D from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching UOU2T14D from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  1.41it/s][A
                                                                                                [ADataset: UOU2T14D:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:16<00:02,  1.85it/s]Dataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:16<00:02,  1.85it/s]2025-09-23 12:26:54,779 - INFO - üåê Fetching BMRS dataset=UOU2T14D from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:54,989 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:54,991 - INFO - Converting column 'forecastDate' to pandas datetime (UTC)
2025-09-23 12:26:54,993 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:26:54,993 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:54,993 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:54,993 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:54,994 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:54,996 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:54,999 - INFO -  -> Converted datetime column 'forecastDate' to timezone-naive.
2025-09-23 12:26:54,999 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:54,999 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:55,000 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:55,000 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:55,000 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:55,000 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:55,001 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:55,001 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:55,073 - INFO - Created hash keys for 6032 rows using 7 content columns
2025-09-23 12:26:55,073 - INFO - Loaded corrected schema for UOU2T14D
2025-09-23 12:26:55,485 - ERROR - ‚ùå Failed to load data for UOU2T14D in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for UOU2T3YW:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:16<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:17<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:01<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:18<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:18<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:02<?, ?it/s][A                                                                  
                                                                                        [ADataset: UOU2T3YW:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 61/65 [03:20<00:02,  1.85it/s]
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:04<?, ?it/s][A
Fetching UOU2T3YW from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:04<00:00,  4.28s/it][A
                                                                                                [ADataset: UOU2T3YW:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 62/65 [03:20<00:04,  1.66s/it]Dataset: WIND:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 62/65 [03:20<00:04,  1.66s/it]    2025-09-23 12:26:55,490 - INFO - üåê Fetching BMRS dataset=UOU2T3YW from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:56,571 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:26:56,591 - INFO - --- Starting final sanitization for BQ load on DataFrame with 14 columns ---
2025-09-23 12:26:56,593 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:26:56,594 - INFO -  -> Forced object column 'fuelType' to string.
2025-09-23 12:26:56,595 - INFO -  -> Forced object column 'nationalGridBmUnit' to string.
2025-09-23 12:26:56,597 - INFO -  -> Forced object column 'bmUnit' to string.
2025-09-23 12:26:56,602 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:26:56,602 - INFO -  -> Converted integer column 'week' to nullable Int64 based on schema.
2025-09-23 12:26:56,603 - INFO -  -> Converted integer column 'year' to nullable Int64 based on schema.
2025-09-23 12:26:56,603 - INFO -  -> Converted integer column 'outputUsable' to nullable Int64 based on schema.
2025-09-23 12:26:56,604 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:26:56,605 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:26:56,606 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:26:56,607 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:26:56,608 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:26:56,612 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:26:56,612 - INFO - --- Final sanitization complete ---
2025-09-23 12:26:57,511 - INFO - Created hash keys for 71920 rows using 8 content columns
2025-09-23 12:26:57,515 - INFO - Loaded corrected schema for UOU2T3YW
2025-09-23 12:26:59,770 - ERROR - ‚ùå Failed to load data for UOU2T3YW in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for WIND:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching WIND from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: WIND:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 62/65 [03:20<00:04,  1.66s/it]
Fetching WIND from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                              
                                                                                                    [ADataset: WIND:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 62/65 [03:20<00:04,  1.66s/it]
Fetching WIND from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching WIND from 2025-09-22 to 2025-09-23: : 1it [00:00,  7.73it/s]                               [A
                                                                     [ADataset: WIND:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:20<00:02,  1.20s/it]Dataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:20<00:02,  1.20s/it]2025-09-23 12:26:59,773 - INFO - üåê Fetching BMRS dataset=WIND from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:26:59,901 - INFO - No data returned for WIND in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00

Windows for WINDFOR:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:20<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A                                                                 
                                                                                                       [ADataset: WINDFOR:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 63/65 [03:21<00:02,  1.20s/it]
Fetching WINDFOR from 2025-09-22 to 2025-09-23:   0%|          | 0/0.14285714285714285 [00:00<?, ?it/s][A
Fetching WINDFOR from 2025-09-22 to 2025-09-23: : 1it [00:00,  1.80it/s]                               [A
                                                                        [ADataset: WINDFOR:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]Dataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]2025-09-23 12:26:59,902 - INFO - üåê Fetching BMRS dataset=WINDFOR from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:27:00,060 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:27:00,062 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:27:00,063 - INFO - --- Starting final sanitization for BQ load on DataFrame with 10 columns ---
2025-09-23 12:27:00,064 - INFO -  -> Forced object column 'dataset' to string.
2025-09-23 12:27:00,065 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:27:00,065 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:27:00,066 - INFO -  -> Converted integer column 'generation' to nullable Int64 based on schema.
2025-09-23 12:27:00,066 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:27:00,066 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:27:00,066 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:27:00,067 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:27:00,067 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:27:00,067 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:27:00,067 - INFO - --- Final sanitization complete ---
2025-09-23 12:27:00,069 - INFO - Created hash keys for 73 rows using 4 content columns
2025-09-23 12:27:00,070 - INFO - Loaded corrected schema for WINDFOR
2025-09-23 12:27:00,456 - ERROR - ‚ùå Failed to load data for WINDFOR in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1829, in main
    load_job.result()
    ~~~~~~~~~~~~~~~^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/job/base.py", line 1048, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.Forbidden: 403 Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.; reason: billingNotEnabled, message: Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. Table expiration time must be less than 60 days while in sandbox mode.

Windows for WIND_SOLAR_GEN:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:21<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A                                                                        
                                                                                              [ADataset: WIND_SOLAR_GEN:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 64/65 [03:22<00:01,  1.01s/it]
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23:   0%|          | 0/1.0 [00:00<?, ?it/s][A
Fetching WIND_SOLAR_GEN from 2025-09-22 to 2025-09-23: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1.0 [00:00<00:00,  2.09it/s][A
                                                                                                      [ADataset: WIND_SOLAR_GEN: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 65/65 [03:22<00:00,  1.18it/s]Dataset: WIND_SOLAR_GEN: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 65/65 [03:22<00:00,  3.11s/it]
2025-09-23 12:27:00,460 - INFO - üåê Fetching BMRS dataset=WIND_SOLAR_GEN from=2025-09-22 00:00:00+00:00 to=2025-09-23 00:00:00+00:00
2025-09-23 12:27:00,598 - INFO - HTTP Request: GET https://data.elexon.co.uk/bmrs/api/v1/generation/actual/per-type/wind-and-solar?from=2025-09-22&to=2025-09-23&format=json "HTTP/1.1 200 OK"
2025-09-23 12:27:00,600 - INFO - Successfully fetched 147 records for WIND_SOLAR_GEN from Insights API.
2025-09-23 12:27:00,601 - INFO - Converting column 'publishTime' to pandas datetime (UTC)
2025-09-23 12:27:00,601 - INFO - Converting column 'startTime' to pandas datetime (UTC)
2025-09-23 12:27:00,602 - INFO - Converting column 'settlementDate' to pandas datetime (UTC)
2025-09-23 12:27:00,602 - WARNING - No corrected schema file found for dataset 'WIND_SOLAR_GEN' at 'schemas/corrected/bmrs_wind_solar_gen.json'.
2025-09-23 12:27:00,603 - INFO - --- Starting final sanitization for BQ load on DataFrame with 13 columns ---
2025-09-23 12:27:00,603 - INFO -  -> Converted datetime column 'publishTime' to timezone-naive.
2025-09-23 12:27:00,603 - INFO -  -> Forced object column 'businessType' to string.
2025-09-23 12:27:00,604 - INFO -  -> Forced object column 'psrType' to string.
2025-09-23 12:27:00,604 - INFO -  -> Converted float column 'quantity' to nullable Float64.
2025-09-23 12:27:00,604 - INFO -  -> Converted datetime column 'startTime' to timezone-naive.
2025-09-23 12:27:00,605 - INFO -  -> Converted datetime column 'settlementDate' to timezone-naive.
2025-09-23 12:27:00,605 - INFO -  -> Converted integer column 'settlementPeriod' to nullable Int64.
2025-09-23 12:27:00,605 - INFO -  -> Forced object column '_dataset' to string.
2025-09-23 12:27:00,605 - INFO -  -> Forced object column '_window_from_utc' to string.
2025-09-23 12:27:00,605 - INFO -  -> Forced object column '_window_to_utc' to string.
2025-09-23 12:27:00,605 - INFO -  -> Forced object column '_ingested_utc' to string.
2025-09-23 12:27:00,606 - INFO -  -> Forced object column '_source_columns' to string.
2025-09-23 12:27:00,606 - INFO -  -> Forced object column '_source_api' to string.
2025-09-23 12:27:00,606 - INFO - --- Final sanitization complete ---
2025-09-23 12:27:00,609 - INFO - Created hash keys for 147 rows using 7 content columns
2025-09-23 12:27:00,609 - WARNING - No corrected schema file found for dataset 'WIND_SOLAR_GEN' at 'schemas/corrected/bmrs_wind_solar_gen.json'.
2025-09-23 12:27:00,609 - WARNING - Could not find corrected schema for WIND_SOLAR_GEN. Using autodetect.
2025-09-23 12:27:00,933 - ERROR - ‚ùå Failed to load data for WIND_SOLAR_GEN in window 2025-09-22 00:00:00+00:00-2025-09-23 00:00:00+00:00: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/jibber-jabber-knowledge/jobs?uploadType=multipart: Provided Schema does not match Table jibber-jabber-knowledge:elexon_data_landing_zone.bmrs_wind_solar_gen. Field publishtime has changed type from STRING to DATETIME
Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2682, in load_table_from_file
    response = self._do_multipart_upload(
        file_obj, job_resource, size, num_retries, timeout, project=project
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 3246, in _do_multipart_upload
    response = upload.transmit(
        self._http, data, metadata, _GENERIC_CONTENT_TYPE, timeout=timeout
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/upload.py", line 153, in transmit
    return _request_helpers.wait_and_retry(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        retriable_request, self._get_status_code, self._retry_strategy
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/_request_helpers.py", line 155, in wait_and_retry
    response = func()
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/requests/upload.py", line 149, in retriable_request
    self._process_response(result)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/_upload.py", line 125, in _process_response
    _helpers.require_status_code(response, (http.client.OK,), self._get_status_code)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/resumable_media/_helpers.py", line 108, in require_status_code
    raise common.InvalidResponse(
    ...<5 lines>...
    )
google.resumable_media.common.InvalidResponse: ('Request failed with status code', 400, 'Expected one of', <HTTPStatus.OK: 200>)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/ingest_elexon_fixed.py", line 1826, in main
    load_job = client.load_table_from_dataframe(
        df, table_id, job_config=job_config
    )
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2922, in load_table_from_dataframe
    return self.load_table_from_file(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        tmpfile,
        ^^^^^^^^
    ...<9 lines>...
        timeout=timeout,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/georgemajor/jibber-jabber 24 august 2025 big bop/gsheets_env/lib/python3.13/site-packages/google/cloud/bigquery/client.py", line 2686, in load_table_from_file
    raise exceptions.from_http_response(exc.response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/upload/bigquery/v2/projects/jibber-jabber-knowledge/jobs?uploadType=multipart: Provided Schema does not match Table jibber-jabber-knowledge:elexon_data_landing_zone.bmrs_wind_solar_gen. Field publishtime has changed type from STRING to DATETIME
2025-09-23 12:27:00,938 - INFO - ‚úÖ Ingestion run completed.
